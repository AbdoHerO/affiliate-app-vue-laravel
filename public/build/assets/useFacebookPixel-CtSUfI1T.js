import{u as b}from"./settings-Bsl5xbI3.js";import{r as v,V as s}from"./main-BGmfaZsq.js";function g(){const r=b(),n=v(!1),o=s(()=>r.facebookPxmApiKey),l=s(()=>!!window.fbq&&!!o.value&&n.value),u=async()=>{if(n.value||!o.value)return;if(document.querySelector('script[src*="connect.facebook.net"]')){n.value=!0;return}try{const e=document.createElement("script");e.async=!0,e.src="https://connect.facebook.net/en_US/fbevents.js",document.head.appendChild(e),await new Promise((c,i)=>{e.onload=c,e.onerror=i}),window.fbq&&(window.fbq("init",o.value),window.fbq("track","PageView"),n.value=!0,console.log("✅ Facebook Pixel initialized successfully:",o.value))}catch(e){console.error("❌ Failed to inject Facebook Pixel script:",e)}},a=(t,e={})=>{var c;if(!l.value){console.warn("Facebook Pixel not available, skipping event:",t);return}try{const i=k(e);(c=window.fbq)==null||c.call(window,"track",t,i),console.log(`📊 Facebook Pixel event tracked: ${t}`,i)}catch(i){console.error("Failed to track Facebook Pixel event:",i)}},d=(t={})=>{a("ViewContent",t)},p=(t=0,e="MAD")=>{a("CompleteRegistration",{value:t,currency:e})},f=(t={})=>{a("Lead",t)},m=(t,e={})=>{a(t,e)},k=t=>{const e={...t};return["email","phone","telephone","address","nom_complet","name","firstName","lastName"].forEach(i=>{e[i]&&delete e[i]}),e},w=async()=>{r.initialized||await r.initialize(),o.value&&await u()};return{isPixelInjected:s(()=>n.value),isPixelAvailable:l,pixelApiKey:o,injectPixelScript:u,initializePixel:w,trackEvent:a,trackViewContent:d,trackCompleteRegistration:p,trackLead:f,trackCustomEvent:m}}export{g as u};
