import{d as W,aL as X,k as Y,b8 as Z,r as _,V as ee,w as te,o as ae,c as p,b as u,e as a,f as i,v as r,n as s,g as l,cG as le,ac as k,az as y,t as f,m as q,F as oe,j as se,h as re}from"./main-0h7RfoM1.js";import{u as ie}from"./orders-l0JQNCUs.js";import{u as ne}from"./useNotifications-QM5aCJtM.js";import{_ as de}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-pmQ-bLAs.js";import{V as ce}from"./VCardText-DBDe3l6V.js";import{V as ue,a as h}from"./VRow-CwTmyELD.js";import{V as F}from"./VTextField-CB8SxAnl.js";import{V as me}from"./VSelect-E3I5xPtI.js";import{V as O}from"./VCard-BJO62jXa.js";import{V as _e}from"./VDataTableServer-S93ZGevF.js";import{V as w}from"./VChip-Cb1gcZbV.js";import{V as pe}from"./VAvatar-BcyggOHV.js";import"./VBreadcrumbs-C5bXM6fl.js";/* empty css              */import"./VField-ThiSfLeE.js";import"./VImg-D8VstP0L.js";import"./forwardRefs-DtnMMuBS.js";import"./VList-D8OGLl9W.js";import"./ssrBoot-_8LWlSSM.js";import"./createSimpleFunctional-CRjW3p8V.js";import"./VDivider-CF-VI2ua.js";import"./dialog-transition--QLlkKWU.js";import"./VMenu-BRSAgo5d.js";import"./VOverlay-cV5WKNuZ.js";import"./lazy-DAn2yZiW.js";import"./VCheckboxBtn-DNqYvCTV.js";import"./VDataTable-CrgqCoMT.js";import"./VPagination-CjKu94po.js";import"./VTable-BHYHnEIv.js";import"./filter-BbUs5nlv.js";const fe={class:"d-flex justify-space-between align-center mb-6"},be={class:"text-h4 font-weight-bold mb-1"},ye={class:"text-body-1 text-medium-emphasis"},he={class:"d-flex align-center"},ve={class:"font-weight-medium"},ge={class:"text-caption text-medium-emphasis"},xe={class:"d-flex flex-wrap gap-1"},Ve={key:0,class:"d-flex flex-column"},ke={key:0,class:"text-body-2 font-weight-medium"},we=["href"],Ce={key:1,class:"text-caption text-medium-emphasis"},Fe={class:"font-weight-medium"},ze={class:"text-body-2"},Se={class:"text-center py-8"},Ne={class:"text-h6 mb-2"},Te={class:"text-body-2 text-medium-emphasis"},dt=W({__name:"index",setup(Ae){const{t}=X(),B=Y(),{showError:z}=ne(),c=ie(),{orders:D,loading:L,pagination:C,filters:Ue,error:P}=Z(c),v=_(""),g=_([]),S=_(""),x=_(""),V=_("");_(!1);const R=ee(()=>[{title:t("nav.dashboard"),to:{name:"affiliate-dashboard"}},{title:t("affiliate_orders_title"),active:!0}]),$=[{value:"pending",title:t("affiliate_orders_status_pending"),color:"warning"},{value:"confirmed",title:t("affiliate_orders_status_confirmed"),color:"info"},{value:"sent",title:t("affiliate_orders_status_sent"),color:"primary"},{value:"expedited",title:t("affiliate_orders_status_expedited"),color:"purple"},{value:"delivered",title:t("affiliate_orders_status_delivered"),color:"success"},{value:"canceled",title:t("affiliate_orders_status_canceled"),color:"error"},{value:"returned",title:t("affiliate_orders_status_returned"),color:"orange"},{value:"delivery_failed",title:t("affiliate_orders_status_delivery_failed"),color:"error"},{value:"paid",title:t("affiliate_orders_status_paid"),color:"success"}],I=[{title:t("table.reference"),key:"id",sortable:!0},{title:t("table.client"),key:"client.nom_complet",sortable:!1},{title:t("table.boutique"),key:"boutique.nom",sortable:!1},{title:"SKU",key:"sku_list",sortable:!1,width:"150px"},{title:"Type",key:"type_command",sortable:!0},{title:"Livreur",key:"delivery_boy",sortable:!1,width:"150px"},{title:t("table.status"),key:"statut",sortable:!0},{title:t("table.total_ttc"),key:"total_ttc",sortable:!0},{title:t("table.date"),key:"created_at",sortable:!0},{title:t("table.actions"),key:"actions",sortable:!1}],N=()=>{c.updateFilters({q:v.value,status:g.value,boutique_id:S.value,date_from:x.value,date_to:V.value}),m()},K=()=>{v.value="",g.value=[],S.value="",x.value="",V.value="",c.resetFilters(),m()},m=async(o=1)=>{try{await c.fetchOrders(o)}catch{z(t("errors.orders_load_failed"))}},j=o=>{m(o)},M=o=>{c.updateFilters({per_page:o}),m()},E=o=>{if(o.length>0){const{key:n,order:e}=o[0];c.updateFilters({sort:n,dir:e}),m()}},T=o=>{B.push({name:"affiliate-orders-id",params:{id:o.id}})},G=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MAD"}).format(o),Q=o=>new Date(o).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),H=o=>({order_sample:"primary",exchange:"warning"})[o]||"secondary",J=o=>({order_sample:"Échantillon",exchange:"Échange"})[o]||o||"N/A";return te(P,o=>{o&&z(o)}),ae(()=>{m()}),(o,n)=>(u(),p("div",null,[a(de,{items:R.value},null,8,["items"]),i("div",fe,[i("div",null,[i("h1",be,r(s(t)("affiliate_orders_title")),1),i("p",ye,r(s(t)("affiliate_orders_description")),1)])]),a(O,{class:"mb-6"},{default:l(()=>[a(ce,null,{default:l(()=>[a(ue,null,{default:l(()=>[a(h,{cols:"12",sm:"6",md:"4",lg:"4"},{default:l(()=>[a(F,{modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),label:s(t)("search.label"),placeholder:s(t)("affiliate_orders_search_placeholder"),"prepend-inner-icon":"tabler-search",clearable:"",onKeyup:le(N,["enter"])},null,8,["modelValue","label","placeholder"])]),_:1}),a(h,{cols:"12",sm:"6",md:"4",lg:"3"},{default:l(()=>[a(me,{modelValue:g.value,"onUpdate:modelValue":n[1]||(n[1]=e=>g.value=e),items:$,label:s(t)("table.status"),multiple:"",chips:"",clearable:"","item-title":"title","item-value":"value"},null,8,["modelValue","label"])]),_:1}),a(h,{cols:"12",sm:"6",md:"4",lg:"2"},{default:l(()=>[a(F,{modelValue:x.value,"onUpdate:modelValue":n[2]||(n[2]=e=>x.value=e),label:s(t)("filters.date_start"),type:"date"},null,8,["modelValue","label"])]),_:1}),a(h,{cols:"12",sm:"6",md:"4",lg:"2"},{default:l(()=>[a(F,{modelValue:V.value,"onUpdate:modelValue":n[3]||(n[3]=e=>V.value=e),label:s(t)("filters.date_end"),type:"date"},null,8,["modelValue","label"])]),_:1}),a(h,{cols:"12",sm:"12",md:"4",lg:"1",class:"d-flex align-center gap-2"},{default:l(()=>[a(k,{color:"primary",size:"small",onClick:N},{default:l(()=>[a(y,{icon:"tabler-search"})]),_:1}),a(k,{variant:"outlined",size:"small",onClick:K},{default:l(()=>[a(y,{icon:"tabler-refresh"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(O,null,{default:l(()=>[a(_e,{headers:I,items:s(D),loading:s(L),"items-length":s(C).total,"items-per-page":s(C).per_page,page:s(C).current_page,"item-value":"id","onUpdate:page":j,"onUpdate:itemsPerPage":M,"onUpdate:sortBy":E},{"item.id":l(({item:e})=>[a(k,{variant:"text",size:"small",color:"primary",onClick:d=>T(e)},{default:l(()=>[f(" #"+r(e.id.toString().slice(-8)),1)]),_:2},1032,["onClick"])]),"item.client.nom_complet":l(({item:e})=>{var d,b,A,U;return[i("div",he,[a(pe,{size:"32",class:"me-3"},{default:l(()=>[a(y,{icon:"tabler-user"})]),_:1}),i("div",null,[i("div",ve,r(((d=e.client)==null?void 0:d.nom_complet)||((b=e.clientFinal)==null?void 0:b.nom_complet)||"N/A"),1),i("div",ge,r(((A=e.client)==null?void 0:A.telephone)||((U=e.clientFinal)==null?void 0:U.telephone)||"N/A"),1)])])]}),"item.boutique.nom":l(({item:e})=>[a(w,{size:"small",variant:"tonal",color:"info"},{default:l(()=>{var d;return[f(r(((d=e.boutique)==null?void 0:d.nom)||"N/A"),1)]}),_:2},1024)]),"item.sku_list":l(({item:e})=>[i("div",xe,[(u(!0),p(oe,null,se(e.articles||[],d=>(u(),re(w,{key:d.id,size:"x-small",color:"secondary",variant:"outlined",class:"font-mono"},{default:l(()=>{var b;return[f(r(((b=d.produit)==null?void 0:b.sku)||"N/A"),1)]}),_:2},1024))),128))])]),"item.type_command":l(({item:e})=>[a(w,{size:"small",color:H(e.type_command),variant:"tonal"},{default:l(()=>[f(r(J(e.type_command)),1)]),_:2},1032,["color"])]),"item.delivery_boy":l(({item:e})=>[e.delivery_boy_name||e.delivery_boy_phone?(u(),p("div",Ve,[e.delivery_boy_name?(u(),p("span",ke,r(e.delivery_boy_name),1)):q("",!0),e.delivery_boy_phone?(u(),p("a",{key:1,href:`tel:${e.delivery_boy_phone}`,class:"text-caption text-primary text-decoration-none"},[a(y,{icon:"tabler-phone",size:"12",class:"me-1"}),f(" "+r(e.delivery_boy_phone),1)],8,we)):q("",!0)])):(u(),p("span",Ce,"—"))]),"item.statut":l(({item:e})=>[a(w,{color:s(c).getStatusColor(e.statut),size:"small",variant:"tonal"},{default:l(()=>[f(r(s(c).getStatusLabel(e.statut)),1)]),_:2},1032,["color"])]),"item.total_ttc":l(({item:e})=>[i("span",Fe,r(G(e.total_ttc)),1)]),"item.created_at":l(({item:e})=>[i("span",ze,r(Q(e.created_at)),1)]),"item.actions":l(({item:e})=>[a(k,{icon:"tabler-eye",size:"small",variant:"text",color:"primary",onClick:d=>T(e)},null,8,["onClick"])]),"no-data":l(()=>[i("div",Se,[a(y,{icon:"tabler-package-off",size:"64",class:"text-disabled mb-4"}),i("h3",Ne,r(s(t)("affiliate_orders_no_orders_found")),1),i("p",Te,r(s(t)("affiliate_orders_no_orders_description")),1)])]),_:1},8,["items","loading","items-length","items-per-page","page"])]),_:1})]))}});export{dt as default};
