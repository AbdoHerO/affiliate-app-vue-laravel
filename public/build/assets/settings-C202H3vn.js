import{_ as te}from"./AppTextField.vue_vue_type_script_setup_true_lang-BZ4kv4ba.js";import{d as se,aL as le,o as G,r as V,V as oe,w as C,c as F,f as r,h as T,e,v as i,n as l,g as t,ba as q,cW as ne,b as f,az as p,t as u,aW as ie,m as A,ac as L,F as re,j as ce,cX as de}from"./main-BGmfaZsq.js";import{u as ue}from"./settings-Bsl5xbI3.js";import{u as pe}from"./useNotifications-TnKci45M.js";import{V as R,a as g}from"./VRow-Jzvhbj9T.js";import{V as v,b as $}from"./VCard-hQ_o7lvO.js";import{b as me,a as ge,V as b,c as D}from"./VTabs-DVQzeJmi.js";import{V as E}from"./VCardText-BzdllyhI.js";import{V as _e}from"./VSkeletonLoader-CtKIMEe_.js";import{V as w}from"./VChip-S_h5DeIW.js";import{V as fe}from"./VForm-9k5StL4q.js";import{V as B}from"./VField-BqE6uwOn.js";import{V as X}from"./VAvatar-CXniQsPN.js";import{V as H}from"./VImg-6pMKiBpi.js";import{V as J}from"./VFileInput-BLh4W2ou.js";import{V as I}from"./VAlert-CPLjIjOe.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VTextField-STn8GDXm.js";import"./forwardRefs-BxxmAO9z.js";/* empty css              */import"./createSimpleFunctional-BjWjRu3X.js";import"./VWindowItem-DCRKlehJ.js";import"./lazy-DgLfxsl0.js";import"./ssrBoot-A30zOnZp.js";const be={class:"d-flex align-center justify-space-between mb-6"},he={class:"text-h4 font-weight-bold mb-1"},ye={class:"text-body-1 mb-0"},xe={class:"d-flex align-center"},Ve={class:"tab-text"},we={class:"d-flex align-center"},ke={class:"tab-text"},Se={class:"d-flex align-center"},ze={class:"tab-text"},Ce={class:"d-flex align-center"},Fe={class:"tab-text"},Te={class:"d-flex align-center"},Ae={class:"tab-text"},Le={class:"d-flex align-center"},Ee={class:"tab-text"},Ie={class:"d-flex align-center"},Ue={class:"tab-text"},je={class:"d-flex align-center"},qe={class:"tab-text"},$e={class:"mb-8"},De={class:"text-h5 mb-2"},Be={class:"text-body-2 text-medium-emphasis"},We={key:0,class:"mb-4"},Me={class:"d-flex align-center gap-3"},Ne={class:"text-body-2 mb-1"},Oe={key:0,class:"mb-4"},Pe={class:"d-flex align-center gap-3"},Ke={class:"text-body-2 mb-1"},Ge={class:"d-flex gap-3 flex-wrap"},Re={class:"text-center py-8"},Xe={class:"text-h5 mb-2"},He={class:"text-body-1 text-medium-emphasis"},Je=se({__name:"settings",setup(Qe){const{t:a,locale:U}=le(),W=ue(),{showSuccess:j,showError:_}=pe();G(()=>{console.log("Current locale:",U.value),console.log("Available locales:",Object.keys(a("settings")||{})),console.log("Settings title:",a("settings.title")),U.value!=="fr"&&(U.value="fr",console.log("Locale forced to French"))});const k=V(!1),S=V(!1),z=V("general"),o=V({app_name:"",app_description:"",app_slogan:"",app_keywords:"",company_logo:"",favicon:"",facebook_pxm_api_key:""}),M=oe(()=>k.value||S.value),h=V(""),y=V(""),x=n=>n?n.startsWith("http")||n.startsWith("/storage/")?n:`/storage/settings/${n}`:"",Q=()=>{h.value="",o.value.company_logo=""},Y=()=>{y.value="",o.value.favicon=""},Z=async n=>{var d;const s=(d=n.target.files)==null?void 0:d[0];if(s){if(!N(s,"logo"))return;try{const c=new FormData;c.append("file",s),c.append("type","logo");const m=await q("/admin/settings/upload-file",{method:"POST",body:c});m.success?(o.value.company_logo=m.data.filename,h.value=m.data.url,j(a("settings.messages.upload_success"))):_(m.message||a("settings.messages.upload_failed"))}catch(c){console.error("Logo upload failed:",c),_(a("settings.messages.upload_failed"))}}},ee=async n=>{var d;const s=(d=n.target.files)==null?void 0:d[0];if(s){if(!N(s,"favicon"))return;try{const c=new FormData;c.append("file",s),c.append("type","favicon");const m=await q("/admin/settings/upload-file",{method:"POST",body:c});m.success?(o.value.favicon=m.data.filename,y.value=m.data.url,j(a("settings.messages.upload_success"))):_(m.message||a("settings.messages.upload_failed"))}catch(c){console.error("Favicon upload failed:",c),_(a("settings.messages.upload_failed"))}}},N=(n,s)=>{const d={logo:2097152,favicon:1048576},c={logo:["image/jpeg","image/png","image/svg+xml"],favicon:["image/x-icon","image/png","image/jpeg"]};return n.size>d[s]?(_(`File too large. Maximum size for ${s} is ${d[s]/(1024*1024)}MB`),!1):c[s].includes(n.type)?!0:(_(`Invalid file type for ${s}. Allowed types: ${c[s].join(", ")}`),!1)},ae=async()=>{S.value=!0;try{await W.updateSettings("general",o.value),P(),await W.fetchSettings(),await K(),j(a("settings.messages.saved_successfully")),window.dispatchEvent(new CustomEvent("settings:updated",{detail:o.value})),await de.reinitialize(),setTimeout(()=>{window.location.reload()},1500)}catch(n){console.error("Failed to save settings:",n),_(a("settings.messages.save_failed"))}finally{S.value=!1}},O=async()=>{k.value=!0;try{const n=await q("/admin/settings/general",{method:"GET"});n.success&&n.data&&(Object.keys(o.value).forEach(s=>{n.data[s]!==void 0&&(o.value[s]=n.data[s])}),o.value.company_logo&&(h.value=x(o.value.company_logo)),o.value.favicon&&(y.value=x(o.value.favicon)),P(),K())}catch(n){console.error("Failed to load settings:",n),_(a("settings_load_failed"))}finally{k.value=!1}},P=()=>{o.value.app_name&&(document.title=o.value.app_name);const n=document.querySelector('meta[name="description"]');n&&o.value.app_description&&n.setAttribute("content",o.value.app_description);let s=document.querySelector('meta[name="keywords"]');if(o.value.app_keywords&&(s||(s=document.createElement("meta"),s.setAttribute("name","keywords"),document.head.appendChild(s)),s.setAttribute("content",o.value.app_keywords)),o.value.favicon){let d=document.querySelector('link[rel="icon"]');d||(d=document.createElement("link"),d.rel="icon",document.head.appendChild(d)),d.href=x(o.value.favicon)}};C(()=>o.value.app_name,n=>{n&&(document.title=n)},{immediate:!0}),C(()=>o.value.app_description,n=>{const s=document.querySelector('meta[name="description"]');s&&n&&s.setAttribute("content",n)},{immediate:!0}),C(()=>o.value.app_keywords,n=>{let s=document.querySelector('meta[name="keywords"]');n&&(s||(s=document.createElement("meta"),s.setAttribute("name","keywords"),document.head.appendChild(s)),s.setAttribute("content",n))},{immediate:!0}),C(()=>o.value.favicon,n=>{if(n){let s=document.querySelector('link[rel="icon"]');s||(s=document.createElement("link"),s.rel="icon",document.head.appendChild(s)),s.href=x(n)}},{immediate:!0});const K=async()=>{try{ne.updateFromSettings({app_name:o.value.app_name,company_logo:o.value.company_logo})}catch(n){console.error("Failed to update theme config:",n)}};return G(()=>{O()}),(n,s)=>{const d=te;return f(),F("div",null,[r("div",be,[r("div",null,[r("h4",he,i(l(a)("settings.title")),1),r("p",ye,i(l(a)("settings.description")),1)])]),k.value?(f(),T(R,{key:0},{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(v,null,{default:t(()=>[e(E,null,{default:t(()=>[e(_e,{type:"heading, paragraph, divider, heading, paragraph, button"})]),_:1})]),_:1})]),_:1})]),_:1})):(f(),T(v,{key:1,class:"settings-card mb-6 h-50"},{default:t(()=>[e(ge,{modelValue:z.value,"onUpdate:modelValue":s[0]||(s[0]=c=>z.value=c),color:"primary","align-tabs":"start",class:"settings-tabs h-50","bg-color":"grey-lighten-5","slider-color":"primary","show-arrows":""},{default:t(()=>[e(b,{value:"general",class:"settings-tab"},{default:t(()=>[r("div",xe,[e(p,{start:"",icon:"tabler-settings",size:"20"}),r("span",Ve,i(l(a)("settings.tabs.general")),1)])]),_:1}),e(b,{value:"business",class:"settings-tab"},{default:t(()=>[r("div",we,[e(p,{start:"",icon:"tabler-building-store",size:"20"}),r("span",ke,i(l(a)("settings.tabs.business")),1)])]),_:1}),e(b,{value:"shipping",class:"settings-tab"},{default:t(()=>[r("div",Se,[e(p,{start:"",icon:"tabler-truck",size:"20"}),r("span",ze,i(l(a)("settings.tabs.shipping")),1),e(w,{size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(l(a)("settings.coming_soon")),1)]),_:1})])]),_:1}),e(b,{value:"users",class:"settings-tab"},{default:t(()=>[r("div",Ce,[e(p,{start:"",icon:"tabler-users",size:"20"}),r("span",Fe,i(l(a)("settings.tabs.users")),1),e(w,{size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(l(a)("settings.coming_soon")),1)]),_:1})])]),_:1}),e(b,{value:"products",class:"settings-tab"},{default:t(()=>[r("div",Te,[e(p,{start:"",icon:"tabler-package",size:"20"}),r("span",Ae,i(l(a)("settings.tabs.products")),1),e(w,{size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(l(a)("settings.coming_soon")),1)]),_:1})])]),_:1}),e(b,{value:"communication",class:"settings-tab"},{default:t(()=>[r("div",Le,[e(p,{start:"",icon:"tabler-mail",size:"20"}),r("span",Ee,i(l(a)("settings.tabs.communication")),1),e(w,{size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(l(a)("settings.coming_soon")),1)]),_:1})])]),_:1}),e(b,{value:"security",class:"settings-tab"},{default:t(()=>[r("div",Ie,[e(p,{start:"",icon:"tabler-shield",size:"20"}),r("span",Ue,i(l(a)("settings.tabs.security")),1),e(w,{size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(l(a)("settings.coming_soon")),1)]),_:1})])]),_:1}),e(b,{value:"system",class:"settings-tab"},{default:t(()=>[r("div",je,[e(p,{start:"",icon:"tabler-server",size:"20"}),r("span",qe,i(l(a)("settings.tabs.system")),1),e(w,{size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[u(i(l(a)("settings.coming_soon")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})),e(me,{modelValue:z.value,"onUpdate:modelValue":s[6]||(s[6]=c=>z.value=c)},{default:t(()=>[e(D,{value:"general"},{default:t(()=>[e(v,null,{default:t(()=>[e(E,{class:"pa-6"},{default:t(()=>[r("div",$e,[r("h3",De,i(l(a)("settings.general.title")),1),r("p",Be,i(l(a)("settings.general.description")),1)]),e(fe,{onSubmit:ie(ae,["prevent"])},{default:t(()=>[e(R,{class:"gy-4"},{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(d,{modelValue:o.value.app_name,"onUpdate:modelValue":s[1]||(s[1]=c=>o.value.app_name=c),label:`${l(a)("settings.general.app_name")} *`,placeholder:l(a)("settings.general.app_name_placeholder"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(d,{modelValue:o.value.app_description,"onUpdate:modelValue":s[2]||(s[2]=c=>o.value.app_description=c),label:l(a)("settings.general.app_description"),placeholder:l(a)("settings.general.app_description_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(d,{modelValue:o.value.app_slogan,"onUpdate:modelValue":s[3]||(s[3]=c=>o.value.app_slogan=c),label:l(a)("settings.general.app_slogan"),placeholder:l(a)("settings.general.app_slogan_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(d,{modelValue:o.value.app_keywords,"onUpdate:modelValue":s[4]||(s[4]=c=>o.value.app_keywords=c),label:l(a)("settings.general.app_keywords"),placeholder:l(a)("settings.general.app_keywords_placeholder")},null,8,["modelValue","label","placeholder"]),e(B,{class:"text-caption text-medium-emphasis mt-1"},{default:t(()=>[u(i(l(a)("settings.general.keywords_help")),1)]),_:1})]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(v,{variant:"outlined",class:"pa-4 mb-4"},{default:t(()=>[e($,{class:"text-body-1 pa-0 mb-3"},{default:t(()=>[e(p,{start:"",icon:"tabler-photo"}),u(" "+i(l(a)("settings.general.company_logo")),1)]),_:1}),h.value||o.value.company_logo?(f(),F("div",We,[e(B,{class:"text-caption text-medium-emphasis mb-2"},{default:t(()=>[u(i(l(a)("settings.general.preview")),1)]),_:1}),r("div",Me,[e(X,{size:"80",rounded:"lg",variant:"outlined"},{default:t(()=>[e(H,{src:h.value||x(o.value.company_logo),alt:l(a)("settings.general.company_logo"),cover:""},null,8,["src","alt"])]),_:1}),r("div",null,[r("p",Ne,i(o.value.company_logo||l(a)("settings.general.file_selected")),1),h.value||o.value.company_logo?(f(),T(L,{key:0,size:"small",color:"error",variant:"text",onClick:Q},{default:t(()=>[e(p,{start:"",icon:"tabler-trash"}),u(" "+i(l(a)("settings.general.remove")),1)]),_:1})):A("",!0)])])])):A("",!0),e(J,{accept:"image/jpeg,image/png,image/svg+xml",label:l(a)("settings.general.logo_upload"),"prepend-icon":"tabler-upload",variant:"outlined",density:"compact",onChange:Z},null,8,["label"]),e(I,{type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:t(()=>[u(i(l(a)("settings.general.logo_requirements")),1)]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(v,{variant:"outlined",class:"pa-4 mb-4"},{default:t(()=>[e($,{class:"text-body-1 pa-0 mb-3"},{default:t(()=>[e(p,{start:"",icon:"tabler-world"}),u(" "+i(l(a)("settings.general.favicon")),1)]),_:1}),y.value||o.value.favicon?(f(),F("div",Oe,[e(B,{class:"text-caption text-medium-emphasis mb-2"},{default:t(()=>[u(i(l(a)("settings.general.preview")),1)]),_:1}),r("div",Pe,[e(X,{size:"40",rounded:"sm",variant:"outlined"},{default:t(()=>[e(H,{src:y.value||x(o.value.favicon),alt:l(a)("settings.general.favicon"),cover:""},null,8,["src","alt"])]),_:1}),r("div",null,[r("p",Ke,i(o.value.favicon||l(a)("settings.general.file_selected")),1),y.value||o.value.favicon?(f(),T(L,{key:0,size:"small",color:"error",variant:"text",onClick:Y},{default:t(()=>[e(p,{start:"",icon:"tabler-trash"}),u(" "+i(l(a)("settings.general.remove")),1)]),_:1})):A("",!0)])])])):A("",!0),e(J,{accept:"image/x-icon,image/png,image/jpeg",label:l(a)("settings.general.favicon_upload"),"prepend-icon":"tabler-upload",variant:"outlined",density:"compact",onChange:ee},null,8,["label"]),e(I,{type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:t(()=>[u(i(l(a)("settings.general.favicon_requirements")),1)]),_:1})]),_:1})]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(v,{variant:"outlined",class:"pa-4 mb-6"},{default:t(()=>[e($,{class:"text-body-1 pa-0 mb-3"},{default:t(()=>[e(p,{start:"",icon:"tabler-brand-facebook"}),u(" "+i(l(a)("settings.general.facebook_pixel")),1)]),_:1}),e(d,{modelValue:o.value.facebook_pxm_api_key,"onUpdate:modelValue":s[5]||(s[5]=c=>o.value.facebook_pxm_api_key=c),label:l(a)("settings.general.facebook_pixel_id"),placeholder:l(a)("settings.general.facebook_pixel_placeholder"),variant:"outlined",density:"compact","prepend-inner-icon":"tabler-hash"},null,8,["modelValue","label","placeholder"]),e(I,{type:"info",variant:"tonal",density:"compact",class:"mt-3"},{default:t(()=>[e(p,{start:"",icon:"tabler-info-circle"}),u(" "+i(l(a)("settings.general.facebook_pixel_help")),1)]),_:1})]),_:1})]),_:1}),e(g,{cols:"12"},{default:t(()=>[r("div",Ge,[e(L,{color:"primary","prepend-icon":"tabler-device-floppy",loading:S.value,disabled:M.value,type:"submit"},{default:t(()=>[u(i(l(a)("settings.actions.save")),1)]),_:1},8,["loading","disabled"]),e(L,{color:"secondary",variant:"outlined","prepend-icon":"tabler-refresh",disabled:M.value,onClick:O},{default:t(()=>[u(i(l(a)("settings.actions.reload")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{value:"business"},{default:t(()=>[e(v,null,{default:t(()=>[e(E,null,{default:t(()=>[e(I,{type:"info",variant:"tonal",class:"mb-4"},{default:t(()=>[e(p,{start:"",icon:"tabler-info-circle"}),u(" "+i(l(a)("settings.business.description")),1)]),_:1})]),_:1})]),_:1})]),_:1}),(f(),F(re,null,ce(["shipping","users","products","communication","security","system"],c=>e(D,{key:c,value:c},{default:t(()=>[e(v,null,{default:t(()=>[e(E,null,{default:t(()=>[r("div",Re,[e(p,{icon:"tabler-clock",size:"64",class:"text-medium-emphasis mb-4"}),r("h3",Xe,i(l(a)("settings.coming_soon")),1),r("p",He,i(l(a)("settings.coming_soon_description",{feature:l(a)(`settings.tabs.${c}`)})),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])}}}),Va=ve(Je,[["__scopeId","data-v-8655aedf"]]);export{Va as default};
