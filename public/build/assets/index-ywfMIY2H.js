import{d as E,aL as Q,j as G,b7 as H,r as m,V as J,w as W,D as X,c as Y,o as Z,b as a,e as r,t as n,m as s,f as l,cD as ee,ac as h,az as g,s as V}from"./main-uLG9IIeX.js";import{u as te}from"./orders-Dybf-UtB.js";import{u as ae}from"./useNotifications-DDBS_wPD.js";import{_ as le}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-nczKusLe.js";import{V as oe}from"./VCardText-BZtszuIK.js";import{V as se,a as p}from"./VRow-aGfXYx3U.js";import{V as x}from"./VTextField-Dxeq5kx5.js";import{V as re}from"./VSelect-sWnAtot-.js";import{V as N}from"./VCard-CB1gT6RB.js";import{V as ie}from"./VDataTableServer-DfLBg0lg.js";import{V as q}from"./VChip-B84WcmDa.js";import{V as ne}from"./VAvatar-bHPDEsYY.js";import"./api-DSi3Suj8.js";import"./index-D-EbNoF1.js";import"./VBreadcrumbs-D7yKQl5l.js";/* empty css              */import"./VField-CfH1YcVv.js";import"./VImg-BS6_svHJ.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./VList-uZDByhc2.js";import"./ssrBoot-BPhRU-mF.js";import"./createSimpleFunctional-DugzUcbB.js";import"./VDivider-UqGR4x4D.js";import"./dialog-transition-2hF0ajsQ.js";import"./VMenu-DP1p-55V.js";import"./VCheckboxBtn-CogF2AUK.js";import"./VDataTable-DNqSzzrc.js";import"./VPagination-DYW6O4lq.js";import"./VTable-0U-NvIH3.js";import"./filter-D_SbaZWa.js";const de={class:"d-flex justify-space-between align-center mb-6"},ce={class:"text-h4 font-weight-bold mb-1"},ue={class:"text-body-1 text-medium-emphasis"},me={class:"d-flex align-center"},pe={class:"font-weight-medium"},fe={class:"text-caption text-medium-emphasis"},_e={class:"font-weight-medium"},be={class:"text-body-2"},ve={class:"text-center py-8"},he={class:"text-h6 mb-2"},ge={class:"text-body-2 text-medium-emphasis"},Ze=E({__name:"index",setup(ye){const{t:e}=Q(),U=G(),{showError:k}=ae(),d=te(),{orders:A,loading:T,pagination:y,filters:Ve,error:B}=H(d),f=m(""),_=m([]),C=m(""),b=m(""),v=m("");m(!1);const O=J(()=>[{title:e("nav.dashboard"),to:{name:"affiliate-dashboard"}},{title:e("affiliate_orders_title"),active:!0}]),P=[{value:"pending",title:e("affiliate_orders_status_pending"),color:"warning"},{value:"confirmed",title:e("affiliate_orders_status_confirmed"),color:"info"},{value:"sent",title:e("affiliate_orders_status_sent"),color:"primary"},{value:"expedited",title:e("affiliate_orders_status_expedited"),color:"purple"},{value:"delivered",title:e("affiliate_orders_status_delivered"),color:"success"},{value:"canceled",title:e("affiliate_orders_status_canceled"),color:"error"},{value:"returned",title:e("affiliate_orders_status_returned"),color:"orange"},{value:"delivery_failed",title:e("affiliate_orders_status_delivery_failed"),color:"error"},{value:"paid",title:e("affiliate_orders_status_paid"),color:"success"}],R=[{title:e("table.reference"),key:"id",sortable:!0},{title:e("table.client"),key:"client.nom_complet",sortable:!1},{title:e("table.boutique"),key:"boutique.nom",sortable:!1},{title:e("table.status"),key:"statut",sortable:!0},{title:e("table.total_ttc"),key:"total_ttc",sortable:!0},{title:e("table.date"),key:"created_at",sortable:!0},{title:e("table.actions"),key:"actions",sortable:!1}],w=()=>{d.updateFilters({q:f.value,status:_.value,boutique_id:C.value,date_from:b.value,date_to:v.value}),u()},I=()=>{f.value="",_.value=[],C.value="",b.value="",v.value="",d.resetFilters(),u()},u=async(o=1)=>{try{await d.fetchOrders(o)}catch{k(e("errors.orders_load_failed"))}},L=o=>{u(o)},$=o=>{d.updateFilters({per_page:o}),u()},j=o=>{if(o.length>0){const{key:i,order:t}=o[0];d.updateFilters({sort:i,dir:t}),u()}},F=o=>{U.push({name:"affiliate-orders-id",params:{id:o.id}})},K=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MAD"}).format(o),M=o=>new Date(o).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return W(B,o=>{o&&k(o)}),X(()=>{u()}),(o,i)=>(Z(),Y("div",null,[a(le,{items:O.value},null,8,["items"]),r("div",de,[r("div",null,[r("h1",ce,n(s(e)("affiliate_orders_title")),1),r("p",ue,n(s(e)("affiliate_orders_description")),1)])]),a(N,{class:"mb-6"},{default:l(()=>[a(oe,null,{default:l(()=>[a(se,null,{default:l(()=>[a(p,{cols:"12",sm:"6",md:"4",lg:"4"},{default:l(()=>[a(x,{modelValue:f.value,"onUpdate:modelValue":i[0]||(i[0]=t=>f.value=t),label:s(e)("search.label"),placeholder:s(e)("affiliate_orders_search_placeholder"),"prepend-inner-icon":"tabler-search",clearable:"",onKeyup:ee(w,["enter"])},null,8,["modelValue","label","placeholder"])]),_:1}),a(p,{cols:"12",sm:"6",md:"4",lg:"3"},{default:l(()=>[a(re,{modelValue:_.value,"onUpdate:modelValue":i[1]||(i[1]=t=>_.value=t),items:P,label:s(e)("table.status"),multiple:"",chips:"",clearable:"","item-title":"title","item-value":"value"},null,8,["modelValue","label"])]),_:1}),a(p,{cols:"12",sm:"6",md:"4",lg:"2"},{default:l(()=>[a(x,{modelValue:b.value,"onUpdate:modelValue":i[2]||(i[2]=t=>b.value=t),label:s(e)("filters.date_start"),type:"date"},null,8,["modelValue","label"])]),_:1}),a(p,{cols:"12",sm:"6",md:"4",lg:"2"},{default:l(()=>[a(x,{modelValue:v.value,"onUpdate:modelValue":i[3]||(i[3]=t=>v.value=t),label:s(e)("filters.date_end"),type:"date"},null,8,["modelValue","label"])]),_:1}),a(p,{cols:"12",sm:"12",md:"4",lg:"1",class:"d-flex align-center gap-2"},{default:l(()=>[a(h,{color:"primary",size:"small",onClick:w},{default:l(()=>[a(g,{icon:"tabler-search"})]),_:1}),a(h,{variant:"outlined",size:"small",onClick:I},{default:l(()=>[a(g,{icon:"tabler-refresh"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(N,null,{default:l(()=>[a(ie,{headers:R,items:s(A),loading:s(T),"items-length":s(y).total,"items-per-page":s(y).per_page,page:s(y).current_page,"item-value":"id","onUpdate:page":L,"onUpdate:itemsPerPage":$,"onUpdate:sortBy":j},{"item.id":l(({item:t})=>[a(h,{variant:"text",size:"small",color:"primary",onClick:c=>F(t)},{default:l(()=>[V(" #"+n(t.id.toString().slice(-8)),1)]),_:2},1032,["onClick"])]),"item.client.nom_complet":l(({item:t})=>{var c,S,z,D;return[r("div",me,[a(ne,{size:"32",class:"me-3"},{default:l(()=>[a(g,{icon:"tabler-user"})]),_:1}),r("div",null,[r("div",pe,n(((c=t.client)==null?void 0:c.nom_complet)||((S=t.clientFinal)==null?void 0:S.nom_complet)||"N/A"),1),r("div",fe,n(((z=t.client)==null?void 0:z.telephone)||((D=t.clientFinal)==null?void 0:D.telephone)||"N/A"),1)])])]}),"item.boutique.nom":l(({item:t})=>[a(q,{size:"small",variant:"tonal",color:"info"},{default:l(()=>{var c;return[V(n(((c=t.boutique)==null?void 0:c.nom)||"N/A"),1)]}),_:2},1024)]),"item.statut":l(({item:t})=>[a(q,{color:s(d).getStatusColor(t.statut),size:"small",variant:"tonal"},{default:l(()=>[V(n(s(d).getStatusLabel(t.statut)),1)]),_:2},1032,["color"])]),"item.total_ttc":l(({item:t})=>[r("span",_e,n(K(t.total_ttc)),1)]),"item.created_at":l(({item:t})=>[r("span",be,n(M(t.created_at)),1)]),"item.actions":l(({item:t})=>[a(h,{icon:"tabler-eye",size:"small",variant:"text",color:"primary",onClick:c=>F(t)},null,8,["onClick"])]),"no-data":l(()=>[r("div",ve,[a(g,{icon:"tabler-package-off",size:"64",class:"text-disabled mb-4"}),r("h3",he,n(s(e)("affiliate_orders_no_orders_found")),1),r("p",ge,n(s(e)("affiliate_orders_no_orders_description")),1)])]),_:1},8,["items","loading","items-length","items-per-page","page"])]),_:1})]))}});export{Ze as default};
