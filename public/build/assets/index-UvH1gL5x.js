import{d as K,aL as G,u as H,k as J,b8 as Q,r as X,V as O,o as Y,c as y,b as u,e,m as v,n as l,f as d,aU as Z,v as a,g as t,t as o,ac as B,h as b,az as z}from"./main-3LuWNv9W.js";import{u as tt}from"./orders-BxFrwsUj.js";import{u as et}from"./useNotifications-B3v5F4dH.js";import{_ as lt}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-BJ6JYbX8.js";import{O as at}from"./OrderStatusTimeline-DLRDWoKK.js";import{V as C}from"./VChip-D2hyzrT3.js";import{V as T,a as ot}from"./VTabs-DP9jTqW_.js";import{V as A,a as it}from"./VWindowItem-i89yeTzI.js";import{V as D,a as N}from"./VRow-aVZbYr4A.js";import{V as h,b as k}from"./VCard-QqgF9aMj.js";import{V as x}from"./VCardText-Dqaeyxp0.js";import{V as q,a as _,b as c,d as p}from"./VList-DWKF8cD-.js";import{V as R}from"./VDataTable-Dz5dOo4J.js";import{V as U}from"./VAlert-cTzgSexk.js";import"./VBreadcrumbs-Cjt6xYOm.js";import"./VTimeline-De-t2MSL.js";import"./VExpansionPanels-6rxyNxLA.js";import"./lazy-vcHGEOxt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VAvatar-CH3JpKwD.js";import"./VImg-DjZhnPY1.js";import"./forwardRefs-BZg6tG7B.js";import"./ssrBoot-DPE17Lki.js";/* empty css              */import"./createSimpleFunctional-CbZg_Do-.js";import"./VDivider-D28qXVrs.js";import"./VPagination-C9G78dYZ.js";import"./VSelect-V4QjM3w5.js";import"./VTextField-CsO1UfXI.js";import"./VField-CzoZXYxi.js";import"./dialog-transition-TWAYErkS.js";import"./VMenu-cCaIVuKn.js";import"./VOverlay-DHKe6cTP.js";import"./VCheckboxBtn-BQUGQfLA.js";import"./VTable-Dyn4MLHa.js";import"./filter-DJ4i-HET.js";const st={key:0,class:"text-center py-8"},rt={class:"text-body-1 mt-4"},nt={key:1},ut={class:"d-flex justify-space-between align-center mb-6"},dt={class:"text-h4 font-weight-bold mb-1"},mt={class:"d-flex align-center gap-4"},ft={class:"text-body-2 text-medium-emphasis"},_t=["href"],ct={class:"text-body-1"},pt={class:"font-weight-medium"},yt={key:1,class:"text-medium-emphasis"},bt={key:1,class:"text-medium-emphasis"},vt={class:"font-weight-medium"},ht={class:"font-weight-bold"},kt={key:0},Vt={key:1},gt={key:0},xt={class:"font-weight-bold"},wt={key:1},Ct={class:"mt-6"},St={key:2,class:"text-center py-8"},Tt={class:"text-h6 mb-2"},At={class:"text-body-2 text-medium-emphasis mb-4"},fe=K({__name:"index",setup(Nt){const{t:s}=G(),P=H(),F=J(),{showError:E}=et(),V=tt(),{currentOrder:i,loading:M,error:I}=Q(V),S=X("details"),W=O(()=>{var f;return[{title:s("dashboard"),to:{name:"affiliate-dashboard"}},{title:s("my_orders"),to:{name:"affiliate-orders"}},{title:((f=i.value)==null?void 0:f.numero_commande)||s("order_details"),active:!0}]});O(()=>{var f;return(f=i.value)!=null&&f.articles?i.value.articles.reduce((r,w)=>r+w.quantite*w.prix_unitaire,0):0});const $=async()=>{try{await V.fetchOrder(P.params.id)}catch{E(s("order_loading_error")),F.push({name:"affiliate-orders"})}},g=f=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MAD"}).format(f),j=f=>new Date(f).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=()=>{F.push({name:"affiliate-orders"})};return Y(()=>{$()}),(f,r)=>{var w;return u(),y("div",null,[e(lt,{items:W.value},null,8,["items"]),l(M)?(u(),y("div",st,[e(Z,{indeterminate:"",color:"primary",size:"64"}),d("p",rt,a(l(s)("order_loading")),1)])):l(i)?(u(),y("div",nt,[d("div",ut,[d("div",null,[d("h1",dt,a(l(s)("order_number",{number:l(i).id.toString().slice(-8)})),1),d("div",mt,[e(C,{color:l(V).getStatusColor(l(i).statut),variant:"tonal"},{default:t(()=>[o(a(l(V).getStatusLabel(l(i).statut)),1)]),_:1},8,["color"]),d("span",ft,a(l(s)("affiliate.orders.createdOn",{date:j(l(i).created_at)})),1)])]),e(B,{variant:"outlined","prepend-icon":"tabler-arrow-left",onClick:L},{default:t(()=>[o(a(l(s)("actions.back")),1)]),_:1})]),e(ot,{modelValue:S.value,"onUpdate:modelValue":r[0]||(r[0]=n=>S.value=n),class:"mb-6"},{default:t(()=>[e(T,{value:"details"},{default:t(()=>[o(a(l(s)("common.details")),1)]),_:1}),e(T,{value:"articles"},{default:t(()=>[o(a(l(s)("affiliate.orders.articles")),1)]),_:1}),e(T,{value:"shipping"},{default:t(()=>[o(a(l(s)("affiliate.orders.shipping")),1)]),_:1}),e(T,{value:"commissions"},{default:t(()=>[o(a(l(s)("commissions")),1)]),_:1})]),_:1},8,["modelValue"]),e(it,{modelValue:S.value,"onUpdate:modelValue":r[1]||(r[1]=n=>S.value=n)},{default:t(()=>[e(A,{value:"details"},{default:t(()=>[e(D,null,{default:t(()=>[e(N,{cols:"12",md:"6"},{default:t(()=>[e(h,null,{default:t(()=>[e(k,null,{default:t(()=>[o(a(l(s)("order_information")),1)]),_:1}),e(x,null,{default:t(()=>[e(q,null,{default:t(()=>[e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("reference")),1)]),_:1}),e(p,null,{default:t(()=>[o("#"+a(l(i).id),1)]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("form.status")),1)]),_:1}),e(p,null,{default:t(()=>[e(C,{color:l(V).getStatusColor(l(i).statut),size:"small",variant:"tonal"},{default:t(()=>[o(a(l(V).getStatusLabel(l(i).statut)),1)]),_:1},8,["color"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("boutique")),1)]),_:1}),e(p,null,{default:t(()=>{var n;return[o(a(((n=l(i).boutique)==null?void 0:n.nom)||"N/A"),1)]}),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("payment_method")),1)]),_:1}),e(p,null,{default:t(()=>[o(a(l(i).mode_paiement||"N/A"),1)]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("total_ht")),1)]),_:1}),e(p,null,{default:t(()=>[o(a(g(l(i).total_ht)),1)]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("total_ttc")),1)]),_:1}),e(p,{class:"font-weight-bold"},{default:t(()=>[o(a(g(l(i).total_ttc)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{cols:"12",md:"6"},{default:t(()=>[e(h,null,{default:t(()=>[e(k,null,{default:t(()=>[o(a(l(s)("client_information")),1)]),_:1}),e(x,null,{default:t(()=>[e(q,null,{default:t(()=>[l(i).client?(u(),b(_,{key:0},{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("client")),1)]),_:1}),e(p,null,{default:t(()=>[o(a(l(i).client.nom_complet),1)]),_:1})]),_:1})):v("",!0),l(i).clientFinal?(u(),b(_,{key:1},{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("final_client")),1)]),_:1}),e(p,null,{default:t(()=>[o(a(l(i).clientFinal.nom_complet),1),r[2]||(r[2]=d("br",null,null,-1)),o(" "+a(l(i).clientFinal.telephone),1),r[3]||(r[3]=d("br",null,null,-1)),o(" "+a(l(i).clientFinal.email),1)]),_:1,__:[2,3]})]),_:1})):v("",!0),l(i).adresse?(u(),b(_,{key:2},{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("affiliate.orders.deliveryAddress")),1)]),_:1}),e(p,null,{default:t(()=>[o(a(l(i).adresse.adresse),1),r[4]||(r[4]=d("br",null,null,-1)),o(" "+a(l(i).adresse.ville),1)]),_:1,__:[4]})]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(i).delivery_boy_name||l(i).delivery_boy_phone?(u(),b(h,{key:0,class:"mt-6"},{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(z,{icon:"tabler-user",class:"me-2"}),o(" "+a(l(s)("delivery_boy_information")),1)]),_:1}),e(x,null,{default:t(()=>[e(D,null,{default:t(()=>[l(i).delivery_boy_name?(u(),b(N,{key:0,cols:"12",md:"6"},{default:t(()=>[e(q,null,{default:t(()=>[e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("delivery_boy_name")),1)]),_:1}),e(p,{class:"font-weight-medium"},{default:t(()=>[o(a(l(i).delivery_boy_name),1)]),_:1})]),_:1})]),_:1})]),_:1})):v("",!0),l(i).delivery_boy_phone?(u(),b(N,{key:1,cols:"12",md:"6"},{default:t(()=>[e(q,null,{default:t(()=>[e(_,null,{default:t(()=>[e(c,null,{default:t(()=>[o(a(l(s)("delivery_boy_phone")),1)]),_:1}),e(p,null,{default:t(()=>[d("a",{href:`tel:${l(i).delivery_boy_phone}`,class:"text-decoration-none text-primary font-weight-medium"},[e(z,{icon:"tabler-phone",size:"16",class:"me-1"}),o(" "+a(l(i).delivery_boy_phone),1)],8,_t)]),_:1})]),_:1})]),_:1})]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1})):v("",!0),l(i).notes?(u(),b(h,{key:1,class:"mt-6"},{default:t(()=>[e(k,null,{default:t(()=>r[5]||(r[5]=[o("Notes")])),_:1,__:[5]}),e(x,null,{default:t(()=>[d("p",ct,a(l(i).notes),1)]),_:1})]),_:1})):v("",!0)]),_:1}),e(A,{value:"articles"},{default:t(()=>[e(h,null,{default:t(()=>[e(k,null,{default:t(()=>r[6]||(r[6]=[o("Articles commandés")])),_:1,__:[6]}),e(R,{headers:[{title:l(s)("affiliate.orders.product"),key:"produit.titre"},{title:"SKU",key:"produit.sku"},{title:l(s)("affiliate.orders.variant"),key:"variante.nom"},{title:l(s)("affiliate.orders.quantity"),key:"quantite"},{title:l(s)("affiliate.orders.unitPrice"),key:"prix_unitaire"},{title:l(s)("affiliate.orders.total"),key:"total"}],items:l(i).articles||[],"hide-default-footer":""},{"item.produit.titre":t(({item:n})=>{var m;return[d("div",pt,a(((m=n.produit)==null?void 0:m.titre)||"N/A"),1)]}),"item.produit.sku":t(({item:n})=>{var m;return[(m=n.produit)!=null&&m.sku?(u(),b(C,{key:0,size:"small",color:"secondary",variant:"outlined",class:"font-mono"},{default:t(()=>[o(a(n.produit.sku),1)]),_:2},1024)):(u(),y("span",yt,"-"))]}),"item.variante.nom":t(({item:n})=>[n.variante?(u(),b(C,{key:0,size:"small",variant:"tonal",color:"info"},{default:t(()=>[o(a(n.variante.nom),1)]),_:2},1024)):(u(),y("span",bt,"-"))]),"item.quantite":t(({item:n})=>[d("span",vt,a(n.quantite),1)]),"item.prix_unitaire":t(({item:n})=>[o(a(g(n.prix_unitaire)),1)]),"item.total":t(({item:n})=>[d("span",ht,a(g(n.quantite*n.prix_unitaire)),1)]),_:1},8,["headers","items"])]),_:1})]),_:1}),e(A,{value:"shipping"},{default:t(()=>[e(h,null,{default:t(()=>[e(k,null,{default:t(()=>r[7]||(r[7]=[o("Informations d'expédition")])),_:1,__:[7]}),e(x,null,{default:t(()=>[l(i).shippingParcel?(u(),y("div",kt,r[8]||(r[8]=[d("p",{class:"text-body-1 mb-4"},"Colis créé et en cours de traitement",-1)]))):(u(),y("div",Vt,[e(U,{type:"info",variant:"tonal"},{default:t(()=>r[9]||(r[9]=[o(" Cette commande n'a pas encore été expédiée. ")])),_:1,__:[9]})]))]),_:1})]),_:1})]),_:1}),e(A,{value:"commissions"},{default:t(()=>[e(h,null,{default:t(()=>[e(k,null,{default:t(()=>r[10]||(r[10]=[o("Commissions")])),_:1,__:[10]}),e(x,null,{default:t(()=>{var n;return[(n=l(i).commissions)!=null&&n.length?(u(),y("div",gt,[e(R,{headers:[{title:l(s)("affiliate.orders.type"),key:"type"},{title:l(s)("affiliate.orders.baseAmount"),key:"base_amount"},{title:l(s)("affiliate.orders.rate"),key:"rate"},{title:l(s)("affiliate.orders.commission"),key:"amount"},{title:l(s)("form.status"),key:"status"}],items:l(i).commissions,"hide-default-footer":""},{"item.base_amount":t(({item:m})=>[o(a(g(m.base_amount)),1)]),"item.rate":t(({item:m})=>[o(a((m.rate*100).toFixed(2))+"% ",1)]),"item.amount":t(({item:m})=>[d("span",xt,a(g(m.amount)),1)]),"item.status":t(({item:m})=>[e(C,{size:"small",variant:"tonal",color:m.status==="paid"?"success":m.status==="eligible"?"info":"warning"},{default:t(()=>[o(a(m.status),1)]),_:2},1032,["color"])]),_:1},8,["headers","items"])])):(u(),y("div",wt,[e(U,{type:"info",variant:"tonal"},{default:t(()=>r[11]||(r[11]=[o(" Aucune commission générée pour cette commande. ")])),_:1,__:[11]})]))]}),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),d("div",Ct,[(w=l(i))!=null&&w.id?(u(),b(at,{key:0,"order-id":l(i).id,endpoint:"affiliate"},null,8,["order-id"])):v("",!0)])])):l(I)?(u(),y("div",St,[e(z,{icon:"tabler-alert-circle",size:"64",class:"text-error mb-4"}),d("h3",Tt,a(l(s)("affiliate_order_error_title")),1),d("p",At,a(l(I)),1),e(B,{color:"primary",onClick:L},{default:t(()=>[o(a(l(s)("affiliate.orders.backToOrders")),1)]),_:1})])):v("",!0)])}}});export{fe as default};
