import{d as Be,r as c,V as Y,h as ce,b as y,g as a,e as t,f as o,az as h,v as u,ac as f,c as D,m as T,aU as nt,t as _,aL as it,k as rt,o as st,cT as ot,n as d,q as ee,F as Ne,j as dt}from"./main-DEzoUo6n.js";import{u as ut}from"./shipping-B5S7RRy8.js";import{useConfirmAction as pt}from"./useConfirmAction-lawnJ6WL.js";import{u as ct}from"./useNotifications-Bc6GUAmT.js";import{V as z,b as de,c as ue}from"./VCard-BQBmQiQJ.js";import{V as le}from"./VSpacer-om3XMluz.js";import{V as Se}from"./VDivider-96JDmIpb.js";import{V as M}from"./VCardText-DtKfeQ8i.js";import{a as _t,V as mt,b as vt,c as ft}from"./VTabs-CxFrGzcq.js";import{V as _e,a as L}from"./VRow-CCKjjrNU.js";import{V as P}from"./VChip-BLx6lUDe.js";import{V as pe}from"./VDialog-SdVxorIC.js";import{O as gt}from"./OzonExpressConfirmDialog-Cm_Uy-hj.js";import{V as te}from"./VTextField-BiqUvfe6.js";import{V as ye}from"./VSelect-DRK_p5uX.js";import{V as yt}from"./VDataTableServer-BPywD3NC.js";import{V as ae}from"./VTooltip-CxfTaIey.js";import"./VMenu-CAJpv2vQ.js";import"./VList-PlS4cpk2.js";import{V as Ie}from"./VTextarea-BfvN6PTe.js";import{V as ht,a as kt}from"./VAlert--Qma1TSN.js";import"./createSimpleFunctional-DUhC6iZd.js";import"./VAvatar-DcdpS4jo.js";import"./VImg-Dcm3Nb79.js";/* empty css              */import"./forwardRefs-BYcTBJDs.js";import"./VWindowItem-C6fSLCsq.js";import"./lazy-BPEwf1-U.js";import"./ssrBoot-BNMsj90G.js";import"./VOverlay-D7sMErQR.js";import"./dialog-transition-PfMbSZsR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VField-BrxQSdNw.js";import"./VCheckboxBtn-ispl65Ef.js";import"./VDataTable-CY4RDaZO.js";import"./VPagination-BwetZgLf.js";import"./VTable-pKKqnQcU.js";import"./filter-C0NlBkaG.js";const bt={class:"text-body-2 text-medium-emphasis mb-0"},Vt={key:0,class:"text-center py-8"},xt={key:1,class:"text-center py-8"},Ct={class:"text-body-2 text-medium-emphasis"},wt={key:2},Tt={class:"d-flex flex-column gap-3"},Dt={class:"d-flex justify-space-between"},Nt={class:"d-flex justify-space-between"},St={key:0,class:"d-flex justify-space-between"},It={class:"text-body-2"},Bt={key:1,class:"d-flex justify-space-between"},Lt={key:2,class:"d-flex justify-space-between"},Rt={class:"text-body-2"},$t={class:"text-h6 mb-4 d-flex align-center"},zt={class:"d-flex flex-column gap-3"},Pt={key:0,class:"d-flex justify-space-between"},At={class:"text-body-2 font-weight-medium"},Et={key:1,class:"d-flex justify-space-between"},Ut=["href"],Ot=Be({__name:"TrackingModal",props:{modelValue:{type:Boolean},trackingNumber:{},trackingData:{},loading:{type:Boolean,default:!1},error:{default:""},deliveryBoyName:{},deliveryBoyPhone:{}},emits:["update:modelValue","refresh","retry"],setup(he,{emit:e}){const x=he,v=e,j=c("summary"),N=s=>{v("update:modelValue",s)},k=Y(()=>{var r,m,g,b,B,V;if((m=(r=x.trackingData)==null?void 0:r.parcel)!=null&&m.status)return{status:x.trackingData.parcel.status,status_text:x.trackingData.parcel.last_status_text||x.trackingData.parcel.status,time:x.trackingData.parcel.last_status_at,comment:(g=x.trackingData.parcel.meta)==null?void 0:g.last_status_comment};if(!((V=(B=(b=x.trackingData)==null?void 0:b.tracking_info)==null?void 0:B.TRACKING)!=null&&V.LAST_TRACKING))return null;const s=x.trackingData.tracking_info.TRACKING.LAST_TRACKING;return{status:R(s.STATUT),status_text:s.STATUT,time:s.TIME_STR,comment:s.COMMENT}}),I=Y(()=>{var r,m,g;if(!((g=(m=(r=x.trackingData)==null?void 0:r.parcel_info)==null?void 0:m.PARCEL_INFO)!=null&&g.INFOS))return null;const s=x.trackingData.parcel_info.PARCEL_INFO.INFOS;return{city_name:s.CITY_NAME,receiver:s.RECEIVER,price:parseFloat(s.PRICE)||0,delivered_price:parseFloat(s["DELIVERED-PRICE"])||0,returned_price:parseFloat(s["RETURNED-PRICE"])||0,refused_price:parseFloat(s["REFUSED-PRICE"])||0}});Y(()=>{var r,m,g;if(!((g=(m=(r=x.trackingData)==null?void 0:r.tracking_info)==null?void 0:m.TRACKING)!=null&&g.HISTORY))return[];const s=x.trackingData.tracking_info.TRACKING.HISTORY;return Array.isArray(s)?s.map(b=>({status:R(b.STATUT),status_text:b.STATUT,time:b.TIME_STR,comment:b.COMMENT})).reverse():[]});const R=s=>s&&{"Nouveau Colis":"pending","Colis Reçu":"received","En Transit":"in_transit","En Cours de Livraison":"out_for_delivery",Livré:"delivered",Retourné:"returned",Refusé:"refused",Annulé:"cancelled","En Attente":"pending",Expédié:"shipped","Arrivé au Centre":"at_facility","Prêt pour Livraison":"ready_for_delivery","Tentative de Livraison":"delivery_attempted"}[s]||"unknown",A=s=>{switch(s==null?void 0:s.toLowerCase()){case"delivered":return"success";case"in_transit":case"out_for_delivery":case"shipped":return"info";case"pending":case"received":case"at_facility":case"ready_for_delivery":return"warning";case"cancelled":case"refused":case"delivery_attempted":return"error";case"returned":return"secondary";default:return"default"}},E=s=>{try{return new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}};return(s,r)=>(y(),ce(pe,{"model-value":s.modelValue,"max-width":"800",persistent:"","onUpdate:modelValue":N},{default:a(()=>[t(z,null,{default:a(()=>[t(de,{class:"d-flex align-center gap-2 pa-6"},{default:a(()=>[t(h,{icon:"tabler-route",color:"primary"}),o("div",null,[r[6]||(r[6]=o("h6",{class:"text-h6"},"Suivi de Colis",-1)),o("p",bt,u(s.trackingNumber),1)]),t(le),t(f,{icon:"tabler-x",variant:"text",size:"small",onClick:r[0]||(r[0]=m=>N(!1))})]),_:1}),t(Se),t(M,{class:"pa-0"},{default:a(()=>[s.loading?(y(),D("div",Vt,[t(nt,{indeterminate:"",color:"primary"}),r[7]||(r[7]=o("p",{class:"mt-4 text-body-1"},"Chargement du suivi...",-1))])):s.error?(y(),D("div",xt,[t(h,{icon:"tabler-alert-circle",size:"64",color:"error",class:"mb-4"}),r[9]||(r[9]=o("h6",{class:"text-h6 mb-2"},"Erreur de suivi",-1)),o("p",Ct,u(s.error),1),t(f,{color:"primary",variant:"outlined",onClick:r[1]||(r[1]=m=>s.$emit("retry"))},{default:a(()=>r[8]||(r[8]=[_(" Réessayer ")])),_:1,__:[8]})])):s.trackingData?(y(),D("div",wt,[t(_t,{modelValue:j.value,"onUpdate:modelValue":r[2]||(r[2]=m=>j.value=m),class:"border-b"},{default:a(()=>[t(mt,{value:"summary"},{default:a(()=>[t(h,{start:"",icon:"tabler-info-circle"}),r[10]||(r[10]=_(" Résumé "))]),_:1,__:[10]})]),_:1},8,["modelValue"]),t(vt,{modelValue:j.value,"onUpdate:modelValue":r[3]||(r[3]=m=>j.value=m)},{default:a(()=>[t(ft,{value:"summary",class:"pa-6"},{default:a(()=>[t(_e,null,{default:a(()=>[t(L,{cols:"12"},{default:a(()=>[t(z,{variant:"outlined",class:"h-100"},{default:a(()=>[t(M,null,{default:a(()=>{var m,g,b,B;return[r[16]||(r[16]=o("h6",{class:"text-h6 mb-4"},"Informations du Colis",-1)),o("div",Tt,[o("div",Dt,[r[11]||(r[11]=o("span",{class:"text-body-2 text-medium-emphasis"},"Numéro de suivi:",-1)),t(P,{size:"small",color:"primary",variant:"tonal",class:"font-mono"},{default:a(()=>[_(u(s.trackingNumber),1)]),_:1})]),o("div",Nt,[r[12]||(r[12]=o("span",{class:"text-body-2 text-medium-emphasis"},"Statut actuel:",-1)),t(P,{size:"small",color:A((m=k.value)==null?void 0:m.status),variant:"tonal"},{default:a(()=>{var V;return[_(u(((V=k.value)==null?void 0:V.status_text)||"Inconnu"),1)]}),_:1},8,["color"])]),(g=k.value)!=null&&g.time?(y(),D("div",St,[r[13]||(r[13]=o("span",{class:"text-body-2 text-medium-emphasis"},"Dernière mise à jour:",-1)),o("span",It,u(E(k.value.time)),1)])):T("",!0),(b=I.value)!=null&&b.city_name?(y(),D("div",Bt,[r[14]||(r[14]=o("span",{class:"text-body-2 text-medium-emphasis"},"Ville:",-1)),t(P,{size:"small",color:"info",variant:"tonal"},{default:a(()=>[_(u(I.value.city_name),1)]),_:1})])):T("",!0),(B=I.value)!=null&&B.receiver?(y(),D("div",Lt,[r[15]||(r[15]=o("span",{class:"text-body-2 text-medium-emphasis"},"Destinataire:",-1)),o("span",Rt,u(I.value.receiver),1)])):T("",!0)])]}),_:1,__:[16]})]),_:1})]),_:1})]),_:1}),s.deliveryBoyName||s.deliveryBoyPhone?(y(),ce(_e,{key:0,class:"mt-4"},{default:a(()=>[t(L,{cols:"12"},{default:a(()=>[t(z,{variant:"outlined"},{default:a(()=>[t(M,null,{default:a(()=>[o("h6",$t,[t(h,{icon:"tabler-user",class:"me-2"}),r[17]||(r[17]=_(" Informations du Livreur "))]),o("div",zt,[s.deliveryBoyName?(y(),D("div",Pt,[r[18]||(r[18]=o("span",{class:"text-body-2 text-medium-emphasis"},"Nom du livreur:",-1)),o("span",At,u(s.deliveryBoyName),1)])):T("",!0),s.deliveryBoyPhone?(y(),D("div",Et,[r[19]||(r[19]=o("span",{class:"text-body-2 text-medium-emphasis"},"Téléphone:",-1)),o("a",{href:`tel:${s.deliveryBoyPhone}`,class:"text-decoration-none text-primary font-weight-medium"},[t(h,{icon:"tabler-phone",size:"16",class:"me-1"}),_(" "+u(s.deliveryBoyPhone),1)],8,Ut)])):T("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})):T("",!0)]),_:1})]),_:1},8,["modelValue"])])):T("",!0)]),_:1}),t(Se),t(ue,{class:"pa-6"},{default:a(()=>[t(f,{color:"primary",variant:"outlined",onClick:r[4]||(r[4]=m=>s.$emit("refresh")),loading:s.loading},{default:a(()=>[t(h,{start:"",icon:"tabler-refresh"}),r[20]||(r[20]=_(" Actualiser "))]),_:1,__:[20]},8,["loading"]),t(le),t(f,{color:"secondary",variant:"text",onClick:r[5]||(r[5]=m=>N(!1))},{default:a(()=>[_(u(s.t("actions.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),Ft={class:"d-flex flex-column gap-6"},Mt={class:"d-flex justify-space-between align-center mb-6"},jt={class:"text-h4 font-weight-bold mb-1"},qt={class:"text-body-1 mb-0"},Kt={class:"d-flex gap-2"},Gt={class:"d-flex align-center gap-2"},Wt={class:"font-weight-medium"},Yt={class:"text-caption text-medium-emphasis"},Ht={key:0,class:"text-caption text-info"},Qt={class:"d-flex flex-wrap gap-1"},Jt={class:"font-weight-bold"},Xt={class:"text-body-2"},Zt={class:"d-flex gap-1"},ea={class:"text-center py-8"},ta={class:"text-h6 mb-2"},aa={class:"text-body-2 text-medium-emphasis"},la={class:"mb-4"},na={class:"mb-4"},Ha=Be({__name:"index",setup(he){const{t:e}=it(),x=rt(),v=ut(),{confirm:j}=pt(),{showSuccess:N,showError:k}=ct(),I=c(""),R=c(""),A=c(""),E=c(""),s=c(15),r=c([]),m=c([]),g=c(!1),b=c(!1),B=c(""),V=c(""),H=c(""),ne=c(null),Q=c(!1),ie=c(""),$=c(null),q=c(!1),K=c(!1),re=c(null),J=c(""),X=c(""),Le=Y(()=>v.isLoading),me=Y(()=>v.shippingOrders),ke=Y(()=>v.pagination),Re=[{title:e("tracking"),key:"tracking_number",sortable:!0},{title:e("client"),key:"client",sortable:!1},{title:e("city"),key:"city",sortable:!1},{title:"SKU",key:"sku_list",sortable:!1,width:"150px"},{title:e("order_type"),key:"type_command",sortable:!1},{title:e("status"),key:"status",sortable:!0},{title:e("total"),key:"total_ttc",sortable:!0},{title:e("updated"),key:"updated_at",sortable:!0},{title:e("actions"),key:"actions",sortable:!1}],$e=[{title:e("all"),value:""},{title:e("pending"),value:"pending"},{title:e("received"),value:"received"},{title:e("in_transit"),value:"in_transit"},{title:e("shipped"),value:"shipped"},{title:e("at_facility"),value:"at_facility"},{title:e("ready_for_delivery"),value:"ready_for_delivery"},{title:e("out_for_delivery"),value:"out_for_delivery"},{title:e("delivery_attempted"),value:"delivery_attempted"},{title:e("delivered"),value:"delivered"},{title:e("returned"),value:"returned"},{title:e("refused"),value:"refused"},{title:e("cancelled"),value:"cancelled"},{title:e("unknown"),value:"unknown"}],U=async()=>{await v.fetchShippingOrders({q:I.value||void 0,status:R.value||void 0,from:A.value||void 0,to:E.value||void 0,perPage:s.value})},Z=()=>{v.fetchShippingOrders({page:1,q:I.value||void 0,status:R.value||void 0,from:A.value||void 0,to:E.value||void 0,perPage:s.value})},ze=i=>{v.fetchShippingOrders({page:i})},Pe=i=>{i.length>0&&v.fetchShippingOrders({sort:i[0].key,dir:i[0].order})},Ae=i=>{x.push({name:"admin-orders-shipping-id",params:{id:i.id}})},se=c(!1),ve=c(null),G=c(!1),O=c(""),W=c(""),fe=c(null);c(!1);const be=c(!1),ge=c(!1),Ve=c(null),xe=async i=>{W.value=i.shipping_parcel.tracking_number,fe.value=i,G.value=!0,O.value="";try{const[l,p]=await Promise.all([v.trackParcel(i.shipping_parcel.tracking_number),v.getParcelInfoNew(i.shipping_parcel.tracking_number)]);ve.value={tracking_info:l,parcel_info:p,parcel:i.shipping_parcel},se.value=!0}catch(l){O.value=l.message||e("admin_shipping_error_tracking"),k(O.value)}finally{G.value=!1}},Ce=async()=>{if(W.value){G.value=!0,O.value="";try{const[i,l]=await Promise.all([v.trackParcel(W.value),v.getParcelInfoNew(W.value)]),p=me.value.find(S=>{var n;return((n=S.shipping_parcel)==null?void 0:n.tracking_number)===W.value});ve.value={tracking_info:i,parcel_info:l,parcel:p==null?void 0:p.shipping_parcel},N(e("admin_shipping_tracking_updated")),await U()}catch(i){O.value=i.message||e("admin_shipping_error_tracking_refresh"),k(O.value)}finally{G.value=!1}}},Ee=async i=>{const l=i.shipping_parcel.tracking_number;m.value.push(l);try{const p=await v.refreshTracking(l);p.success?N(e("admin_shipping_tracking_updated")):k(p.message||e("admin_shipping_error_tracking_update"))}catch(p){k(p.message||e("admin_shipping_error_tracking_update"))}finally{m.value=m.value.filter(p=>p!==l)}},Ue=async()=>{if(r.value.length===0){k(e("admin_shipping_error_select_order"));return}if(await j({title:e("admin_shipping_tracking_refresh"),text:e("admin_shipping_tracking_refresh_confirm",{count:r.value.length}),confirmText:e("admin_shipping_button_refresh"),cancelText:e("admin_shipping_button_cancel")}))try{const l=r.value.map(S=>{var C;const n=me.value.find(oe=>oe.id===S);return(C=n==null?void 0:n.shipping_parcel)==null?void 0:C.tracking_number}).filter(Boolean),p=await v.refreshTrackingBulk(l);N(p.message||e("admin_shipping_tracking_updated")),r.value=[]}catch(l){k(l.message||e("admin_shipping_error_tracking_update"))}},Oe=async i=>{if(Ve.value){ge.value=!0;try{await v.resendToOzon(Ve.value.id,i);const l=e(i==="ramassage"?"admin_shipping_mode_ramassage":"admin_shipping_mode_stock");N(e("admin_shipping_ozonexpress_resend",{mode:l})),await U()}catch(l){k(l.message||e("admin_shipping_error_ozonexpress_resend"))}finally{ge.value=!1}}},Fe=()=>{},Me=i=>{var l;B.value=i.id,V.value=((l=i.shipping_parcel)==null?void 0:l.status)||"",H.value="",g.value=!0},je=async()=>{if(!(!V.value||!B.value)){b.value=!0;try{await v.updateShippingStatus(B.value,{status:V.value,note:H.value||void 0}),N(`Statut mis à jour vers: ${we(V.value)}`+(V.value==="livree"?" (Commission créée automatiquement)":"")),g.value=!1,await U()}catch(i){k(i.message||"Erreur lors de la mise à jour du statut")}finally{b.value=!1}}},qe=()=>{g.value=!1,B.value="",V.value="",H.value=""},Ke=async()=>{if($.value){ne.value=$.value.id;try{await v.incrementStock($.value.id,ie.value),N("Commande retournée en entrepôt avec succès et stock ré-incrémenté"),Q.value=!1,await U()}catch(i){k(i.message||"Erreur lors du retour en entrepôt")}finally{ne.value=null,$.value=null}}},Ge=()=>{Q.value=!1,$.value=null,ie.value=""},We=i=>{re.value=i,J.value=i.delivery_boy_name||"",X.value=i.delivery_boy_phone||"",q.value=!0},Ye=async()=>{if(re.value){K.value=!0;try{await v.updateDeliveryBoyInfo(re.value.id,{delivery_boy_name:J.value.trim()||null,delivery_boy_phone:X.value.trim()||null}),N(e("delivery_person_info_updated_success")),q.value=!1,await U()}catch(i){k(i.message||e("error_updating"))}finally{K.value=!1}}},He=()=>{q.value=!1,re.value=null,J.value="",X.value=""},Qe=i=>{switch(i==null?void 0:i.toLowerCase()){case"delivered":return"success";case"shipped":case"in_transit":case"out_for_delivery":return"info";case"pending":case"received":case"at_facility":case"ready_for_delivery":return"warning";case"cancelled":case"refused":case"delivery_attempted":return"error";case"returned":return"secondary";case"returned_to_warehouse":return"info";case"unknown":return"default";default:return"default"}},Je=i=>({pending:e("admin_shipping_status_pending"),en_attente:e("admin_shipping_status_pending"),in_progress:e("admin_shipping_status_in_progress"),en_cours:e("admin_shipping_status_in_progress"),confirmed:e("admin_shipping_status_confirmed"),confirmee:e("admin_shipping_status_confirmed_fem"),picked_up:e("admin_shipping_status_picked_up"),collectee:e("admin_shipping_status_picked_up_fem"),shipped:e("admin_shipping_status_shipped"),in_transit:e("admin_shipping_status_in_transit"),at_facility:e("admin_shipping_status_at_facility"),expediee:e("admin_shipping_status_expedited"),ready_for_delivery:e("admin_shipping_status_ready_delivery"),out_for_delivery:e("admin_shipping_status_out_delivery"),delivery_attempted:e("admin_shipping_status_delivery_attempted"),delivered:e("admin_shipping_status_delivered"),livree:e("admin_shipping_status_delivered_fem"),returned:e("order.status.returned"),retournee:e("order.status.returned_feminine"),returned_to_warehouse:e("order.status.returned_to_warehouse"),refused:e("admin_shipping_status_refused"),refusee:e("admin_shipping_status_refused_fem"),cancelled:e("admin_shipping_status_cancelled"),annulee:e("admin_shipping_status_cancelled_fem"),unknown:e("admin_shipping_status_unknown")})[i==null?void 0:i.toLowerCase()]||i||e("admin_shipping_status_unknown"),we=i=>Je(i),Xe=i=>new Intl.NumberFormat("fr-MA",{style:"currency",currency:"MAD"}).format(i),Ze=i=>({order_sample:"primary",exchange:"warning"})[i]||"secondary",et=i=>({order_sample:"Échantillon",exchange:"Échange"})[i]||i||"N/A",tt=i=>new Date(i).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),at=i=>{var l,p;return((l=i.client_final_data)==null?void 0:l.nom_complet)||((p=i.client)==null?void 0:p.nom_complet)||e("admin_shipping_client_na")},lt=i=>{var l,p;return((l=i.client_final_data)==null?void 0:l.telephone)||((p=i.client)==null?void 0:p.telephone)||e("admin_shipping_client_na")},Te=i=>{var l,p,S;return((l=i.client_final_data)==null?void 0:l.ville)||((p=i.shipping_parcel)==null?void 0:p.city_name)||((S=i.adresse)==null?void 0:S.ville)||null},De=()=>{I.value="",R.value="",A.value="",E.value="",v.resetFilters(),U()},ia=(i,l)=>{let p="";switch(l){case"pdf":p=`https://client.ozoneexpress.ma/pdf-delivery-note?dn-ref=${i}`;break;case"a4":p=`https://client.ozoneexpress.ma/pdf-delivery-note-tickets?dn-ref=${i}`;break;case"100x100":p=`https://client.ozoneexpress.ma/pdf-delivery-note-tickets-4-4?dn-ref=${i}`;break}p&&window.open(p,"_blank")};return st(()=>{U()}),ot((i,l,p)=>{console.log("🚪 [Navigation] Leaving shipping orders page");try{g.value=!1,Q.value=!1,q.value=!1,se.value=!1,console.log("✅ [Navigation] Cleanup completed successfully"),p()}catch(S){console.error("❌ [Navigation] Error during cleanup:",S),p()}}),(i,l)=>{var p,S;return y(),D("div",Ft,[o("div",Mt,[o("div",null,[o("h1",jt,u(d(e)("admin_shipping_title")),1),o("p",qt,u(d(e)("admin_shipping_description")),1)]),o("div",Kt,[t(f,{color:"success",variant:"outlined",disabled:r.value.length===0,onClick:Ue},{default:a(()=>[t(h,{start:"",icon:"tabler-refresh"}),_(" "+u(d(e)("admin_shipping_button_refresh_bulk",{count:r.value.length})),1)]),_:1},8,["disabled"]),T("",!0),t(f,{color:"primary",variant:"elevated",onClick:De},{default:a(()=>[t(h,{start:"",icon:"tabler-refresh"}),_(" "+u(d(e)("admin_shipping_button_refresh")),1)]),_:1})])]),t(z,{class:"mb-6"},{default:a(()=>[t(M,null,{default:a(()=>[t(_e,null,{default:a(()=>[t(L,{cols:"12",md:"3"},{default:a(()=>[t(te,{modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=n=>I.value=n),label:d(e)("search"),placeholder:d(e)("admin_shipping_search_placeholder"),"prepend-inner-icon":"tabler-search",clearable:"",onInput:Z},null,8,["modelValue","label","placeholder"])]),_:1}),t(L,{cols:"12",md:"2"},{default:a(()=>[t(ye,{modelValue:R.value,"onUpdate:modelValue":[l[1]||(l[1]=n=>R.value=n),Z],label:d(e)("status"),items:$e,clearable:""},null,8,["modelValue","label"])]),_:1}),t(L,{cols:"12",md:"2"},{default:a(()=>[t(te,{modelValue:A.value,"onUpdate:modelValue":l[2]||(l[2]=n=>A.value=n),label:d(e)("date_from"),type:"date",onChange:Z},null,8,["modelValue","label"])]),_:1}),t(L,{cols:"12",md:"2"},{default:a(()=>[t(te,{modelValue:E.value,"onUpdate:modelValue":l[3]||(l[3]=n=>E.value=n),label:d(e)("date_to"),type:"date",onChange:Z},null,8,["modelValue","label"])]),_:1}),t(L,{cols:"12",md:"2"},{default:a(()=>[t(ye,{modelValue:s.value,"onUpdate:modelValue":[l[4]||(l[4]=n=>s.value=n),Z],label:d(e)("per_page"),items:[10,15,25,50]},null,8,["modelValue","label"])]),_:1}),t(L,{cols:"12",md:"1"},{default:a(()=>[t(f,{color:"secondary",variant:"outlined",block:"",onClick:De},{default:a(()=>[t(h,{icon:"tabler-filter-off"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(yt,{"items-per-page":s.value,"onUpdate:itemsPerPage":l[5]||(l[5]=n=>s.value=n),modelValue:r.value,"onUpdate:modelValue":l[6]||(l[6]=n=>r.value=n),headers:Re,items:me.value,"items-length":ke.value.total,loading:Le.value,page:ke.value.current_page,"show-select":"","item-value":"id","onUpdate:page":ze,"onUpdate:sortBy":Pe},{"item.tracking_number":a(({item:n})=>[o("div",Gt,[t(P,{size:"small",color:"primary",variant:"tonal",class:"font-mono"},{default:a(()=>[_(u(n.shipping_parcel.tracking_number),1)]),_:2},1024),t(f,{size:"x-small",icon:"tabler-eye",variant:"text",onClick:C=>xe(n)},null,8,["onClick"])])]),"item.client":a(({item:n})=>[o("div",null,[o("div",Wt,u(at(n)),1),o("div",Yt,u(lt(n)),1),Te(n)?(y(),D("div",Ht,u(Te(n)),1)):T("",!0)])]),"item.city":a(({item:n})=>[t(P,{size:"small",color:"info",variant:"tonal"},{default:a(()=>[_(u(n.shipping_parcel.city_name||n.adresse.ville),1)]),_:2},1024)]),"item.sku_list":a(({item:n})=>[o("div",Qt,[(y(!0),D(Ne,null,dt(n.articles||[],C=>(y(),ce(P,{key:C.id,size:"x-small",color:"secondary",variant:"outlined",class:"font-mono"},{default:a(()=>[_(u(C.produit.sku||"N/A"),1)]),_:2},1024))),128))])]),"item.type_command":a(({item:n})=>[t(P,{size:"small",color:Ze(n.type_command),variant:"tonal"},{default:a(()=>[_(u(et(n.type_command)),1)]),_:2},1032,["color"])]),"item.status":a(({item:n})=>[t(P,{size:"small",color:Qe(n.shipping_parcel.status),variant:"tonal"},{default:a(()=>[_(u(we(n.shipping_parcel.status)),1)]),_:2},1032,["color"])]),"item.total_ttc":a(({item:n})=>[o("div",Jt,u(Xe(n.total_ttc)),1)]),"item.updated_at":a(({item:n})=>[o("div",Xt,u(tt(n.updated_at)),1)]),"item.actions":a(({item:n})=>{var C,oe;return[o("div",Zt,[t(ae,{location:"top"},{activator:a(({props:w})=>[t(f,ee(w,{size:"small",color:"primary",variant:"text",icon:"tabler-eye",onClick:F=>Ae(n)}),null,16,["onClick"])]),default:a(()=>[o("span",null,u(d(e)("actions.viewDetails")),1)]),_:2},1024),(C=n.shipping_parcel)!=null&&C.tracking_number?(y(),D(Ne,{key:0},[t(ae,{location:"top"},{activator:a(({props:w})=>[t(f,ee(w,{size:"small",color:"info",variant:"text",icon:"tabler-route",loading:G.value,onClick:F=>xe(n)}),null,16,["loading","onClick"])]),default:a(()=>[o("span",null,u(d(e)("actions.viewTracking")),1)]),_:2},1024),t(ae,{location:"top"},{activator:a(({props:w})=>{var F;return[t(f,ee(w,{size:"small",color:"success",variant:"text",icon:"tabler-refresh",loading:m.value.includes((F=n.shipping_parcel)==null?void 0:F.tracking_number),onClick:ra=>Ee(n)}),null,16,["loading","onClick"])]}),default:a(()=>[o("span",null,u(d(e)("admin_shipping_tooltip_refresh_tracking")),1)]),_:2},1024)],64)):T("",!0),T("",!0),t(ae,{location:"top"},{activator:a(({props:w})=>[t(f,ee(w,{size:"small",color:n.delivery_boy_name?"success":"info",variant:"text",icon:"tabler-user",onClick:F=>We(n)}),null,16,["color","onClick"])]),default:a(()=>[o("span",null,u(n.delivery_boy_name?d(e)("edit_delivery_person"):d(e)("add_delivery_person")),1)]),_:2},1024),(oe=n.shipping_parcel)!=null&&oe.sent_to_carrier?T("",!0):(y(),ce(ae,{key:2,location:"top"},{activator:a(({props:w})=>[t(f,ee(w,{size:"small",color:"warning",variant:"text",icon:"tabler-edit",onClick:F=>Me(n)}),null,16,["onClick"])]),default:a(()=>[o("span",null,u(d(e)("admin_shipping_tooltip_modify_status")),1)]),_:2},1024)),T("",!0)])]}),"no-data":a(()=>[o("div",ea,[t(h,{icon:"tabler-truck-off",size:"64",class:"mb-4",color:"disabled"}),o("h3",ta,u(d(e)("no_shipped_orders")),1),o("p",aa,u(d(e)("no_orders_sent_ozonexpress")),1)])]),_:1},8,["items-per-page","modelValue","items","items-length","loading","page"])]),_:1}),t(Ot,{modelValue:se.value,"onUpdate:modelValue":l[7]||(l[7]=n=>se.value=n),"tracking-number":W.value,"tracking-data":ve.value,loading:G.value,error:O.value,"delivery-boy-name":(p=fe.value)==null?void 0:p.delivery_boy_name,"delivery-boy-phone":(S=fe.value)==null?void 0:S.delivery_boy_phone,onRefresh:Ce,onRetry:Ce},null,8,["modelValue","tracking-number","tracking-data","loading","error","delivery-boy-name","delivery-boy-phone"]),t(gt,{modelValue:be.value,"onUpdate:modelValue":l[8]||(l[8]=n=>be.value=n),loading:ge.value,title:d(e)("admin_shipping_resend_ozon_title"),text:d(e)("admin_shipping_resend_ozon_text"),"default-mode":"ramassage",onConfirm:Oe,onCancel:Fe},null,8,["modelValue","loading","title","text"]),T("",!0),t(pe,{modelValue:g.value,"onUpdate:modelValue":l[12]||(l[12]=n=>g.value=n),"max-width":"500",persistent:""},{default:a(()=>[t(z,null,{default:a(()=>[t(de,{class:"text-h6"},{default:a(()=>[t(h,{start:"",icon:"tabler-edit",color:"warning"}),_(" "+u(d(e)("admin_shipping_modify_status_title")),1)]),_:1}),t(M,null,{default:a(()=>[o("p",la,[_(u(d(e)("admin_shipping_modify_status_description"))+" ",1),o("strong",null,u(d(e)("admin_shipping_modify_status_note"))+":",1),_(" "+u(d(e)("admin_shipping_modify_status_note_commission")),1)]),t(ye,{modelValue:V.value,"onUpdate:modelValue":l[10]||(l[10]=n=>V.value=n),label:d(e)("admin_shipping_new_status"),items:[{title:d(e)("admin_shipping_status_pending"),value:"pending"},{title:d(e)("admin_shipping_status_shipped"),value:"expediee"},{title:d(e)("admin_shipping_status_delivered_fem"),value:"livree"},{title:d(e)("admin_shipping_status_refused_fem"),value:"refusee"},{title:d(e)("order.status.returned_feminine"),value:"retournee"},{title:d(e)("admin_shipping_status_cancelled_fem"),value:"annulee"}],variant:"outlined",class:"mb-4"},null,8,["modelValue","label","items"]),t(Ie,{modelValue:H.value,"onUpdate:modelValue":l[11]||(l[11]=n=>H.value=n),label:d(e)("admin_shipping_note_optional"),placeholder:d(e)("admin_shipping_note_placeholder"),rows:"3",variant:"outlined"},null,8,["modelValue","label","placeholder"])]),_:1}),t(ue,null,{default:a(()=>[t(le),t(f,{variant:"text",onClick:qe,disabled:b.value},{default:a(()=>[_(u(d(e)("admin_shipping_cancel")),1)]),_:1},8,["disabled"]),t(f,{color:"warning",variant:"elevated",loading:b.value,disabled:!V.value,onClick:je},{default:a(()=>[t(h,{start:"",icon:"tabler-check"}),_(" "+u(d(e)("admin_shipping_update")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(pe,{modelValue:Q.value,"onUpdate:modelValue":l[14]||(l[14]=n=>Q.value=n),"max-width":"500",persistent:""},{default:a(()=>[t(z,null,{default:a(()=>[t(de,{class:"d-flex align-center"},{default:a(()=>[t(h,{icon:"tabler-alert-triangle",color:"warning",class:"me-2"}),l[18]||(l[18]=_(" Retour en entrepôt "))]),_:1,__:[18]}),t(M,null,{default:a(()=>{var n;return[t(ht,{type:"warning",variant:"tonal",class:"mb-4"},{default:a(()=>[t(kt,null,{default:a(()=>l[19]||(l[19]=[_("Attention !")])),_:1,__:[19]}),l[20]||(l[20]=_(" Cette action va ré-incrémenter le stock des produits de cette commande. Assurez-vous que les produits sont physiquement retournés en entrepôt. "))]),_:1,__:[20]}),o("p",na,[l[21]||(l[21]=_(" Commande: ")),o("strong",null,u((n=$.value)==null?void 0:n.id),1)]),t(Ie,{modelValue:ie.value,"onUpdate:modelValue":l[13]||(l[13]=C=>ie.value=C),label:"Raison du retour (optionnel)",placeholder:"Ex: Produit défectueux, refus client, etc.",rows:"3",variant:"outlined"},null,8,["modelValue"])]}),_:1}),t(ue,null,{default:a(()=>{var n,C;return[t(le),t(f,{variant:"text",onClick:Ge,disabled:ne.value===((n=$.value)==null?void 0:n.id)},{default:a(()=>l[22]||(l[22]=[_(" Annuler ")])),_:1,__:[22]},8,["disabled"]),t(f,{color:"warning",variant:"elevated",loading:ne.value===((C=$.value)==null?void 0:C.id),onClick:Ke},{default:a(()=>[t(h,{start:"",icon:"tabler-package-import"}),l[23]||(l[23]=_(" Confirmer le retour "))]),_:1,__:[23]},8,["loading"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]),t(pe,{modelValue:q.value,"onUpdate:modelValue":l[17]||(l[17]=n=>q.value=n),"max-width":"500",persistent:""},{default:a(()=>[t(z,null,{default:a(()=>[t(de,{class:"d-flex align-center"},{default:a(()=>[t(h,{icon:"tabler-user",color:"info",class:"me-2"}),_(" "+u(d(e)("delivery_person_information")),1)]),_:1}),t(M,null,{default:a(()=>[t(_e,null,{default:a(()=>[t(L,{cols:"12"},{default:a(()=>[t(te,{modelValue:J.value,"onUpdate:modelValue":l[15]||(l[15]=n=>J.value=n),label:d(e)("delivery_person_name"),placeholder:d(e)("delivery_person_name_placeholder"),variant:"outlined","prepend-inner-icon":"tabler-user",disabled:K.value},null,8,["modelValue","label","placeholder","disabled"])]),_:1}),t(L,{cols:"12"},{default:a(()=>[t(te,{modelValue:X.value,"onUpdate:modelValue":l[16]||(l[16]=n=>X.value=n),label:d(e)("delivery_person_phone"),placeholder:d(e)("delivery_person_phone_placeholder"),variant:"outlined","prepend-inner-icon":"tabler-phone",disabled:K.value},null,8,["modelValue","label","placeholder","disabled"])]),_:1})]),_:1})]),_:1}),t(ue,null,{default:a(()=>[t(le),t(f,{variant:"text",onClick:He,disabled:K.value},{default:a(()=>[_(u(d(e)("cancel")),1)]),_:1},8,["disabled"]),t(f,{color:"primary",variant:"elevated",loading:K.value,onClick:Ye},{default:a(()=>[t(h,{start:"",icon:"tabler-device-floppy"}),_(" "+u(d(e)("save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Ha as default};
