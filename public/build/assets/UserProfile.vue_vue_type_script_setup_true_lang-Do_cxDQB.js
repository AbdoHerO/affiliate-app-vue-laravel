import{u as $}from"./useAuth-bfVKriN1.js";import{g as j}from"./imageUtils-DWeF8CQY.js";import{V as z}from"./VBadge-BMwsUA26.js";import{V as h}from"./VImg-DjZhnPY1.js";import{V as D}from"./VMenu-cCaIVuKn.js";import{V as E,a as _,b as g,d as S}from"./VList-DWKF8cD-.js";import{aj as M,Z,a2 as q,e as a,a_ as G,a4 as H,d as J,aL as K,V as w,h as n,m as B,n as t,b as i,g as e,t as u,v as f,az as k}from"./main-3LuWNv9W.js";import{V as N}from"./VAvatar-CH3JpKwD.js";import{V as P}from"./VDivider-D28qXVrs.js";const O=Z({start:Boolean,end:Boolean,...H(),...G()},"VListItemAction"),Q=M()({name:"VListItemAction",props:O(),setup(c,o){let{slots:v}=o;return q(()=>a(c.tag,{class:["v-list-item-action",{"v-list-item-action--start":c.start,"v-list-item-action--end":c.end},c.class],style:c.style},v)),{}}}),no=J({__name:"UserProfile",setup(c){const{user:o,isAuthenticated:v,logout:F}=$(),{t:m}=K(),V=w(()=>{if(console.log("ðŸ–¼ï¸ Computing userAvatarUrl for user:",o),console.log("ðŸ–¼ï¸ User photo_profil:",o==null?void 0:o.photo_profil),!(o!=null&&o.photo_profil)){const l=(o==null?void 0:o.nom_complet)||"User",d=`https://ui-avatars.com/api/?name=${encodeURIComponent(l)}&background=7367f0&color=fff&size=40`;return console.log("ðŸ–¼ï¸ Using UI-Avatars fallback:",d),d}const p=j(o.photo_profil);return console.log("ðŸ–¼ï¸ Using profile image:",p),p}),R=async()=>{await F()},T=w(()=>{var p,l;return((l=(p=o.value)==null?void 0:p.roles)==null?void 0:l.includes("admin"))||!1});return(p,l)=>t(v)&&t(o)?(i(),n(z,{key:0,dot:"",location:"bottom right","offset-x":"3","offset-y":"3",bordered:"",color:"success"},{default:e(()=>{var d,y;return[a(N,{class:"cursor-pointer",color:(d=t(o))!=null&&d.photo_profil?void 0:"primary",variant:(y=t(o))!=null&&y.photo_profil?void 0:"tonal"},{default:e(()=>{var b,U,A;return[(b=t(o))!=null&&b.photo_profil?(i(),n(h,{key:0,src:V.value,alt:((U=t(o))==null?void 0:U.nom_complet)||"User",onError:l[0]||(l[0]=s=>{var r;return console.error("Failed to load navbar avatar:",(r=t(o))==null?void 0:r.photo_profil)})},null,8,["src","alt"])):(i(),n(h,{key:1,src:V.value,alt:((A=t(o))==null?void 0:A.nom_complet)||"User"},null,8,["src","alt"])),a(D,{activator:"parent",width:"230",location:"bottom end",offset:"14px"},{default:e(()=>[a(E,null,{default:e(()=>[a(_,null,{prepend:e(()=>[a(Q,{start:""},{default:e(()=>[a(z,{dot:"",location:"bottom right","offset-x":"3","offset-y":"3",color:"success"},{default:e(()=>{var s,r;return[a(N,{color:(s=t(o))!=null&&s.photo_profil?void 0:"primary",variant:(r=t(o))!=null&&r.photo_profil?void 0:"tonal"},{default:e(()=>{var I,L,C;return[(I=t(o))!=null&&I.photo_profil?(i(),n(h,{key:0,src:V.value,alt:((L=t(o))==null?void 0:L.nom_complet)||"User",onError:l[1]||(l[1]=W=>{var x;return console.error("Failed to load dropdown avatar:",(x=t(o))==null?void 0:x.photo_profil)})},null,8,["src","alt"])):(i(),n(h,{key:1,src:V.value,alt:((C=t(o))==null?void 0:C.nom_complet)||"User"},null,8,["src","alt"]))]}),_:1},8,["color","variant"])]}),_:1})]),_:1})]),default:e(()=>[a(g,{class:"font-weight-semibold"},{default:e(()=>{var s;return[u(f(((s=t(o))==null?void 0:s.nom_complet)||t(m)("common.guest")),1)]}),_:1}),a(S,null,{default:e(()=>{var s,r;return[u(f(((r=(s=t(o))==null?void 0:s.roles)==null?void 0:r.join(", "))||t(m)("common.noRole")),1)]}),_:1})]),_:1}),a(P,{class:"my-2"}),a(_,{link:"",to:"/profile"},{prepend:e(()=>[a(k,{class:"me-2",icon:"tabler-user",size:"22"})]),default:e(()=>[a(g,null,{default:e(()=>[u(f(t(m)("profile")),1)]),_:1})]),_:1}),T.value?(i(),n(_,{key:0,link:"",to:{name:"admin-settings"}},{prepend:e(()=>[a(k,{class:"me-2",icon:"tabler-settings",size:"22"})]),default:e(()=>[a(g,null,{default:e(()=>[u(f(t(m)("settings")),1)]),_:1})]),_:1})):B("",!0),a(P,{class:"my-2"}),t(v)?(i(),n(_,{key:1,onClick:R},{prepend:e(()=>[a(k,{class:"me-2",icon:"tabler-logout",size:"22"})]),default:e(()=>[a(g,null,{default:e(()=>[u(f(t(m)("logout")),1)]),_:1})]),_:1})):(i(),n(_,{key:2,to:"/login"},{prepend:e(()=>[a(k,{class:"me-2",icon:"tabler-login",size:"22"})]),default:e(()=>[a(g,null,{default:e(()=>[u(f(t(m)("login")),1)]),_:1})]),_:1}))]),_:1})]),_:1})]}),_:1},8,["color","variant"])]}),_:1})):B("",!0)}});export{no as _};
