import{$ as U}from"./api-DSi3Suj8.js";import{S as Ce,P as De}from"./MixedChart.vue_vue_type_style_index_0_scoped_14692a4d_lang-DJnNojsB.js";import{d as Re,aL as Te,r as b,V as q,w as J,D as Ee,bb as ze,c as _,o as f,e as i,b as e,g as A,l as H,t as r,m as s,f as t,s as u,ac as R,az as m,p as Ae,bc as Se,F as Q,i as W,v as re,aV as X,ai as Le}from"./main-uLG9IIeX.js";import{s as oe,g as je,f as Me,a as ie,b as ne,e as Ie,c as Oe,i as Ue,d as $e,h as Fe,j as Be}from"./chartExporter-kyLT3Kom.js";import{V as de,a as $,b as F,d as ce}from"./VList-uZDByhc2.js";import{V as ue}from"./VDivider-UqGR4x4D.js";import{V as Pe}from"./VMenu-DP1p-55V.js";import{b as B,V as S}from"./VCard-CB1gT6RB.js";import{V as P}from"./VAvatar-bHPDEsYY.js";import{V as L}from"./VCardText-BZtszuIK.js";import{V as N}from"./VTextField-Dxeq5kx5.js";import{V as Ne}from"./VSelect-sWnAtot-.js";import{V as Ge}from"./VAlert-TgguXW_5.js";import{a as M,V as G}from"./VRow-aGfXYx3U.js";import{V as Ke}from"./VDataTable-DNqSzzrc.js";import{V as Y}from"./VChip-B84WcmDa.js";import{V as qe}from"./VPagination-DYW6O4lq.js";import{_ as Je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D-EbNoF1.js";import"./_commonjsHelpers-CqkleIqs.js";import"./ssrBoot-BPhRU-mF.js";import"./VImg-BS6_svHJ.js";import"./createSimpleFunctional-DugzUcbB.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./dialog-transition-2hF0ajsQ.js";import"./VField-CfH1YcVv.js";import"./VCheckboxBtn-CogF2AUK.js";/* empty css              */import"./VTable-0U-NvIH3.js";import"./filter-D_SbaZWa.js";const He={class:"d-flex align-center justify-space-between mb-6"},Qe={class:"text-h4 font-weight-bold mb-1"},We={class:"text-body-1 mb-0"},Xe={class:"d-flex gap-3"},Ye={class:"d-flex align-center"},Ze={class:"text-h6 font-weight-semibold mb-0"},ea={class:"text-body-2 text-medium-emphasis mb-0"},aa={class:"d-flex gap-2"},ta={class:"filters-layout"},la={class:"primary-filters"},sa={class:"filter-group"},ra={class:"filter-header"},oa={class:"filter-title"},ia={class:"date-range-container"},na={class:"date-separator"},da={class:"filter-group"},ca={class:"filter-header"},ua={class:"filter-title"},ma={class:"secondary-filters"},fa={class:"filter-group"},pa={class:"filter-header"},_a={class:"filter-title"},va={class:"filter-group"},ha={class:"filter-header"},ya={class:"filter-title"},ga={class:"filter-group"},ba={class:"filter-header"},xa={class:"filter-title"},Va={class:"d-flex align-center justify-space-between"},ka={class:"text-sm text-medium-emphasis mb-1"},wa={key:0,class:"d-flex align-center mt-1"},Ca={class:"text-sm text-medium-emphasis ms-1"},Da={key:1,class:"text-xs text-error mt-1"},Ra={class:"d-flex align-center justify-space-between"},Ta={class:"text-sm text-medium-emphasis mb-1"},Ea={class:"text-h4 font-weight-bold"},za={class:"text-xs text-medium-emphasis mt-1"},Aa={key:0,class:"text-center py-8"},Sa={class:"mt-2"},La={key:2,class:"text-center py-8 text-medium-emphasis"},ja={key:0,class:"text-center py-8"},Ma={key:2,class:"text-center py-8 text-medium-emphasis"},Ia={class:"d-flex align-center"},Oa={class:"text-xs font-weight-bold"},Ua={class:"text-end"},$a={class:"text-sm font-weight-bold"},Fa={key:1,class:"text-center py-8"},Ba={key:2,class:"text-center py-8 text-medium-emphasis"},Pa={key:3,class:"d-flex justify-center mt-4"},Na=Re({__name:"reports-affiliates",setup(Ga){const{t:l}=Te();let T=null,E=null;const I=b(!1),p=b({summary:!1,charts:!1,leaderboard:!1,ledger:!1,segments:!1}),C=b(null),z=b({summary:!1,charts:!1,leaderboard:!1,ledger:!1,segments:!1}),h=b(null),g=b({}),j=b([]),x=b({}),v=b({}),n=b({dateRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},period:"day",affiliate_status:"",country:"",city:"",min_orders:0,min_commission:0,sort_by:"commission",page:1,per_page:15}),Z=q(()=>Object.values(p.value).some(Boolean)),me=q(()=>h.value?[{key:"active_affiliates",title:l("active_affiliates"),icon:"tabler-users",color:"primary"},{key:"new_affiliates",title:l("new_affiliates"),icon:"tabler-user-plus",color:"success"},{key:"total_commissions",title:l("total_commissions"),icon:"tabler-coins",color:"warning",currency:"MAD"},{key:"total_payouts",title:l("total_payouts"),icon:"tabler-credit-card",color:"info",currency:"MAD"},{key:"conversion_rate",title:l("conversion_rate"),icon:"tabler-trending-up",color:"secondary",unit:"%"}].map(d=>{const a=oe(h.value[d.key]),c=je(a.delta);return{title:d.title,value:a.value,displayValue:Me(a.value,{currency:d.currency,unit:d.unit,decimals:d.currency?0:d.unit==="%"?1:0}),icon:d.icon,color:d.color,trend:a.delta!==null?{value:a.delta,icon:c.icon,color:c.color,text:c.text,label:l("vs_previous_period")}:null,isValid:a.isValid}}):[]),fe=q(()=>{var o,d,a,c,y,D,le,se;return v.value?[{title:l("top_earners"),count:((o=v.value.top_earners)==null?void 0:o.count)||0,description:((d=v.value.top_earners)==null?void 0:d.description)||"",color:"warning",icon:"tabler-trophy"},{title:l("rising_stars"),count:((a=v.value.rising)==null?void 0:a.count)||0,description:((c=v.value.rising)==null?void 0:c.description)||"",color:"success",icon:"tabler-trending-up"},{title:l("at_risk"),count:((y=v.value.at_risk)==null?void 0:y.count)||0,description:((D=v.value.at_risk)==null?void 0:D.description)||"",color:"error",icon:"tabler-alert-triangle"},{title:l("dormant"),count:((le=v.value.dormant)==null?void 0:le.count)||0,description:((se=v.value.dormant)==null?void 0:se.description)||"",color:"secondary",icon:"tabler-sleep"}]:[]}),ee=()=>{T&&(T.abort(),T=null),E&&(E.abort(),E=null)},pe=async()=>{p.value.summary=!0,C.value=null,z.value.summary=!1;try{T&&T.abort(),T=new AbortController;const o=await U("/admin/reports/affiliates/summary",{method:"GET",signal:T.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end}});if(o.success){const d=o.data&&Object.keys(o.data).length>0;if(z.value.summary=!d,d){h.value={};for(const[a,c]of Object.entries(o.data))h.value[a]=oe(c)}else h.value=null}else throw new Error(o.message||"Failed to fetch summary")}catch(o){o.name!=="AbortError"&&(C.value=o instanceof Error?o.message:"An error occurred",console.error("Error fetching affiliate summary:",o))}finally{p.value.summary=!1}},ae=async()=>{p.value.charts=!0,z.value.charts=!1;try{E&&E.abort(),E=new AbortController;const o=await U("/admin/reports/affiliates/series",{method:"GET",signal:E.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,period:n.value.period}});if(o.success){g.value={};let d=!1;for(const[a,c]of Object.entries(o.data)){const y=Be(c);g.value[a]=y,y.isEmpty||(d=!0)}z.value.charts=!d}else z.value.charts=!0}catch(o){o.name!=="AbortError"&&(console.error("Error fetching chart data:",o),z.value.charts=!0)}finally{p.value.charts=!1}},K=async()=>{p.value.leaderboard=!0;try{const o=await U("/admin/reports/affiliates/leaderboard",{method:"GET",params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,sort_by:n.value.sort_by,limit:20,...n.value}});o.success&&(j.value=ne(o.data||[]))}catch(o){console.error("Error fetching leaderboard:",o)}finally{p.value.leaderboard=!1}},te=async()=>{p.value.ledger=!0;try{const o=await U("/admin/reports/affiliates/ledger",{method:"GET",params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,page:n.value.page,per_page:n.value.per_page,...n.value}});o.success&&(x.value={...o.data,data:ne(o.data.data||[])})}catch(o){console.error("Error fetching ledger:",o)}finally{p.value.ledger=!1}},_e=async()=>{p.value.segments=!0;try{const o=await U("/admin/reports/affiliates/segments",{method:"GET",params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,...n.value}});o.success&&(v.value=o.data)}catch(o){console.error("Error fetching segments:",o)}finally{p.value.segments=!1}},O=async()=>{await Promise.all([pe(),ae(),K(),te(),_e()])},ve=async()=>{ee(),V&&(clearTimeout(V),V=null),k&&(clearTimeout(k),k=null),w&&(clearTimeout(w),w=null),I.value=!0,n.value={dateRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},period:"day",affiliate_status:"",country:"",city:"",min_orders:0,min_commission:0,sort_by:"commission",page:1,per_page:15},await Le(),I.value=!1,O()},he=()=>{try{const o={timestamp:new Date().toISOString(),filters:n.value,summary:h.value,charts:g.value,leaderboard:j.value,ledger:x.value,segments:v.value},d=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),a=URL.createObjectURL(d),c=document.createElement("a");c.href=a,c.download=`affiliate-performance-${n.value.dateRange.start}-to-${n.value.dateRange.end}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(a)}catch(o){console.error("Error exporting data:",o)}},ye=()=>{j.value&&Ie(j.value,`affiliate-leaderboard-${n.value.dateRange.start}-to-${n.value.dateRange.end}`)},ge=()=>{var o;(o=x.value)!=null&&o.data&&Oe(x.value.data,`commission-ledger-${n.value.dateRange.start}-to-${n.value.dateRange.end}`)},be=async()=>{const o=Ue();if(!o.available){C.value=o.reason||"Export not available";return}try{await $e({filename:`affiliate-performance-${n.value.dateRange.start}-to-${n.value.dateRange.end}`,title:l("affiliate_performance"),includeKPIs:!0,includeCharts:!0})}catch(d){const a=d instanceof Error?d:new Error("Export failed");C.value=Fe(a),console.error("Error exporting dashboard:",a)}},xe=o=>({pending:"warning",approved:"info",paid:"success",rejected:"error"})[o]||"default";let V=null;const Ve=()=>{I.value||(V&&clearTimeout(V),V=setTimeout(()=>{O()},300))};let k=null;const ke=()=>{I.value||(k&&clearTimeout(k),k=setTimeout(()=>{ae()},300))};let w=null;const we=()=>{I.value||(w&&clearTimeout(w),w=setTimeout(()=>{K()},300))};return J(()=>n.value.dateRange,Ve,{deep:!0}),J(()=>n.value.period,ke),J(()=>n.value.sort_by,we),Ee(()=>{O()}),ze(()=>{ee(),V&&(clearTimeout(V),V=null),k&&(clearTimeout(k),k=null),w&&(clearTimeout(w),w=null),h.value=null,g.value={},j.value=[],x.value={},v.value={},p.value={summary:!1,charts:!1,leaderboard:!1,ledger:!1,segments:!1},C.value=null,z.value={summary:!1,charts:!1,leaderboard:!1,ledger:!1,segments:!1}}),(o,d)=>(f(),_("div",null,[i("div",He,[i("div",null,[i("h1",Qe,r(s(l)("affiliate_performance")),1),i("p",We,r(s(l)("view_affiliate_performance_analytics")),1)]),i("div",Xe,[e(R,{variant:"outlined","prepend-icon":"tabler-refresh",loading:Z.value,onClick:O},{default:t(()=>[u(r(s(l)("refresh")),1)]),_:1},8,["loading"]),e(Pe,null,{activator:t(({props:a})=>[e(R,Ae({color:"primary","prepend-icon":"tabler-download"},a),{default:t(()=>[u(r(s(l)("export"))+" ",1),e(m,{icon:"tabler-chevron-down",class:"ms-1"})]),_:2},1040)]),default:t(()=>[e(de,null,{default:t(()=>[e($,{onClick:he},{prepend:t(()=>[e(m,{icon:"tabler-file-type-json"})]),default:t(()=>[e(F,null,{default:t(()=>[u(r(s(l)("export_json")),1)]),_:1})]),_:1}),e($,{onClick:be},{prepend:t(()=>[e(m,{icon:"tabler-photo"})]),default:t(()=>[e(F,null,{default:t(()=>[u(r(s(l)("export_dashboard_image")),1)]),_:1})]),_:1}),e(ue),e($,{onClick:ye},{prepend:t(()=>[e(m,{icon:"tabler-file-spreadsheet"})]),default:t(()=>[e(F,null,{default:t(()=>[u(r(s(l)("export_leaderboard_csv")),1)]),_:1})]),_:1}),e($,{onClick:ge},{prepend:t(()=>[e(m,{icon:"tabler-file-spreadsheet"})]),default:t(()=>[e(F,null,{default:t(()=>[u(r(s(l)("export_ledger_csv")),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),e(S,{class:"mb-6 filters-card",elevation:"2"},{default:t(()=>[e(B,{class:"d-flex align-center justify-space-between pa-6 pb-4"},{default:t(()=>[i("div",Ye,[e(P,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(m,{icon:"tabler-filter",size:"18"})]),_:1}),i("div",null,[i("h3",Ze,r(s(l)("filters")),1),i("p",ea,r(s(l)("filter_your_affiliate_data")),1)])]),i("div",aa,[e(R,{variant:"outlined",color:"primary","prepend-icon":"tabler-refresh",loading:Z.value,onClick:O,class:"filter-action-btn"},{default:t(()=>[u(r(s(l)("apply")),1)]),_:1},8,["loading"]),e(R,{variant:"text",color:"secondary","prepend-icon":"tabler-x",onClick:ve,class:"filter-action-btn"},{default:t(()=>[u(r(s(l)("reset")),1)]),_:1})])]),_:1}),e(ue),e(L,{class:"pa-6"},{default:t(()=>[i("div",ta,[i("div",la,[i("div",sa,[i("div",ra,[e(m,{icon:"tabler-calendar",size:"16",class:"me-2 text-primary"}),i("span",oa,r(s(l)("date_range")),1)]),i("div",ia,[e(N,{modelValue:n.value.dateRange.start,"onUpdate:modelValue":d[0]||(d[0]=a=>n.value.dateRange.start=a),type:"date",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-event",class:"date-input",placeholder:s(l)("start_date")},null,8,["modelValue","placeholder"]),i("div",na,[e(m,{icon:"tabler-arrow-right",size:"16",class:"text-medium-emphasis"})]),e(N,{modelValue:n.value.dateRange.end,"onUpdate:modelValue":d[1]||(d[1]=a=>n.value.dateRange.end=a),type:"date",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-event",class:"date-input",placeholder:s(l)("end_date")},null,8,["modelValue","placeholder"])])]),i("div",da,[i("div",ca,[e(m,{icon:"tabler-clock",size:"16",class:"me-2 text-primary"}),i("span",ua,r(s(l)("period")),1)]),e(Se,{modelValue:n.value.period,"onUpdate:modelValue":d[2]||(d[2]=a=>n.value.period=a),variant:"outlined",color:"primary",divided:"",mandatory:"",class:"period-toggle"},{default:t(()=>[e(R,{value:"day",class:"period-btn"},{default:t(()=>[e(m,{icon:"tabler-calendar-day",size:"16",class:"me-1"}),u(" "+r(s(l)("day")),1)]),_:1}),e(R,{value:"week",class:"period-btn"},{default:t(()=>[e(m,{icon:"tabler-calendar-week",size:"16",class:"me-1"}),u(" "+r(s(l)("week")),1)]),_:1}),e(R,{value:"month",class:"period-btn"},{default:t(()=>[e(m,{icon:"tabler-calendar-month",size:"16",class:"me-1"}),u(" "+r(s(l)("month")),1)]),_:1})]),_:1},8,["modelValue"])])]),i("div",ma,[i("div",fa,[i("div",pa,[e(m,{icon:"tabler-sort-descending",size:"16",class:"me-2 text-primary"}),i("span",_a,r(s(l)("sort_by")),1)]),e(Ne,{modelValue:n.value.sort_by,"onUpdate:modelValue":d[3]||(d[3]=a=>n.value.sort_by=a),items:[{title:s(l)("commission"),value:"commission"},{title:s(l)("sales"),value:"sales"},{title:s(l)("orders"),value:"orders"},{title:s(l)("payouts"),value:"payouts"}],"item-title":"title","item-value":"value",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-list",class:"modern-select"},null,8,["modelValue","items"])]),i("div",va,[i("div",ha,[e(m,{icon:"tabler-shopping-cart",size:"16",class:"me-2 text-primary"}),i("span",ya,r(s(l)("min_orders")),1)]),e(N,{modelValue:n.value.min_orders,"onUpdate:modelValue":d[4]||(d[4]=a=>n.value.min_orders=a),modelModifiers:{number:!0},type:"number",min:"0",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-hash",class:"modern-input",placeholder:s(l)("enter_minimum_orders")},null,8,["modelValue","placeholder"])]),i("div",ga,[i("div",ba,[e(m,{icon:"tabler-coins",size:"16",class:"me-2 text-primary"}),i("span",xa,r(s(l)("min_commission")),1)]),e(N,{modelValue:n.value.min_commission,"onUpdate:modelValue":d[5]||(d[5]=a=>n.value.min_commission=a),modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-currency-dollar",class:"modern-input",placeholder:s(l)("enter_minimum_commission"),suffix:"MAD"},null,8,["modelValue","placeholder"])])])])]),_:1})]),_:1}),C.value?(f(),A(Ge,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":d[6]||(d[6]=a=>C.value=null)},{default:t(()=>[u(r(C.value),1)]),_:1})):H("",!0),e(G,{class:"mb-6"},{default:t(()=>[(f(!0),_(Q,null,W(me.value,(a,c)=>(f(),A(M,{key:c,cols:"12",sm:"6",lg:"4",xl:"2"},{default:t(()=>[e(S,null,{default:t(()=>[e(L,null,{default:t(()=>[i("div",Va,[i("div",null,[i("p",ka,r(a.title),1),i("h3",{class:re(["text-h5 font-weight-bold",{"text-error":!a.isValid}])},r(a.displayValue),3),a.trend?(f(),_("div",wa,[e(m,{icon:a.trend.icon,color:a.trend.color,size:"16",class:"me-1"},null,8,["icon","color"]),i("span",{class:re(["text-sm",`text-${a.trend.color}`])},r(a.trend.text),3),i("span",Ca,r(a.trend.label),1)])):a.isValid?H("",!0):(f(),_("div",Da,r(s(l)("invalid_data")),1))]),e(P,{color:a.color,variant:"tonal",size:"40"},{default:t(()=>[e(m,{icon:a.icon},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(G,{class:"mb-6"},{default:t(()=>[(f(!0),_(Q,null,W(fe.value,(a,c)=>(f(),A(M,{key:c,cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(S,null,{default:t(()=>[e(L,null,{default:t(()=>[i("div",Ra,[i("div",null,[i("p",Ta,r(a.title),1),i("h3",Ea,r(a.count),1),i("p",za,r(a.description),1)]),e(P,{color:a.color,variant:"tonal",size:"48"},{default:t(()=>[e(m,{icon:a.icon,size:"24"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(G,{class:"mb-6"},{default:t(()=>[e(M,{cols:"12",lg:"6"},{default:t(()=>[e(S,null,{default:t(()=>[e(B,null,{default:t(()=>[e(m,{icon:"tabler-chart-area",class:"me-2"}),u(" "+r(s(l)("commissions_over_time")),1)]),_:1}),e(L,null,{default:t(()=>{var a,c,y,D;return[p.value.charts?(f(),_("div",Aa,[e(X,{indeterminate:"",color:"primary"}),i("p",Sa,r(s(l)("loading_charts")),1)])):g.value.commissions_over_time&&!g.value.commissions_over_time.isEmpty?(f(),A(s(Ce),{key:1,data:s(ie)(g.value.commissions_over_time.data,s(l)("commissions_mad"),s(l)("earned_commissions"),(((c=(a=h.value)==null?void 0:a.total_commissions)==null?void 0:c.value)||0)+" MAD",((D=(y=h.value)==null?void 0:y.total_commissions)==null?void 0:D.delta)||"+0%","primary"),loading:p.value.charts},null,8,["data","loading"])):(f(),_("div",La,r(s(l)("no_data_available")),1))]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",lg:"6"},{default:t(()=>[e(S,null,{default:t(()=>[e(B,null,{default:t(()=>[e(m,{icon:"tabler-chart-bar",class:"me-2"}),u(" "+r(s(l)("payouts_over_time")),1)]),_:1}),e(L,null,{default:t(()=>{var a,c,y,D;return[p.value.charts?(f(),_("div",ja,[e(X,{indeterminate:"",color:"primary"})])):g.value.payouts_over_time&&!g.value.payouts_over_time.isEmpty?(f(),A(s(De),{key:1,data:s(ie)(g.value.payouts_over_time.data,s(l)("payouts_mad"),s(l)("paid_withdrawals"),(((c=(a=h.value)==null?void 0:a.total_payouts)==null?void 0:c.value)||0)+" MAD",((D=(y=h.value)==null?void 0:y.total_payouts)==null?void 0:D.delta)||"+0%","success"),loading:p.value.charts},null,8,["data","loading"])):(f(),_("div",Ma,r(s(l)("no_data_available")),1))]}),_:1})]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(M,{cols:"12",lg:"8"},{default:t(()=>[e(S,null,{default:t(()=>[e(B,{class:"d-flex align-center justify-space-between"},{default:t(()=>[i("div",Ia,[e(m,{icon:"tabler-trophy",class:"me-2"}),u(" "+r(s(l)("affiliate_leaderboard")),1)]),e(R,{variant:"text",size:"small","prepend-icon":"tabler-refresh",loading:p.value.leaderboard,onClick:K},{default:t(()=>[u(r(s(l)("refresh")),1)]),_:1},8,["loading"])]),_:1}),e(L,null,{default:t(()=>[e(Ke,{items:j.value,headers:[{title:s(l)("rank"),key:"rank",width:"60px"},{title:s(l)("affiliate"),key:"name"},{title:s(l)("email"),key:"email"},{title:s(l)("orders"),key:"orders_count",align:"center"},{title:s(l)("delivered_rate"),key:"delivered_rate",align:"center"},{title:s(l)("sales_mad"),key:"total_sales",align:"end"},{title:s(l)("commission_mad"),key:"total_commission",align:"end"},{title:s(l)("payouts_mad"),key:"total_payouts",align:"end"},{title:s(l)("aov_mad"),key:"avg_order_value",align:"end"},{title:s(l)("return_rate"),key:"return_rate",align:"center"}],loading:p.value.leaderboard,density:"compact","hide-default-footer":""},{"item.rank":t(({index:a})=>[e(P,{color:a<3?["warning","secondary","success"][a]:"grey",size:"24",variant:"tonal"},{default:t(()=>[i("span",Oa,r(a+1),1)]),_:2},1032,["color"])]),"item.delivered_rate":t(({item:a})=>[e(Y,{color:a.delivered_rate>=80?"success":a.delivered_rate>=60?"warning":"error",size:"small",variant:"tonal"},{default:t(()=>[u(r(a.delivered_rate)+"% ",1)]),_:2},1032,["color"])]),"item.total_sales":t(({item:a})=>[u(r(a.total_sales.toFixed(0))+" MAD ",1)]),"item.total_commission":t(({item:a})=>[u(r(a.total_commission.toFixed(0))+" MAD ",1)]),"item.total_payouts":t(({item:a})=>[u(r(a.total_payouts.toFixed(0))+" MAD ",1)]),"item.avg_order_value":t(({item:a})=>[u(r(a.avg_order_value.toFixed(0))+" MAD ",1)]),"item.return_rate":t(({item:a})=>[e(Y,{color:a.return_rate<=5?"success":a.return_rate<=15?"warning":"error",size:"small",variant:"tonal"},{default:t(()=>[u(r(a.return_rate)+"% ",1)]),_:2},1032,["color"])]),_:1},8,["items","headers","loading"])]),_:1})]),_:1})]),_:1}),e(M,{cols:"12",lg:"4"},{default:t(()=>[e(S,null,{default:t(()=>[e(B,null,{default:t(()=>[e(m,{icon:"tabler-list-details",class:"me-2"}),u(" "+r(s(l)("commission_ledger")),1)]),_:1}),e(L,null,{default:t(()=>{var a;return[(a=x.value.data)!=null&&a.length?(f(),A(de,{key:0},{default:t(()=>[(f(!0),_(Q,null,W(x.value.data,c=>(f(),A($,{key:c.id,class:"px-0"},{append:t(()=>[i("div",Ua,[i("div",$a,r(c.commission.toFixed(2))+" MAD ",1),e(Y,{color:xe(c.status),size:"x-small",variant:"tonal"},{default:t(()=>[u(r(c.status),1)]),_:2},1032,["color"])])]),default:t(()=>[e(F,{class:"text-sm font-weight-medium"},{default:t(()=>[u(r(c.affiliate_name),1)]),_:2},1024),e(ce,{class:"text-xs"},{default:t(()=>[u(r(c.order_ref)+" • "+r(c.product_name),1)]),_:2},1024),e(ce,{class:"text-xs text-medium-emphasis"},{default:t(()=>[u(r(c.date),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):p.value.ledger?(f(),_("div",Fa,[e(X,{indeterminate:"",color:"primary"})])):(f(),_("div",Ba,r(s(l)("no_data_available")),1)),x.value.pagination?(f(),_("div",Pa,[e(qe,{modelValue:n.value.page,"onUpdate:modelValue":[d[7]||(d[7]=c=>n.value.page=c),te],length:x.value.pagination.last_page,"total-visible":5,size:"small"},null,8,["modelValue","length"])])):H("",!0)]}),_:1})]),_:1})]),_:1})]),_:1})]))}}),Vt=Je(Na,[["__scopeId","data-v-056f863b"]]);export{Vt as default};
