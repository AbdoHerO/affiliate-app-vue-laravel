import{$ as O}from"./api-DSi3Suj8.js";import{S as ke,P as Ve}from"./MixedChart.vue_vue_type_style_index_0_scoped_14692a4d_lang-DJnNojsB.js";import{d as we,aL as Ce,r as R,V as G,w as W,D as De,bb as Re,c as h,o as p,e as u,b as e,g as E,l as U,t as o,m as l,f as a,s as m,ac as C,az as _,p as Se,bc as Te,F as X,i as Z,v as ee,aV as F,ai as Ee}from"./main-uLG9IIeX.js";import{S as Ae,A as ze}from"./AdvancedStatsCard-CP5nLFwL.js";import{s as te,g as je,f as Oe,a as ae,k as Ie,j as q,b as le,l as Le,m as Me,n as Pe,i as $e,d as Ue,h as Fe}from"./chartExporter-kyLT3Kom.js";import{V as se,a as I,b as L,d as Be}from"./VList-uZDByhc2.js";import{V as re}from"./VDivider-UqGR4x4D.js";import{V as Ne}from"./VMenu-DP1p-55V.js";import{b as M,V as A}from"./VCard-CB1gT6RB.js";import{V as K}from"./VAvatar-bHPDEsYY.js";import{V as z}from"./VCardText-BZtszuIK.js";import{V as oe}from"./VTextField-Dxeq5kx5.js";import{V as ie}from"./VSelect-sWnAtot-.js";import{V as Ge}from"./VAlert-TgguXW_5.js";import{a as j,V as J}from"./VRow-aGfXYx3U.js";import{V as qe}from"./VDataTable-DNqSzzrc.js";import{V as Ke}from"./VChip-B84WcmDa.js";import{V as Je}from"./VPagination-DYW6O4lq.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D-EbNoF1.js";import"./_commonjsHelpers-CqkleIqs.js";import"./ssrBoot-BPhRU-mF.js";import"./VImg-BS6_svHJ.js";import"./createSimpleFunctional-DugzUcbB.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./dialog-transition-2hF0ajsQ.js";import"./VField-CfH1YcVv.js";import"./VCheckboxBtn-CogF2AUK.js";/* empty css              */import"./VTable-0U-NvIH3.js";import"./filter-D_SbaZWa.js";const He={class:"d-flex align-center justify-space-between mb-6"},Qe={class:"text-h4 font-weight-bold mb-1"},We={class:"text-body-1 mb-0"},Xe={class:"d-flex gap-3"},Ze={class:"d-flex align-center"},et={class:"text-h6 font-weight-semibold mb-0"},tt={class:"text-body-2 text-medium-emphasis mb-0"},at={class:"d-flex gap-2"},lt={class:"filters-layout"},st={class:"primary-filters"},rt={class:"filter-group"},ot={class:"filter-header"},it={class:"filter-title"},nt={class:"filter-group filter-group-wide"},dt={class:"filter-header"},ut={class:"filter-title"},ct={class:"date-range-container"},mt={class:"date-separator"},pt={class:"secondary-filters"},_t={class:"filter-group"},ft={class:"filter-header"},vt={class:"filter-title"},ht={class:"filter-group"},gt={class:"filter-header"},yt={class:"filter-title"},bt={class:"d-flex align-center justify-space-between"},xt={class:"text-sm text-medium-emphasis mb-1"},kt={key:0,class:"d-flex align-center mt-1"},Vt={class:"text-sm text-medium-emphasis ms-1"},wt={key:1,class:"text-xs text-error mt-1"},Ct={key:0,class:"text-center py-8"},Dt={class:"mt-2"},Rt={key:1},St={key:2,class:"text-center py-8 text-medium-emphasis"},Tt={key:0},Et={key:1},At={key:3,class:"text-center py-8 text-medium-emphasis"},zt={key:0,class:"text-center py-8"},jt={key:2,class:"text-center py-8 text-medium-emphasis"},Ot={key:0,class:"text-center py-8"},It={key:2,class:"text-center py-8 text-medium-emphasis"},Lt={class:"d-flex align-center"},Mt={key:0,class:"d-flex justify-center mt-4"},Pt={class:"text-end"},$t={class:"text-sm font-weight-bold"},Ut={class:"text-xs text-medium-emphasis"},Ft={key:1,class:"text-center py-8"},Bt={key:2,class:"text-center py-8 text-medium-emphasis"},Nt=we({__name:"reports-sales",setup(Gt){const{t}=Ce();let S=null,k=null,D=null;const $=R(!1),f=R({summary:!1,charts:!1,tables:!1}),b=R(null),x=R({summary:!1,charts:!1,tables:!1}),g=R(null),v=R({}),y=R({}),n=R({dateRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},period:"day",status:"",affiliate_ids:[],product_ids:[],category_ids:[],boutique_ids:[],country:"",city:"",page:1,per_page:15}),ne=G(()=>[{title:t("last_7_days"),value:7},{title:t("last_30_days"),value:30},{title:t("last_90_days"),value:90},{title:t("this_month"),value:"month"},{title:t("custom"),value:"custom"}]),Y=G(()=>f.value.summary||f.value.charts||f.value.tables),de=G(()=>g.value?[{key:"total_sales",title:t("total_sales"),icon:"tabler-currency-dollar",color:"success",currency:"MAD"},{key:"orders_count",title:t("orders_count"),icon:"tabler-shopping-cart",color:"primary"},{key:"avg_order_value",title:t("avg_order_value"),icon:"tabler-chart-line",color:"info",currency:"MAD"},{key:"delivered_rate",title:t("delivered_rate"),icon:"tabler-truck-delivery",color:"success",unit:"%"},{key:"return_rate",title:t("return_rate"),icon:"tabler-arrow-back",color:"warning",unit:"%"},{key:"commissions_accrued",title:t("commissions_accrued"),icon:"tabler-coins",color:"secondary",currency:"MAD"}].map(i=>{const s=te(g.value[i.key]),d=je(s.delta);return{title:i.title,value:s.value,displayValue:Oe(s.value,{currency:i.currency,unit:i.unit,decimals:i.currency?0:i.unit==="%"?1:0}),icon:i.icon,color:i.color,trend:s.delta!==null?{value:s.delta,icon:d.icon,color:d.color,text:d.text,label:t("vs_previous_period")}:null,isValid:s.isValid}}):[]),H=()=>{S&&(S.abort(),S=null),k&&(k.abort(),k=null),D&&(D.abort(),D=null)},ue=async()=>{f.value.summary=!0,b.value=null,x.value.summary=!1;try{S&&S.abort(),S=new AbortController;const r=await O("/admin/reports/sales/summary",{method:"GET",signal:S.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,...n.value}});if(r.success){const i=r.data&&Object.keys(r.data).length>0;if(x.value.summary=!i,i){g.value={};for(const[s,d]of Object.entries(r.data))g.value[s]=te(d)}else g.value=null}else throw new Error(r.message||"Failed to fetch summary")}catch(r){r.name!=="AbortError"&&(b.value=r instanceof Error?r.message:"An error occurred",console.error("Error fetching sales summary:",r))}finally{f.value.summary=!1}},B=async()=>{f.value.charts=!0,x.value.charts=!1;try{k&&k.abort(),k=new AbortController;const[r,i,s]=await Promise.allSettled([O("/admin/reports/sales/series",{method:"GET",signal:k.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,period:n.value.period}}),O("/admin/reports/sales/status-breakdown",{method:"GET",signal:k.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end}}),O("/admin/reports/sales/top-products",{method:"GET",signal:k.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,limit:10}})]);v.value={};let d=!1;if(r.status==="fulfilled"&&r.value.success)for(const[c,T]of Object.entries(r.value.data)){const Q=q(T);v.value[c]=Q,Q.isEmpty||(d=!0)}else r.status==="rejected"&&console.error("Error fetching series data:",r.reason);if(i.status==="fulfilled"&&i.value.success){const c=q(i.value.data);v.value.status_breakdown=c,c.isEmpty||(d=!0)}else i.status==="rejected"&&console.error("Error fetching status breakdown:",i.reason);if(s.status==="fulfilled"&&s.value.success){const c=q(s.value.data);v.value.top_products=c,c.isEmpty||(d=!0)}else s.status==="rejected"&&console.error("Error fetching top products:",s.reason);x.value.charts=!d}catch(r){r.name!=="AbortError"&&(console.error("Error fetching chart data:",r),x.value.charts=!0)}finally{f.value.charts=!1}},N=async()=>{f.value.tables=!0,x.value.tables=!1;try{D&&D.abort(),D=new AbortController;const[r,i]=await Promise.allSettled([O("/admin/reports/sales/orders",{method:"GET",signal:D.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,page:n.value.page,per_page:n.value.per_page}}),O("/admin/reports/sales/top-affiliates",{method:"GET",signal:D.signal,params:{date_start:n.value.dateRange.start,date_end:n.value.dateRange.end,limit:10}})]);y.value={};let s=!1;if(r.status==="fulfilled"&&r.value.success){const d=r.value.data;y.value.orders={...d,data:le(d.data||[])},d.data&&d.data.length>0&&(s=!0)}else r.status==="rejected"&&console.error("Error fetching orders data:",r.reason);if(i.status==="fulfilled"&&i.value.success){const d=le(i.value.data||[]);y.value.affiliates=d,d.length>0&&(s=!0)}else i.status==="rejected"&&console.error("Error fetching affiliates data:",i.reason);x.value.tables=!s}catch(r){r.name!=="AbortError"&&(console.error("Error fetching table data:",r),x.value.tables=!0)}finally{f.value.tables=!1}},ce=r=>{const i=new Date;if(typeof r=="number")n.value.dateRange.start=new Date(i.getTime()-r*24*60*60*1e3).toISOString().split("T")[0],n.value.dateRange.end=i.toISOString().split("T")[0];else if(r==="month"){const s=new Date(i.getFullYear(),i.getMonth(),1);n.value.dateRange.start=s.toISOString().split("T")[0],n.value.dateRange.end=i.toISOString().split("T")[0]}},P=async()=>{await Promise.all([ue(),B(),N()])},me=async()=>{H(),V&&(clearTimeout(V),V=null),w&&(clearTimeout(w),w=null),$.value=!0,n.value={dateRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},period:"day",status:"",affiliate_ids:[],product_ids:[],category_ids:[],boutique_ids:[],country:"",city:"",page:1,per_page:15},await Ee(),$.value=!1,P()},pe=()=>{try{const r={timestamp:new Date().toISOString(),filters:n.value,summary:g.value,charts:v.value,tables:y.value},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),d=document.createElement("a");d.href=s,d.download=`sales-report-${n.value.dateRange.start}-to-${n.value.dateRange.end}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)}catch(r){console.error("Error exporting data:",r)}},_e=()=>{var r;(r=y.value.orders)!=null&&r.data&&Le(y.value.orders.data,`sales-orders-${n.value.dateRange.start}-to-${n.value.dateRange.end}`)},fe=()=>{y.value.affiliates&&Me(y.value.affiliates,`top-affiliates-${n.value.dateRange.start}-to-${n.value.dateRange.end}`)},ve=()=>{var r;(r=v.value.top_products)!=null&&r.table_data&&Pe(v.value.top_products.table_data,`top-products-${n.value.dateRange.start}-to-${n.value.dateRange.end}`)},he=async()=>{const r=$e();if(!r.available){b.value=r.reason||"Export not available";return}try{await Ue({filename:`sales-dashboard-${n.value.dateRange.start}-to-${n.value.dateRange.end}`,title:t("sales_reports"),includeKPIs:!0,includeCharts:!0})}catch(i){const s=i instanceof Error?i:new Error("Export failed");b.value=Fe(s),console.error("Error exporting dashboard:",s)}},ge=r=>({livre:"success",echec:"error",retour:"warning",annule:"secondary",confirme:"primary",en_attente:"info"})[r]||"default",ye=r=>({livre:t("delivered"),echec:t("failed"),retour:t("returned"),annule:t("canceled"),confirme:t("confirmed"),en_attente:t("pending")})[r]||r;let V=null;const be=()=>{$.value||(V&&clearTimeout(V),V=setTimeout(()=>{P()},300))};let w=null;const xe=()=>{$.value||(w&&clearTimeout(w),w=setTimeout(()=>{B()},300))};return W(()=>n.value.dateRange,be,{deep:!0}),W(()=>n.value.period,xe),De(()=>{P()}),Re(()=>{H(),V&&(clearTimeout(V),V=null),w&&(clearTimeout(w),w=null),g.value=null,v.value={},y.value={},f.value={summary:!1,charts:!1,tables:!1},b.value=null,x.value={summary:!1,charts:!1,tables:!1}}),(r,i)=>(p(),h("div",null,[u("div",He,[u("div",null,[u("h1",Qe,o(l(t)("sales_reports")),1),u("p",We,o(l(t)("view_detailed_sales_analytics")),1)]),u("div",Xe,[e(C,{variant:"outlined","prepend-icon":"tabler-refresh",loading:Y.value,onClick:P},{default:a(()=>[m(o(l(t)("refresh")),1)]),_:1},8,["loading"]),e(Ne,null,{activator:a(({props:s})=>[e(C,Se({color:"primary","prepend-icon":"tabler-download"},s),{default:a(()=>[m(o(l(t)("export"))+" ",1),e(_,{icon:"tabler-chevron-down",class:"ms-1"})]),_:2},1040)]),default:a(()=>[e(se,null,{default:a(()=>[e(I,{onClick:pe},{prepend:a(()=>[e(_,{icon:"tabler-file-type-json"})]),default:a(()=>[e(L,null,{default:a(()=>[m(o(l(t)("export_json")),1)]),_:1})]),_:1}),e(I,{onClick:he},{prepend:a(()=>[e(_,{icon:"tabler-photo"})]),default:a(()=>[e(L,null,{default:a(()=>[m(o(l(t)("export_dashboard_image")),1)]),_:1})]),_:1}),e(re),e(I,{onClick:_e},{prepend:a(()=>[e(_,{icon:"tabler-file-spreadsheet"})]),default:a(()=>[e(L,null,{default:a(()=>[m(o(l(t)("export_orders_csv")),1)]),_:1})]),_:1}),e(I,{onClick:fe},{prepend:a(()=>[e(_,{icon:"tabler-file-spreadsheet"})]),default:a(()=>[e(L,null,{default:a(()=>[m(o(l(t)("export_affiliates_csv")),1)]),_:1})]),_:1}),e(I,{onClick:ve},{prepend:a(()=>[e(_,{icon:"tabler-file-spreadsheet"})]),default:a(()=>[e(L,null,{default:a(()=>[m(o(l(t)("export_products_csv")),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),e(A,{class:"mb-6 filters-card",elevation:"2"},{default:a(()=>[e(M,{class:"d-flex align-center justify-space-between pa-6 pb-4"},{default:a(()=>[u("div",Ze,[e(K,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:a(()=>[e(_,{icon:"tabler-filter",size:"18"})]),_:1}),u("div",null,[u("h3",et,o(l(t)("filters")),1),u("p",tt,o(l(t)("filter_your_sales_data")),1)])]),u("div",at,[e(C,{variant:"outlined",color:"primary","prepend-icon":"tabler-refresh",loading:Y.value,onClick:P,class:"filter-action-btn"},{default:a(()=>[m(o(l(t)("apply")),1)]),_:1},8,["loading"]),e(C,{variant:"text",color:"secondary","prepend-icon":"tabler-x",onClick:me,class:"filter-action-btn"},{default:a(()=>[m(o(l(t)("reset")),1)]),_:1})])]),_:1}),e(re),e(z,{class:"pa-6"},{default:a(()=>[u("div",lt,[u("div",st,[u("div",rt,[u("div",ot,[e(_,{icon:"tabler-clock",size:"16",class:"me-2 text-primary"}),u("span",it,o(l(t)("period")),1)]),e(Te,{modelValue:n.value.period,"onUpdate:modelValue":i[0]||(i[0]=s=>n.value.period=s),variant:"outlined",color:"primary",divided:"",mandatory:"",class:"period-toggle"},{default:a(()=>[e(C,{value:"day",class:"period-btn"},{default:a(()=>[e(_,{icon:"tabler-calendar-day",size:"16",class:"me-1"}),m(" "+o(l(t)("day")),1)]),_:1}),e(C,{value:"week",class:"period-btn"},{default:a(()=>[e(_,{icon:"tabler-calendar-week",size:"16",class:"me-1"}),m(" "+o(l(t)("week")),1)]),_:1}),e(C,{value:"month",class:"period-btn"},{default:a(()=>[e(_,{icon:"tabler-calendar-month",size:"16",class:"me-1"}),m(" "+o(l(t)("month")),1)]),_:1})]),_:1},8,["modelValue"])]),u("div",nt,[u("div",dt,[e(_,{icon:"tabler-calendar",size:"16",class:"me-2 text-primary"}),u("span",ut,o(l(t)("date_range")),1)]),u("div",ct,[e(oe,{modelValue:n.value.dateRange.start,"onUpdate:modelValue":i[1]||(i[1]=s=>n.value.dateRange.start=s),type:"date",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-event",class:"date-input",placeholder:l(t)("start_date")},null,8,["modelValue","placeholder"]),u("div",mt,[e(_,{icon:"tabler-arrow-right",size:"16",class:"text-medium-emphasis"})]),e(oe,{modelValue:n.value.dateRange.end,"onUpdate:modelValue":i[2]||(i[2]=s=>n.value.dateRange.end=s),type:"date",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-event",class:"date-input",placeholder:l(t)("end_date")},null,8,["modelValue","placeholder"])])])]),u("div",pt,[u("div",_t,[u("div",ft,[e(_,{icon:"tabler-clock-hour-3",size:"16",class:"me-2 text-primary"}),u("span",vt,o(l(t)("quick_select")),1)]),e(ie,{items:ne.value,"item-title":"title","item-value":"value",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-time",class:"modern-select","onUpdate:modelValue":ce},null,8,["items"])]),u("div",ht,[u("div",gt,[e(_,{icon:"tabler-flag",size:"16",class:"me-2 text-primary"}),u("span",yt,o(l(t)("status")),1)]),e(ie,{modelValue:n.value.status,"onUpdate:modelValue":i[3]||(i[3]=s=>n.value.status=s),items:[{title:l(t)("all"),value:""},{title:l(t)("delivered"),value:"livre"},{title:l(t)("failed"),value:"echec"},{title:l(t)("returned"),value:"retour"},{title:l(t)("canceled"),value:"annule"},{title:l(t)("confirmed"),value:"confirme"},{title:l(t)("pending"),value:"en_attente"}],"item-title":"title","item-value":"value",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-list-check",class:"modern-select"},null,8,["modelValue","items"])])])])]),_:1})]),_:1}),b.value?(p(),E(Ge,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":i[4]||(i[4]=s=>b.value=null)},{default:a(()=>[m(o(b.value),1)]),_:1})):U("",!0),e(J,{class:"mb-6","data-export":"kpi-cards"},{default:a(()=>[(p(!0),h(X,null,Z(de.value,(s,d)=>(p(),E(j,{key:d,cols:"12",sm:"6",lg:"4",xl:"2"},{default:a(()=>[e(A,null,{default:a(()=>[e(z,null,{default:a(()=>[u("div",bt,[u("div",null,[u("p",xt,o(s.title),1),u("h3",{class:ee(["text-h5 font-weight-bold",{"text-error":!s.isValid}])},o(s.displayValue),3),s.trend?(p(),h("div",kt,[e(_,{icon:s.trend.icon,color:s.trend.color,size:"16",class:"me-1"},null,8,["icon","color"]),u("span",{class:ee(["text-sm",`text-${s.trend.color}`])},o(s.trend.text),3),u("span",Vt,o(s.trend.label),1)])):s.isValid?U("",!0):(p(),h("div",wt,o(l(t)("invalid_data")),1))]),e(K,{color:s.color,variant:"tonal",size:"40"},{default:a(()=>[e(_,{icon:s.icon},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(J,{class:"mb-6"},{default:a(()=>[e(j,{cols:"12",lg:"8"},{default:a(()=>[e(A,{"data-export":"chart"},{default:a(()=>[e(M,null,{default:a(()=>[e(_,{icon:"tabler-chart-line",class:"me-2"}),m(" "+o(l(t)("sales_over_time")),1)]),_:1}),e(z,null,{default:a(()=>{var s,d;return[f.value.charts?(p(),h("div",Ct,[e(F,{indeterminate:"",color:"primary"}),u("p",Dt,o(l(t)("loading_charts")),1)])):v.value.sales_over_time&&!v.value.sales_over_time.isEmpty?(p(),h("div",Rt,[e(l(ke),{data:l(ae)(v.value.sales_over_time.data,l(t)("sales_mad"),l(t)("delivered_orders_only"),(((d=(s=g.value)==null?void 0:s.total_sales)==null?void 0:d.value)||0)+" MAD",v.value.sales_over_time.growth||"+0%","success"),loading:f.value.charts},null,8,["data","loading"])])):x.value.charts||b.value?(p(),h("div",St,[e(_,{icon:"tabler-chart-line",size:"48",class:"mb-2 opacity-50"}),b.value?(p(),h("p",Tt,o(b.value),1)):(p(),h("p",Et,o(l(t)("no_sales_data")),1)),b.value?(p(),E(C,{key:2,variant:"outlined",size:"small",class:"mt-2",onClick:B},{default:a(()=>[m(o(l(t)("retry")),1)]),_:1})):U("",!0)])):(p(),h("div",At,[e(_,{icon:"tabler-chart-line",size:"48",class:"mb-2 opacity-50"}),u("p",null,o(l(t)("no_data_available")),1)]))]}),_:1})]),_:1})]),_:1}),e(j,{cols:"12",lg:"4"},{default:a(()=>[e(A,{"data-export":"chart"},{default:a(()=>[e(M,null,{default:a(()=>[e(_,{icon:"tabler-chart-donut",class:"me-2"}),m(" "+o(l(t)("orders_by_status")),1)]),_:1}),e(z,null,{default:a(()=>[f.value.charts?(p(),h("div",zt,[e(F,{indeterminate:"",color:"primary"})])):v.value.status_breakdown&&!v.value.status_breakdown.isEmpty?(p(),E(l(Ae),{key:1,data:l(Ie)(v.value.status_breakdown.delivered||0,v.value.status_breakdown.pending||0,l(t)("delivery_rate")),loading:f.value.charts},null,8,["data","loading"])):(p(),h("div",jt,o(l(t)("no_data_available")),1))]),_:1})]),_:1})]),_:1}),e(j,{cols:"12",lg:"6"},{default:a(()=>[e(A,null,{default:a(()=>[e(M,null,{default:a(()=>[e(_,{icon:"tabler-trophy",class:"me-2"}),m(" "+o(l(t)("top_products_by_revenue")),1)]),_:1}),e(z,null,{default:a(()=>{var s,d,c,T;return[f.value.charts?(p(),h("div",Ot,[e(F,{indeterminate:"",color:"primary"})])):v.value.top_products&&!v.value.top_products.isEmpty?(p(),E(l(Ve),{key:1,data:l(ae)(v.value.top_products.data,l(t)("revenue_mad"),l(t)("top_10_products"),(((d=(s=g.value)==null?void 0:s.total_sales)==null?void 0:d.value)||0)+" MAD",((T=(c=g.value)==null?void 0:c.total_sales)==null?void 0:T.delta)||"+0%","primary"),loading:f.value.charts},null,8,["data","loading"])):(p(),h("div",It,o(l(t)("no_data_available")),1))]}),_:1})]),_:1})]),_:1}),e(j,{cols:"12",lg:"6"},{default:a(()=>{var s,d,c,T;return[e(l(ze),{data:{title:l(t)("total_revenue"),value:String(((d=(s=g.value)==null?void 0:s.total_sales)==null?void 0:d.value)||0)+" MAD",subtitle:l(t)("platform_earnings"),icon:"tabler-currency-dollar",color:"success",trend:(T=(c=g.value)==null?void 0:c.total_sales)!=null&&T.delta?{value:String(Math.abs(g.value.total_sales.delta))+"%",direction:g.value.total_sales.delta>=0?"up":"down",period:l(t)("vs_previous_period")}:void 0},loading:f.value.summary},null,8,["data","loading"])]}),_:1})]),_:1}),e(J,null,{default:a(()=>[e(j,{cols:"12",lg:"8"},{default:a(()=>[e(A,null,{default:a(()=>[e(M,{class:"d-flex align-center justify-space-between"},{default:a(()=>[u("div",Lt,[e(_,{icon:"tabler-list",class:"me-2"}),m(" "+o(l(t)("recent_orders")),1)]),e(C,{variant:"text",size:"small","prepend-icon":"tabler-refresh",loading:f.value.tables,onClick:N},{default:a(()=>[m(o(l(t)("refresh")),1)]),_:1},8,["loading"])]),_:1}),e(z,null,{default:a(()=>{var s,d;return[e(qe,{items:((s=y.value.orders)==null?void 0:s.data)||[],headers:[{title:l(t)("order_ref"),key:"order_ref"},{title:l(t)("date"),key:"date"},{title:l(t)("affiliate"),key:"affiliate_name"},{title:l(t)("customer"),key:"customer_name"},{title:l(t)("status"),key:"status"},{title:l(t)("items"),key:"items_count"},{title:l(t)("total_mad"),key:"total",align:"end"},{title:l(t)("commission_mad"),key:"commission",align:"end"}],loading:f.value.tables,density:"compact","items-per-page":n.value.per_page,"hide-default-footer":""},{"item.status":a(({item:c})=>[e(Ke,{color:ge(c.status),size:"small",variant:"tonal"},{default:a(()=>[m(o(ye(c.status)),1)]),_:2},1032,["color"])]),"item.total":a(({item:c})=>[m(o(c.total.toFixed(2))+" MAD ",1)]),"item.commission":a(({item:c})=>[m(o(c.commission.toFixed(2))+" MAD ",1)]),_:1},8,["items","headers","loading","items-per-page"]),(d=y.value.orders)!=null&&d.pagination?(p(),h("div",Mt,[e(Je,{modelValue:n.value.page,"onUpdate:modelValue":[i[5]||(i[5]=c=>n.value.page=c),N],length:y.value.orders.pagination.last_page,"total-visible":7},null,8,["modelValue","length"])])):U("",!0)]}),_:1})]),_:1})]),_:1}),e(j,{cols:"12",lg:"4"},{default:a(()=>[e(A,null,{default:a(()=>[e(M,null,{default:a(()=>[e(_,{icon:"tabler-users",class:"me-2"}),m(" "+o(l(t)("top_affiliates_by_sales")),1)]),_:1}),e(z,null,{default:a(()=>{var s;return[(s=y.value.affiliates)!=null&&s.length?(p(),E(se,{key:0},{default:a(()=>[(p(!0),h(X,null,Z(y.value.affiliates,(d,c)=>(p(),E(I,{key:d.id,class:"px-0"},{prepend:a(()=>[e(K,{color:c<3?["warning","secondary","success"][c]:"grey",size:"32",variant:"tonal"},{default:a(()=>[m(o(c+1),1)]),_:2},1032,["color"])]),append:a(()=>[u("div",Pt,[u("div",$t,o(d.total_sales.toFixed(0))+" MAD ",1),u("div",Ut,o(d.total_commission.toFixed(0))+" "+o(l(t)("commission")),1)])]),default:a(()=>[e(L,{class:"text-sm font-weight-medium"},{default:a(()=>[m(o(d.name),1)]),_:2},1024),e(Be,{class:"text-xs"},{default:a(()=>[m(o(d.orders_count)+" "+o(l(t)("orders"))+" â€¢ "+o(d.delivered_rate)+"% "+o(l(t)("delivered")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):f.value.tables?(p(),h("div",Ft,[e(F,{indeterminate:"",color:"primary"})])):(p(),h("div",Bt,o(l(t)("no_data_available")),1))]}),_:1})]),_:1})]),_:1})]),_:1})]))}}),Va=Ye(Nt,[["__scopeId","data-v-46a720c7"]]);export{Va as default};
