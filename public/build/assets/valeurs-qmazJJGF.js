import{d as te,aL as re,u as oe,k as se,r as f,V as A,o as ie,c as D,b as y,e as a,f as v,n as s,ac as V,v as n,g as t,t as p,h as I,aU as ue,az as ne,F as de,j as ce,x as me,aW as M}from"./main-0h7RfoM1.js";import{u as k}from"./useApi-Bh3KIVij.js";import{useQuickConfirm as ve}from"./useConfirmAction-CnNtpBUM.js";import{V as fe}from"./VBreadcrumbs-C5bXM6fl.js";import{V as U}from"./VCardText-DBDe3l6V.js";import{V as _}from"./VTextField-CB8SxAnl.js";import{V as E,c as L,b as N}from"./VCard-BJO62jXa.js";import{V as pe,a as be}from"./VRow-CwTmyELD.js";import{V as O}from"./VChip-Cb1gcZbV.js";import{V as F}from"./VForm-BfVpbreJ.js";import{V as P}from"./VCheckbox-1KLNEl27.js";import{V as R}from"./VSpacer-CFtTO3F2.js";import{V as J}from"./VDialog-rW2Q1SF0.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VField-ThiSfLeE.js";import"./VImg-D8VstP0L.js";import"./forwardRefs-DtnMMuBS.js";import"./createSimpleFunctional-CRjW3p8V.js";import"./VAvatar-BcyggOHV.js";/* empty css              */import"./VCheckboxBtn-DNqYvCTV.js";import"./VOverlay-cV5WKNuZ.js";import"./lazy-DAn2yZiW.js";import"./dialog-transition--QLlkKWU.js";const _e={class:"d-flex justify-space-between align-center mb-6"},ye={class:"d-flex align-center gap-3 mb-2"},ge={class:"text-h4 font-weight-bold"},he={class:"text-body-1 text-medium-emphasis"},xe={key:0,class:"text-center py-8"},Ce={key:1,class:"text-center py-8"},we={class:"text-h6 mb-2"},ke={class:"text-body-2 text-medium-emphasis"},Ue={class:"d-flex justify-space-between align-start mb-3"},Ee={class:"text-h6 font-weight-bold"},$e={class:"text-caption text-medium-emphasis"},De=te({__name:"valeurs",setup(Te){const{t:o}=re(),Q=oe(),{confirmCreate:W,confirmUpdate:G,confirmDelete:H}=ve(),K=se(),$=f(null),c=f([]),T=f(!1),g=f(""),h=f(!1),x=f(!1),C=f(null),S=f(!1),i=f({code:"",libelle:"",actif:!0,ordre:0}),m=f({}),w=A(()=>Q.params.id),z=A(()=>{if(!g.value)return c.value;const r=g.value.toLowerCase();return c.value.filter(e=>e.code.toLowerCase().includes(r)||e.libelle.toLowerCase().includes(r))}),X=async()=>{try{const{data:r,error:e}=await k(`/admin/variant-attributs/${w.value}`);if(!e.value&&r.value){const u=r.value;u.success&&($.value=u.data)}}catch(r){console.error("Error fetching variant attribute:",r)}},Y=async()=>{try{T.value=!0;const{data:r,error:e}=await k(`/admin/variant-attributs/${w.value}/valeurs`);if(!e.value&&r.value){const u=r.value;u.success&&(c.value=u.data)}}catch(r){console.error("Error fetching variant values:",r)}finally{T.value=!1}},Z=()=>{const r=c.value.length>0?Math.max(...c.value.map(e=>e.ordre)):0;i.value={code:"",libelle:"",actif:!0,ordre:r+1},m.value={},h.value=!0},ee=r=>{C.value=r,i.value={code:r.code,libelle:r.libelle,actif:r.actif,ordre:r.ordre},m.value={},x.value=!0},ae=async r=>{if(await H("valeur",r.libelle))try{S.value=!0;const{data:u,error:d}=await k(`/admin/variant-attributs/${w.value}/valeurs/${r.id}`,{method:"DELETE"});!d.value&&u.value&&u.value.success&&(c.value=c.value.filter(l=>l.id!==r.id))}catch(u){console.error("Error deleting variant value:",u)}finally{S.value=!1}},j=async()=>{if(await W("valeur"))try{m.value={};const{data:e,error:u}=await k(`/admin/variant-attributs/${w.value}/valeurs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i.value)});if(!u.value&&e.value){const d=e.value;d.success?(c.value.push(d.data),c.value.sort((b,l)=>b.ordre-l.ordre),h.value=!1):d.errors&&(m.value=d.errors)}}catch(e){console.error("Error creating variant value:",e)}},q=async()=>{if(!(!C.value||!await G("valeur",C.value.libelle)))try{m.value={};const{data:e,error:u}=await k(`/admin/variant-attributs/${w.value}/valeurs/${C.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i.value)});if(!u.value&&e.value){const d=e.value;if(d.success){const b=c.value.findIndex(l=>l.id===C.value.id);b>-1&&(c.value[b]=d.data),c.value.sort((l,B)=>l.ordre-B.ordre),x.value=!1}else d.errors&&(m.value=d.errors)}}catch(e){console.error("Error updating variant value:",e)}},le=()=>{K.push("/admin/variants/attributs")};return ie(()=>{X(),Y()}),(r,e)=>{var u,d,b;return y(),D("div",null,[a(fe,{items:[{title:"Admin",disabled:!0},{title:"Variants",disabled:!0},{title:s(o)("admin_variants_attributes"),to:"/admin/variants/attributs"},{title:((u=$.value)==null?void 0:u.nom)||s(o)("admin_variants_values"),disabled:!0}],class:"px-0"},null,8,["items"]),v("div",_e,[v("div",null,[v("div",ye,[a(V,{icon:"tabler-arrow-left",variant:"text",onClick:le}),v("h1",ge,n(s(o)("admin_variants_attribute_values",{name:(d=$.value)==null?void 0:d.nom})),1)]),v("p",he,n(s(o)("admin_variants_manage_values_desc",{name:(b=$.value)==null?void 0:b.nom})),1)]),a(V,{color:"primary","prepend-icon":"tabler-plus",onClick:Z},{default:t(()=>[p(n(s(o)("admin_variants_add_value")),1)]),_:1})]),a(E,{class:"mb-6"},{default:t(()=>[a(U,null,{default:t(()=>[a(_,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),placeholder:"Search values...","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),a(E,null,{default:t(()=>[a(U,null,{default:t(()=>[T.value?(y(),D("div",xe,[a(ue,{indeterminate:"",color:"primary"})])):z.value.length===0?(y(),D("div",Ce,[a(ne,{icon:"tabler-list",size:"64",color:"grey",class:"mb-4"}),v("h3",we,n(s(o)("no_values_found")),1),v("p",ke,n(g.value?s(o)("try_adjusting_search"):s(o)("create_first_value_attribute")),1)])):(y(),I(pe,{key:2},{default:t(()=>[(y(!0),D(de,null,ce(z.value,l=>(y(),I(be,{key:l.id,cols:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[a(E,{class:me(["value-card h-100",{"opacity-60":!l.actif}]),elevation:"2"},{default:t(()=>[a(U,{class:"pb-2"},{default:t(()=>[v("div",Ue,[v("div",null,[v("h4",Ee,n(l.libelle),1),v("p",$e,n(l.code),1),a(O,{size:"x-small",variant:"outlined",class:"mt-1"},{default:t(()=>[p(n(s(o)("order"))+": "+n(l.ordre),1)]),_:2},1024)]),a(O,{color:l.actif?"success":"error",size:"small",variant:"flat"},{default:t(()=>[p(n(l.actif?s(o)("active"):s(o)("inactive")),1)]),_:2},1032,["color"])])]),_:2},1024),a(L,{class:"pt-0"},{default:t(()=>[a(V,{icon:"tabler-edit",size:"small",variant:"text",onClick:B=>ee(l)},null,8,["onClick"]),a(V,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:B=>ae(l)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}),a(J,{modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=l=>h.value=l),"max-width":"500"},{default:t(()=>[a(E,null,{default:t(()=>[a(N,null,{default:t(()=>[p(n(s(o)("create_value")),1)]),_:1}),a(U,null,{default:t(()=>[a(F,{onSubmit:M(j,["prevent"])},{default:t(()=>[a(_,{modelValue:i.value.code,"onUpdate:modelValue":e[1]||(e[1]=l=>i.value.code=l),label:"Code",placeholder:"e.g., l, blue, cotton","error-messages":m.value.code,variant:"outlined",class:"mb-4",required:""},null,8,["modelValue","error-messages"]),a(_,{modelValue:i.value.libelle,"onUpdate:modelValue":e[2]||(e[2]=l=>i.value.libelle=l),label:"Label",placeholder:"e.g., Large, Blue, Cotton","error-messages":m.value.libelle,variant:"outlined",class:"mb-4",required:""},null,8,["modelValue","error-messages"]),a(_,{modelValue:i.value.ordre,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value.ordre=l),modelModifiers:{number:!0},label:"Order",type:"number","error-messages":m.value.ordre,variant:"outlined",class:"mb-4"},null,8,["modelValue","error-messages"]),a(P,{modelValue:i.value.actif,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.actif=l),label:"Active"},null,8,["modelValue"])]),_:1})]),_:1}),a(L,null,{default:t(()=>[a(R),a(V,{type:"button",onClick:e[5]||(e[5]=l=>h.value=!1)},{default:t(()=>[p(n(s(o)("cancel")),1)]),_:1}),a(V,{color:"primary",type:"button",onClick:j},{default:t(()=>[p(n(s(o)("create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(J,{modelValue:x.value,"onUpdate:modelValue":e[12]||(e[12]=l=>x.value=l),"max-width":"500"},{default:t(()=>[a(E,null,{default:t(()=>[a(N,null,{default:t(()=>[p(n(s(o)("edit_value")),1)]),_:1}),a(U,null,{default:t(()=>[a(F,{onSubmit:M(q,["prevent"])},{default:t(()=>[a(_,{modelValue:i.value.code,"onUpdate:modelValue":e[7]||(e[7]=l=>i.value.code=l),label:s(o)("code"),"error-messages":m.value.code,variant:"outlined",class:"mb-4",required:""},null,8,["modelValue","label","error-messages"]),a(_,{modelValue:i.value.libelle,"onUpdate:modelValue":e[8]||(e[8]=l=>i.value.libelle=l),label:s(o)("label"),"error-messages":m.value.libelle,variant:"outlined",class:"mb-4",required:""},null,8,["modelValue","label","error-messages"]),a(_,{modelValue:i.value.ordre,"onUpdate:modelValue":e[9]||(e[9]=l=>i.value.ordre=l),modelModifiers:{number:!0},label:s(o)("order"),type:"number","error-messages":m.value.ordre,variant:"outlined",class:"mb-4"},null,8,["modelValue","label","error-messages"]),a(P,{modelValue:i.value.actif,"onUpdate:modelValue":e[10]||(e[10]=l=>i.value.actif=l),label:s(o)("active")},null,8,["modelValue","label"])]),_:1})]),_:1}),a(L,null,{default:t(()=>[a(R),a(V,{type:"button",onClick:e[11]||(e[11]=l=>x.value=!1)},{default:t(()=>[p(n(s(o)("cancel")),1)]),_:1}),a(V,{color:"primary",type:"button",onClick:q},{default:t(()=>[p(n(s(o)("update")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),aa=Ve(De,[["__scopeId","data-v-0542bf9a"]]);export{aa as default};
