import{d as U,aL as W,u as H,j as $,b7 as G,r as J,V as q,D as K,c as _,o as d,b as e,l as k,m as l,e as u,aV as Q,t as i,f as t,s as o,ac as F,g as x,az as X}from"./main-uLG9IIeX.js";import{u as Y}from"./orders-Dybf-UtB.js";import{u as Z}from"./useNotifications-DDBS_wPD.js";import{_ as tt}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-nczKusLe.js";import{V as T}from"./VChip-B84WcmDa.js";import{V as h,a as et}from"./VTabs-BkhoRyPL.js";import{V as A,a as lt}from"./VWindowItem-DPvP18Ki.js";import{V as at,a as L}from"./VRow-aGfXYx3U.js";import{V,b as g}from"./VCard-CB1gT6RB.js";import{V as C}from"./VCardText-BZtszuIK.js";import{V as B,a as p,b as c,d as y}from"./VList-uZDByhc2.js";import{V as D}from"./VDataTable-DNqSzzrc.js";import{V as R}from"./VAlert-TgguXW_5.js";import"./api-DSi3Suj8.js";import"./index-D-EbNoF1.js";import"./VBreadcrumbs-D7yKQl5l.js";import"./VAvatar-bHPDEsYY.js";import"./VImg-BS6_svHJ.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./ssrBoot-BPhRU-mF.js";/* empty css              */import"./createSimpleFunctional-DugzUcbB.js";import"./VDivider-UqGR4x4D.js";import"./VPagination-DYW6O4lq.js";import"./VSelect-sWnAtot-.js";import"./VTextField-Dxeq5kx5.js";import"./VField-CfH1YcVv.js";import"./dialog-transition-2hF0ajsQ.js";import"./VMenu-DP1p-55V.js";import"./VCheckboxBtn-CogF2AUK.js";import"./VTable-0U-NvIH3.js";import"./filter-D_SbaZWa.js";const ot={key:0,class:"text-center py-8"},it={key:1},st={class:"d-flex justify-space-between align-center mb-6"},rt={class:"text-h4 font-weight-bold mb-1"},nt={class:"d-flex align-center gap-4"},ut={class:"text-body-2 text-medium-emphasis"},dt={class:"text-body-1"},mt={class:"font-weight-medium"},ft={key:1,class:"text-medium-emphasis"},_t={class:"font-weight-medium"},pt={class:"font-weight-bold"},ct={key:0},yt={key:1},bt={key:0},vt={class:"font-weight-bold"},Vt={key:1},gt={key:2,class:"text-center py-8"},kt={class:"text-h6 mb-2"},xt={class:"text-body-2 text-medium-emphasis mb-4"},ae=U({__name:"index",setup(Ct){const{t:n}=W(),z=H(),I=$(),{showError:O}=Z(),b=Y(),{currentOrder:s,loading:M,error:N}=G(b),w=J("details"),P=q(()=>{var f;return[{title:n("dashboard"),to:{name:"affiliate-dashboard"}},{title:n("my_orders"),to:{name:"affiliate-orders"}},{title:((f=s.value)==null?void 0:f.numero_commande)||n("order_details"),active:!0}]});q(()=>{var f;return(f=s.value)!=null&&f.articles?s.value.articles.reduce((a,r)=>a+r.quantite*r.prix_unitaire,0):0});const j=async()=>{try{await b.fetchOrder(z.params.id)}catch{O(n("order_loading_error")),I.push({name:"affiliate-orders"})}},v=f=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MAD"}).format(f),E=f=>new Date(f).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),S=()=>{I.push({name:"affiliate-orders"})};return K(()=>{j()}),(f,a)=>(d(),_("div",null,[e(tt,{items:P.value},null,8,["items"]),l(M)?(d(),_("div",ot,[e(Q,{indeterminate:"",color:"primary",size:"64"}),a[2]||(a[2]=u("p",{class:"text-body-1 mt-4"},"Chargement de la commande...",-1))])):l(s)?(d(),_("div",it,[u("div",st,[u("div",null,[u("h1",rt," Commande #"+i(l(s).id.toString().slice(-8)),1),u("div",nt,[e(T,{color:l(b).getStatusColor(l(s).statut),variant:"tonal"},{default:t(()=>[o(i(l(b).getStatusLabel(l(s).statut)),1)]),_:1},8,["color"]),u("span",ut,i(l(n)("affiliate.orders.createdOn",{date:E(l(s).created_at)})),1)])]),e(F,{variant:"outlined","prepend-icon":"tabler-arrow-left",onClick:S},{default:t(()=>[o(i(l(n)("actions.back")),1)]),_:1})]),e(et,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=r=>w.value=r),class:"mb-6"},{default:t(()=>[e(h,{value:"details"},{default:t(()=>[o(i(l(n)("common.details")),1)]),_:1}),e(h,{value:"articles"},{default:t(()=>[o(i(l(n)("affiliate.orders.articles")),1)]),_:1}),e(h,{value:"shipping"},{default:t(()=>[o(i(l(n)("affiliate.orders.shipping")),1)]),_:1}),e(h,{value:"commissions"},{default:t(()=>a[3]||(a[3]=[o("Commissions")])),_:1,__:[3]})]),_:1},8,["modelValue"]),e(lt,{modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=r=>w.value=r)},{default:t(()=>[e(A,{value:"details"},{default:t(()=>[e(at,null,{default:t(()=>[e(L,{cols:"12",md:"6"},{default:t(()=>[e(V,null,{default:t(()=>[e(g,null,{default:t(()=>a[4]||(a[4]=[o("Informations de la commande")])),_:1,__:[4]}),e(C,null,{default:t(()=>[e(B,null,{default:t(()=>[e(p,null,{default:t(()=>[e(c,null,{default:t(()=>a[5]||(a[5]=[o("Référence")])),_:1,__:[5]}),e(y,null,{default:t(()=>[o("#"+i(l(s).id),1)]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(c,null,{default:t(()=>[o(i(l(n)("form.status")),1)]),_:1}),e(y,null,{default:t(()=>[e(T,{color:l(b).getStatusColor(l(s).statut),size:"small",variant:"tonal"},{default:t(()=>[o(i(l(b).getStatusLabel(l(s).statut)),1)]),_:1},8,["color"])]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(c,null,{default:t(()=>a[6]||(a[6]=[o("Boutique")])),_:1,__:[6]}),e(y,null,{default:t(()=>{var r;return[o(i(((r=l(s).boutique)==null?void 0:r.nom)||"N/A"),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(c,null,{default:t(()=>a[7]||(a[7]=[o("Mode de paiement")])),_:1,__:[7]}),e(y,null,{default:t(()=>[o(i(l(s).mode_paiement||"N/A"),1)]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(c,null,{default:t(()=>a[8]||(a[8]=[o("Total HT")])),_:1,__:[8]}),e(y,null,{default:t(()=>[o(i(v(l(s).total_ht)),1)]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(c,null,{default:t(()=>a[9]||(a[9]=[o("Total TTC")])),_:1,__:[9]}),e(y,{class:"font-weight-bold"},{default:t(()=>[o(i(v(l(s).total_ttc)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{cols:"12",md:"6"},{default:t(()=>[e(V,null,{default:t(()=>[e(g,null,{default:t(()=>a[10]||(a[10]=[o("Informations client")])),_:1,__:[10]}),e(C,null,{default:t(()=>[e(B,null,{default:t(()=>[l(s).client?(d(),x(p,{key:0},{default:t(()=>[e(c,null,{default:t(()=>a[11]||(a[11]=[o("Client")])),_:1,__:[11]}),e(y,null,{default:t(()=>[o(i(l(s).client.nom_complet),1)]),_:1})]),_:1})):k("",!0),l(s).clientFinal?(d(),x(p,{key:1},{default:t(()=>[e(c,null,{default:t(()=>a[12]||(a[12]=[o("Client final")])),_:1,__:[12]}),e(y,null,{default:t(()=>[o(i(l(s).clientFinal.nom_complet),1),a[13]||(a[13]=u("br",null,null,-1)),o(" "+i(l(s).clientFinal.telephone),1),a[14]||(a[14]=u("br",null,null,-1)),o(" "+i(l(s).clientFinal.email),1)]),_:1,__:[13,14]})]),_:1})):k("",!0),l(s).adresse?(d(),x(p,{key:2},{default:t(()=>[e(c,null,{default:t(()=>[o(i(l(n)("affiliate.orders.deliveryAddress")),1)]),_:1}),e(y,null,{default:t(()=>[o(i(l(s).adresse.adresse),1),a[15]||(a[15]=u("br",null,null,-1)),o(" "+i(l(s).adresse.ville),1)]),_:1,__:[15]})]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(s).notes?(d(),x(V,{key:0,class:"mt-6"},{default:t(()=>[e(g,null,{default:t(()=>a[16]||(a[16]=[o("Notes")])),_:1,__:[16]}),e(C,null,{default:t(()=>[u("p",dt,i(l(s).notes),1)]),_:1})]),_:1})):k("",!0)]),_:1}),e(A,{value:"articles"},{default:t(()=>[e(V,null,{default:t(()=>[e(g,null,{default:t(()=>a[17]||(a[17]=[o("Articles commandés")])),_:1,__:[17]}),e(D,{headers:[{title:l(n)("affiliate.orders.product"),key:"produit.titre"},{title:l(n)("affiliate.orders.variant"),key:"variante.nom"},{title:l(n)("affiliate.orders.quantity"),key:"quantite"},{title:l(n)("affiliate.orders.unitPrice"),key:"prix_unitaire"},{title:l(n)("affiliate.orders.total"),key:"total"}],items:l(s).articles||[],"hide-default-footer":""},{"item.produit.titre":t(({item:r})=>{var m;return[u("div",mt,i(((m=r.produit)==null?void 0:m.titre)||"N/A"),1)]}),"item.variante.nom":t(({item:r})=>[r.variante?(d(),x(T,{key:0,size:"small",variant:"tonal",color:"info"},{default:t(()=>[o(i(r.variante.nom),1)]),_:2},1024)):(d(),_("span",ft,"-"))]),"item.quantite":t(({item:r})=>[u("span",_t,i(r.quantite),1)]),"item.prix_unitaire":t(({item:r})=>[o(i(v(r.prix_unitaire)),1)]),"item.total":t(({item:r})=>[u("span",pt,i(v(r.quantite*r.prix_unitaire)),1)]),_:1},8,["headers","items"])]),_:1})]),_:1}),e(A,{value:"shipping"},{default:t(()=>[e(V,null,{default:t(()=>[e(g,null,{default:t(()=>a[18]||(a[18]=[o("Informations d'expédition")])),_:1,__:[18]}),e(C,null,{default:t(()=>[l(s).shippingParcel?(d(),_("div",ct,a[19]||(a[19]=[u("p",{class:"text-body-1 mb-4"},"Colis créé et en cours de traitement",-1)]))):(d(),_("div",yt,[e(R,{type:"info",variant:"tonal"},{default:t(()=>a[20]||(a[20]=[o(" Cette commande n'a pas encore été expédiée. ")])),_:1,__:[20]})]))]),_:1})]),_:1})]),_:1}),e(A,{value:"commissions"},{default:t(()=>[e(V,null,{default:t(()=>[e(g,null,{default:t(()=>a[21]||(a[21]=[o("Commissions")])),_:1,__:[21]}),e(C,null,{default:t(()=>{var r;return[(r=l(s).commissions)!=null&&r.length?(d(),_("div",bt,[e(D,{headers:[{title:l(n)("affiliate.orders.type"),key:"type"},{title:l(n)("affiliate.orders.baseAmount"),key:"base_amount"},{title:l(n)("affiliate.orders.rate"),key:"rate"},{title:l(n)("affiliate.orders.commission"),key:"amount"},{title:l(n)("form.status"),key:"status"}],items:l(s).commissions,"hide-default-footer":""},{"item.base_amount":t(({item:m})=>[o(i(v(m.base_amount)),1)]),"item.rate":t(({item:m})=>[o(i((m.rate*100).toFixed(2))+"% ",1)]),"item.amount":t(({item:m})=>[u("span",vt,i(v(m.amount)),1)]),"item.status":t(({item:m})=>[e(T,{size:"small",variant:"tonal",color:m.status==="paid"?"success":m.status==="eligible"?"info":"warning"},{default:t(()=>[o(i(m.status),1)]),_:2},1032,["color"])]),_:1},8,["headers","items"])])):(d(),_("div",Vt,[e(R,{type:"info",variant:"tonal"},{default:t(()=>a[22]||(a[22]=[o(" Aucune commission générée pour cette commande. ")])),_:1,__:[22]})]))]}),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):l(N)?(d(),_("div",gt,[e(X,{icon:"tabler-alert-circle",size:"64",class:"text-error mb-4"}),u("h3",kt,i(l(n)("affiliate_order_error_title")),1),u("p",xt,i(l(N)),1),e(F,{color:"primary",onClick:S},{default:t(()=>[o(i(l(n)("affiliate.orders.backToOrders")),1)]),_:1})])):k("",!0)]))}});export{ae as default};
