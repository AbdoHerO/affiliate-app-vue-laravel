import{d as Z,aF as Re,V as z,cV as le,c as h,b as m,G as me,n as s,e,g as a,t as p,h as C,aU as U,F as Y,j as Q,v as r,f as o,az as _,x as G,m as A,b2 as De,aL as Te,r as j,w as re,o as $e,bb as Ee,ac as $,q as Ae,bc as je,ba as F,ai as Le}from"./main-0h7RfoM1.js";import{u as Ie,m as Oe,s as oe,g as Pe,f as Me,S as Fe,a as ie,k as Ue,P as Be,j as W,b as ne,l as Ge,n as Ne,o as qe,i as He,d as Ke,h as We}from"./chartExporter-JHHaIyr4.js";import{V as E,a as Je,b as O,d as Ye}from"./VCard-BJO62jXa.js";import{V as R}from"./VCardText-DBDe3l6V.js";import{V as X,a as P,b as M,d as pe}from"./VList-D8OGLl9W.js";import{V as N}from"./VAvatar-BcyggOHV.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as de}from"./VDivider-CF-VI2ua.js";import{V as Qe}from"./VMenu-BRSAgo5d.js";import{V as ce}from"./VTextField-CB8SxAnl.js";import{V as ue}from"./VSelect-E3I5xPtI.js";import{V as Xe}from"./VAlert-S22fKLZ6.js";import{a as I,V as J}from"./VRow-CwTmyELD.js";import{V as Ze}from"./VDataTable-CrgqCoMT.js";import{V as et}from"./VChip-Cb1gcZbV.js";import{V as tt}from"./VPagination-CjKu94po.js";import"./_commonjsHelpers-CqkleIqs.js";import"./createSimpleFunctional-CRjW3p8V.js";import"./VImg-D8VstP0L.js";import"./ssrBoot-_8LWlSSM.js";import"./VOverlay-cV5WKNuZ.js";import"./forwardRefs-DtnMMuBS.js";import"./lazy-DAn2yZiW.js";import"./dialog-transition--QLlkKWU.js";import"./VField-ThiSfLeE.js";import"./VCheckboxBtn-DNqYvCTV.js";/* empty css              */import"./VTable-BHYHnEIv.js";import"./filter-BbUs5nlv.js";const at={key:1,class:"d-flex align-center justify-center mb-4 chart-loading",style:{height:"200px"}},st={class:"text-end"},lt={class:"text-h6 font-weight-medium"},rt=Z({__name:"SessionAnalyticsDonut",props:{data:{},loading:{type:Boolean,default:!1}},setup(q){const t=Re(),f=q,{shouldRender:k,containerRef:V,containerStyle:n}=Ie(z(()=>f.loading),z(()=>f.data),{minWidth:200,minHeight:200}),g=z(()=>{var b,i;const x=typeof((b=f.data)==null?void 0:b.verified)=="number"&&isFinite(f.data.verified)?f.data.verified:0,v=typeof((i=f.data)==null?void 0:i.pending)=="number"&&isFinite(f.data.pending)?f.data.pending:0;return[x,v]}),w=z(()=>{const x=t.current.value.colors,v=t.current.value.variables;return{chart:{type:"donut",height:200,parentHeightOffset:0},labels:["Verified","Pending"],colors:["rgba(var(--v-theme-success), 1)","rgba(var(--v-theme-warning), 1)"],stroke:{width:0},dataLabels:{enabled:!1},legend:{show:!1},tooltip:{y:{formatter:b=>b.toLocaleString()}},plotOptions:{pie:{donut:{size:"70%",labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:"24px",fontWeight:600,color:`rgba(${le(x["on-background"])},${v["high-emphasis-opacity"]})`,formatter:()=>`${f.data.centerMetric}%`},total:{show:!0,label:f.data.centerLabel,fontSize:"12px",color:`rgba(${le(x["on-surface"])},${v["disabled-opacity"]})`,formatter:()=>f.data.centerLabel}}}}},responsive:[{breakpoint:1280,options:{chart:{height:180}}},{breakpoint:960,options:{chart:{height:220}}}]}}),S=z(()=>[{icon:"tabler-check-circle",color:"success",title:"Verified Signups",value:f.data.verified.toLocaleString(),percentage:Math.round(f.data.verified/(f.data.verified+f.data.pending)*100)},{icon:"tabler-clock",color:"warning",title:"Pending Signups",value:f.data.pending.toLocaleString(),percentage:Math.round(f.data.pending/(f.data.verified+f.data.pending)*100)}]);return(x,v)=>{const b=Oe;return m(),h("div",{ref_key:"containerRef",ref:V,class:"advanced-chart-container",style:me(s(n))},[e(E,{class:"session-analytics-donut"},{default:a(()=>[e(Je,{class:"pb-3"},{default:a(()=>[e(O,null,{default:a(()=>v[0]||(v[0]=[p(" Session Analytics ")])),_:1,__:[0]}),e(Ye,null,{default:a(()=>v[1]||(v[1]=[p(" Signup Performance ")])),_:1,__:[1]})]),_:1}),e(R,null,{default:a(()=>[s(k)?(m(),C(b,{key:0,options:w.value,series:g.value,type:"donut",height:200,class:"mb-4"},null,8,["options","series"])):(m(),h("div",at,[e(U,{indeterminate:"",color:"primary",size:"48"})])),e(X,{class:"card-list"},{default:a(()=>[(m(!0),h(Y,null,Q(S.value,i=>(m(),C(P,{key:i.title,class:"px-0"},{prepend:a(()=>[e(N,{size:"38",color:i.color,variant:"tonal",rounded:"",class:"me-3"},{default:a(()=>[e(_,{icon:i.icon,size:"22"},null,8,["icon"])]),_:2},1032,["color"])]),append:a(()=>[o("div",st,[o("h6",lt,r(i.value),1)])]),default:a(()=>[e(M,{class:"font-weight-medium"},{default:a(()=>[p(r(i.title),1)]),_:2},1024),e(pe,null,{default:a(()=>[p(r(i.percentage)+"% of total ",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})],4)}}}),ot=ee(rt,[["__scopeId","data-v-72ae83c6"]]),it={class:"advanced-chart-container"},nt={class:"d-flex align-center justify-space-between mb-3"},dt={class:"text-sm font-weight-medium"},ct={class:"mb-2"},ut={class:"text-body-1 font-weight-medium"},mt={key:0,class:"text-body-2 text-disabled"},pt={key:0,class:"mt-4"},ft={class:"d-flex align-center justify-space-between mb-2"},vt={class:"text-sm"},_t={class:"text-sm font-weight-medium"},ht={key:1,class:"mt-4"},gt={class:"d-flex align-center justify-space-between"},yt={class:"text-body-2 text-disabled"},bt={class:"text-sm font-weight-medium"},xt={class:"text-end"},kt={class:"text-sm"},wt={key:2,class:"mt-3"},Vt={class:"text-caption text-disabled"},St=Z({__name:"AdvancedStatsCard",props:{data:{},loading:{type:Boolean,default:!1},size:{default:"medium"}},setup(q){const t=q,f=z(()=>{if(t.loading)return!1;const n=t.data;return!n||typeof n!="object"?!1:n.value!==void 0&&n.value!==null&&String(n.value).length>0}),k=z(()=>{var n;return((n=t.data)==null?void 0:n.color)||"primary"}),V=z(()=>{var n;return((n=t.data)==null?void 0:n.icon)||"tabler-chart-bar"});return(n,g)=>(m(),h("div",it,[e(E,{class:G(["advanced-stats-card",`stats-card-${n.size}`])},{default:a(()=>[!n.loading&&f.value?(m(),C(R,{key:0},{default:a(()=>[o("div",nt,[e(N,{color:n.data.color||k.value,variant:"tonal",size:n.size==="large"?48:n.size==="medium"?40:32,rounded:""},{default:a(()=>[e(_,{icon:n.data.icon||V.value,size:n.size==="large"?24:n.size==="medium"?20:16},null,8,["icon","size"])]),_:1},8,["color","size"]),n.data.trend?(m(),h("div",{key:0,class:G(["d-flex align-center",n.data.trend.direction==="up"?"text-success":"text-error"])},[e(_,{icon:n.data.trend.direction==="up"?"tabler-trending-up":"tabler-trending-down",size:"20",class:"me-1"},null,8,["icon"]),o("span",dt,r(n.data.trend.value),1)],2)):A("",!0)]),o("div",ct,[o("h3",{class:G(["font-weight-bold",n.size==="large"?"text-h3":n.size==="medium"?"text-h4":"text-h5"])},r(n.data.value),3),o("div",ut,r(n.data.title),1),n.data.subtitle?(m(),h("div",mt,r(n.data.subtitle),1)):A("",!0)]),n.data.progress?(m(),h("div",pt,[o("div",ft,[o("span",vt,r(n.data.progress.label),1),o("span",_t,r(n.data.progress.value)+"%",1)]),e(De,{"model-value":n.data.progress.value,color:n.data.color,height:"6",rounded:"","rounded-bar":""},null,8,["model-value","color"])])):A("",!0),n.data.comparison?(m(),h("div",ht,[o("div",gt,[o("div",null,[o("div",yt,r(n.data.comparison.label),1),o("div",bt,r(n.data.comparison.current),1)]),o("div",xt,[g[0]||(g[0]=o("div",{class:"text-body-2 text-disabled"},"Previous",-1)),o("div",kt,r(n.data.comparison.previous),1)])])])):A("",!0),n.data.trend?(m(),h("div",wt,[o("div",Vt,r(n.data.trend.period),1)])):A("",!0)]),_:1})):(m(),C(R,{key:1,class:"d-flex align-center justify-center chart-loading",style:me(`height: ${n.size==="large"?"200px":n.size==="medium"?"150px":"120px"};`)},{default:a(()=>[e(U,{indeterminate:"",color:k.value,size:n.size==="large"?48:n.size==="medium"?40:32},null,8,["color","size"])]),_:1},8,["style"]))]),_:1},8,["class"])]))}}),Ct=ee(St,[["__scopeId","data-v-e9ea7edd"]]),zt={class:"d-flex align-center justify-space-between mb-6"},Rt={class:"text-h4 font-weight-bold mb-1"},Dt={class:"text-body-1 mb-0"},Tt={class:"d-flex gap-3"},$t={class:"d-flex align-center"},Et={class:"text-h6 font-weight-semibold mb-0"},At={class:"text-body-2 text-medium-emphasis mb-0"},jt={class:"d-flex gap-2"},Lt={class:"filters-layout"},It={class:"primary-filters"},Ot={class:"filter-group"},Pt={class:"filter-header"},Mt={class:"filter-title"},Ft={class:"filter-group filter-group-wide"},Ut={class:"filter-header"},Bt={class:"filter-title"},Gt={class:"date-range-container"},Nt={class:"date-separator"},qt={class:"secondary-filters"},Ht={class:"filter-group"},Kt={class:"filter-header"},Wt={class:"filter-title"},Jt={class:"filter-group"},Yt={class:"filter-header"},Qt={class:"filter-title"},Xt={class:"d-flex align-center justify-space-between"},Zt={class:"text-sm text-medium-emphasis mb-1"},ea={key:0,class:"d-flex align-center mt-1"},ta={class:"text-sm text-medium-emphasis ms-1"},aa={key:1,class:"text-xs text-error mt-1"},sa={key:0,class:"text-center py-8"},la={class:"mt-2"},ra={key:1},oa={key:2,class:"text-center py-8 text-medium-emphasis"},ia={key:0},na={key:1},da={key:3,class:"text-center py-8 text-medium-emphasis"},ca={key:0,class:"text-center py-8"},ua={key:2,class:"text-center py-8 text-medium-emphasis"},ma={key:0,class:"text-center py-8"},pa={key:2,class:"text-center py-8 text-medium-emphasis"},fa={class:"d-flex align-center"},va={key:0,class:"d-flex justify-center mt-4"},_a={class:"text-end"},ha={class:"text-sm font-weight-bold"},ga={class:"text-xs text-medium-emphasis"},ya={key:1,class:"text-center py-8"},ba={key:2,class:"text-center py-8 text-medium-emphasis"},xa=Z({__name:"reports-sales",setup(q){const{t}=Te();let f=null,k=null,V=null;const n=j(!1),g=j({summary:!1,charts:!1,tables:!1}),w=j(null),S=j({summary:!1,charts:!1,tables:!1}),x=j(null),v=j({}),b=j({}),i=j({dateRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},period:"day",status:"",affiliate_ids:[],product_ids:[],category_ids:[],boutique_ids:[],country:"",city:"",page:1,per_page:15}),fe=z(()=>[{title:t("last_7_days"),value:7},{title:t("last_30_days"),value:30},{title:t("last_90_days"),value:90},{title:t("this_month"),value:"month"},{title:t("custom"),value:"custom"}]),te=z(()=>g.value.summary||g.value.charts||g.value.tables),ve=z(()=>x.value?[{key:"total_sales",title:t("total_sales"),icon:"tabler-currency-dollar",color:"success",currency:"MAD"},{key:"orders_count",title:t("orders_count"),icon:"tabler-shopping-cart",color:"primary"},{key:"avg_order_value",title:t("avg_order_value"),icon:"tabler-chart-line",color:"info",currency:"MAD"},{key:"delivered_rate",title:t("delivered_rate"),icon:"tabler-truck-delivery",color:"success",unit:"%"},{key:"return_rate",title:t("return_rate"),icon:"tabler-arrow-back",color:"warning",unit:"%"},{key:"commissions_accrued",title:t("commissions_accrued"),icon:"tabler-coins",color:"secondary",currency:"MAD"}].map(c=>{const l=oe(x.value[c.key]),u=Pe(l.delta);return{title:c.title,value:l.value,displayValue:Me(l.value,{currency:c.currency,unit:c.unit,decimals:c.currency?0:c.unit==="%"?1:0}),icon:c.icon,color:c.color,trend:l.delta!==null?{value:l.delta,icon:u.icon,color:u.color,text:u.text,label:t("vs_previous_period")}:null,isValid:l.isValid}}):[]),ae=()=>{f&&(f.abort(),f=null),k&&(k.abort(),k=null),V&&(V.abort(),V=null)},_e=async()=>{g.value.summary=!0,w.value=null,S.value.summary=!1;try{f&&f.abort(),f=new AbortController;const d=await F("/admin/reports/sales/summary",{method:"GET",signal:f.signal,params:{date_start:i.value.dateRange.start,date_end:i.value.dateRange.end,...i.value}});if(d.success){const c=d.data&&Object.keys(d.data).length>0;if(S.value.summary=!c,c){x.value={};for(const[l,u]of Object.entries(d.data))x.value[l]=oe(u)}else x.value=null}else throw new Error(d.message||"Failed to fetch summary")}catch(d){d.name!=="AbortError"&&(w.value=d instanceof Error?d.message:"An error occurred",console.error("Error fetching sales summary:",d))}finally{g.value.summary=!1}},H=async()=>{g.value.charts=!0,S.value.charts=!1;try{k&&k.abort(),k=new AbortController;const[d,c,l]=await Promise.allSettled([F("/admin/reports/sales/series",{method:"GET",signal:k.signal,params:{date_start:i.value.dateRange.start,date_end:i.value.dateRange.end,period:i.value.period}}),F("/admin/reports/sales/status-breakdown",{method:"GET",signal:k.signal,params:{date_start:i.value.dateRange.start,date_end:i.value.dateRange.end}}),F("/admin/reports/sales/top-products",{method:"GET",signal:k.signal,params:{date_start:i.value.dateRange.start,date_end:i.value.dateRange.end,limit:10}})]);v.value={};let u=!1;if(d.status==="fulfilled"&&d.value.success)for(const[y,L]of Object.entries(d.value.data)){const se=W(L);v.value[y]=se,se.isEmpty||(u=!0)}else d.status==="rejected"&&console.error("Error fetching series data:",d.reason);if(c.status==="fulfilled"&&c.value.success){const y=W(c.value.data);v.value.status_breakdown=y,y.isEmpty||(u=!0)}else c.status==="rejected"&&console.error("Error fetching status breakdown:",c.reason);if(l.status==="fulfilled"&&l.value.success){const y=W(l.value.data);v.value.top_products=y,y.isEmpty||(u=!0)}else l.status==="rejected"&&console.error("Error fetching top products:",l.reason);S.value.charts=!u}catch(d){d.name!=="AbortError"&&(console.error("Error fetching chart data:",d),S.value.charts=!0)}finally{g.value.charts=!1}},K=async()=>{g.value.tables=!0,S.value.tables=!1;try{V&&V.abort(),V=new AbortController;const[d,c]=await Promise.allSettled([F("/admin/reports/sales/orders",{method:"GET",signal:V.signal,params:{date_start:i.value.dateRange.start,date_end:i.value.dateRange.end,page:i.value.page,per_page:i.value.per_page}}),F("/admin/reports/sales/top-affiliates",{method:"GET",signal:V.signal,params:{date_start:i.value.dateRange.start,date_end:i.value.dateRange.end,limit:10}})]);b.value={};let l=!1;if(d.status==="fulfilled"&&d.value.success){const u=d.value.data;b.value.orders={...u,data:ne(u.data||[])},u.data&&u.data.length>0&&(l=!0)}else d.status==="rejected"&&console.error("Error fetching orders data:",d.reason);if(c.status==="fulfilled"&&c.value.success){const u=ne(c.value.data||[]);b.value.affiliates=u,u.length>0&&(l=!0)}else c.status==="rejected"&&console.error("Error fetching affiliates data:",c.reason);S.value.tables=!l}catch(d){d.name!=="AbortError"&&(console.error("Error fetching table data:",d),S.value.tables=!0)}finally{g.value.tables=!1}},he=d=>{const c=new Date;if(typeof d=="number")i.value.dateRange.start=new Date(c.getTime()-d*24*60*60*1e3).toISOString().split("T")[0],i.value.dateRange.end=c.toISOString().split("T")[0];else if(d==="month"){const l=new Date(c.getFullYear(),c.getMonth(),1);i.value.dateRange.start=l.toISOString().split("T")[0],i.value.dateRange.end=c.toISOString().split("T")[0]}},B=async()=>{await Promise.all([_e(),H(),K()])},ge=async()=>{ae(),D&&(clearTimeout(D),D=null),T&&(clearTimeout(T),T=null),n.value=!0,i.value={dateRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},period:"day",status:"",affiliate_ids:[],product_ids:[],category_ids:[],boutique_ids:[],country:"",city:"",page:1,per_page:15},await Le(),n.value=!1,B()},ye=()=>{try{const d={timestamp:new Date().toISOString(),filters:i.value,summary:x.value,charts:v.value,tables:b.value},c=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),l=URL.createObjectURL(c),u=document.createElement("a");u.href=l,u.download=`sales-report-${i.value.dateRange.start}-to-${i.value.dateRange.end}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(l)}catch(d){console.error("Error exporting data:",d)}},be=()=>{var d;(d=b.value.orders)!=null&&d.data&&Ge(b.value.orders.data,`sales-orders-${i.value.dateRange.start}-to-${i.value.dateRange.end}`)},xe=()=>{b.value.affiliates&&Ne(b.value.affiliates,`top-affiliates-${i.value.dateRange.start}-to-${i.value.dateRange.end}`)},ke=()=>{var d;(d=v.value.top_products)!=null&&d.table_data&&qe(v.value.top_products.table_data,`top-products-${i.value.dateRange.start}-to-${i.value.dateRange.end}`)},we=async()=>{const d=He();if(!d.available){w.value=d.reason||"Export not available";return}try{await Ke({filename:`sales-dashboard-${i.value.dateRange.start}-to-${i.value.dateRange.end}`,title:t("sales_reports"),includeKPIs:!0,includeCharts:!0})}catch(c){const l=c instanceof Error?c:new Error("Export failed");w.value=We(l),console.error("Error exporting dashboard:",l)}},Ve=d=>({livre:"success",echec:"error",retour:"warning",annule:"secondary",confirme:"primary",en_attente:"info"})[d]||"default",Se=d=>({livre:t("delivered"),echec:t("failed"),retour:t("returned"),annule:t("canceled"),confirme:t("confirmed"),en_attente:t("pending")})[d]||d;let D=null;const Ce=()=>{n.value||(D&&clearTimeout(D),D=setTimeout(()=>{B()},300))};let T=null;const ze=()=>{n.value||(T&&clearTimeout(T),T=setTimeout(()=>{H()},300))};return re(()=>i.value.dateRange,Ce,{deep:!0}),re(()=>i.value.period,ze),$e(()=>{B()}),Ee(()=>{ae(),D&&(clearTimeout(D),D=null),T&&(clearTimeout(T),T=null),x.value=null,v.value={},b.value={},g.value={summary:!1,charts:!1,tables:!1},w.value=null,S.value={summary:!1,charts:!1,tables:!1}}),(d,c)=>(m(),h("div",null,[o("div",zt,[o("div",null,[o("h1",Rt,r(s(t)("sales_reports")),1),o("p",Dt,r(s(t)("view_detailed_sales_analytics")),1)]),o("div",Tt,[e($,{variant:"outlined","prepend-icon":"tabler-refresh",loading:te.value,onClick:B},{default:a(()=>[p(r(s(t)("refresh")),1)]),_:1},8,["loading"]),e(Qe,null,{activator:a(({props:l})=>[e($,Ae({color:"primary","prepend-icon":"tabler-download"},l),{default:a(()=>[p(r(s(t)("export"))+" ",1),e(_,{icon:"tabler-chevron-down",class:"ms-1"})]),_:2},1040)]),default:a(()=>[e(X,null,{default:a(()=>[e(P,{onClick:ye},{prepend:a(()=>[e(_,{icon:"tabler-file-type-json"})]),default:a(()=>[e(M,null,{default:a(()=>[p(r(s(t)("export_json")),1)]),_:1})]),_:1}),e(P,{onClick:we},{prepend:a(()=>[e(_,{icon:"tabler-photo"})]),default:a(()=>[e(M,null,{default:a(()=>[p(r(s(t)("export_dashboard_image")),1)]),_:1})]),_:1}),e(de),e(P,{onClick:be},{prepend:a(()=>[e(_,{icon:"tabler-file-spreadsheet"})]),default:a(()=>[e(M,null,{default:a(()=>[p(r(s(t)("export_orders_csv")),1)]),_:1})]),_:1}),e(P,{onClick:xe},{prepend:a(()=>[e(_,{icon:"tabler-file-spreadsheet"})]),default:a(()=>[e(M,null,{default:a(()=>[p(r(s(t)("export_affiliates_csv")),1)]),_:1})]),_:1}),e(P,{onClick:ke},{prepend:a(()=>[e(_,{icon:"tabler-file-spreadsheet"})]),default:a(()=>[e(M,null,{default:a(()=>[p(r(s(t)("export_products_csv")),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),e(E,{class:"mb-6 filters-card",elevation:"2"},{default:a(()=>[e(O,{class:"d-flex align-center justify-space-between pa-6 pb-4"},{default:a(()=>[o("div",$t,[e(N,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:a(()=>[e(_,{icon:"tabler-filter",size:"18"})]),_:1}),o("div",null,[o("h3",Et,r(s(t)("filters")),1),o("p",At,r(s(t)("filter_your_sales_data")),1)])]),o("div",jt,[e($,{variant:"outlined",color:"primary","prepend-icon":"tabler-refresh",loading:te.value,onClick:B,class:"filter-action-btn"},{default:a(()=>[p(r(s(t)("apply")),1)]),_:1},8,["loading"]),e($,{variant:"text",color:"secondary","prepend-icon":"tabler-x",onClick:ge,class:"filter-action-btn"},{default:a(()=>[p(r(s(t)("reset")),1)]),_:1})])]),_:1}),e(de),e(R,{class:"pa-6"},{default:a(()=>[o("div",Lt,[o("div",It,[o("div",Ot,[o("div",Pt,[e(_,{icon:"tabler-clock",size:"16",class:"me-2 text-primary"}),o("span",Mt,r(s(t)("period")),1)]),e(je,{modelValue:i.value.period,"onUpdate:modelValue":c[0]||(c[0]=l=>i.value.period=l),variant:"outlined",color:"primary",divided:"",mandatory:"",class:"period-toggle"},{default:a(()=>[e($,{value:"day",class:"period-btn"},{default:a(()=>[e(_,{icon:"tabler-calendar-day",size:"16",class:"me-1"}),p(" "+r(s(t)("day")),1)]),_:1}),e($,{value:"week",class:"period-btn"},{default:a(()=>[e(_,{icon:"tabler-calendar-week",size:"16",class:"me-1"}),p(" "+r(s(t)("week")),1)]),_:1}),e($,{value:"month",class:"period-btn"},{default:a(()=>[e(_,{icon:"tabler-calendar-month",size:"16",class:"me-1"}),p(" "+r(s(t)("month")),1)]),_:1})]),_:1},8,["modelValue"])]),o("div",Ft,[o("div",Ut,[e(_,{icon:"tabler-calendar",size:"16",class:"me-2 text-primary"}),o("span",Bt,r(s(t)("date_range")),1)]),o("div",Gt,[e(ce,{modelValue:i.value.dateRange.start,"onUpdate:modelValue":c[1]||(c[1]=l=>i.value.dateRange.start=l),type:"date",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-event",class:"date-input",placeholder:s(t)("start_date")},null,8,["modelValue","placeholder"]),o("div",Nt,[e(_,{icon:"tabler-arrow-right",size:"16",class:"text-medium-emphasis"})]),e(ce,{modelValue:i.value.dateRange.end,"onUpdate:modelValue":c[2]||(c[2]=l=>i.value.dateRange.end=l),type:"date",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-event",class:"date-input",placeholder:s(t)("end_date")},null,8,["modelValue","placeholder"])])])]),o("div",qt,[o("div",Ht,[o("div",Kt,[e(_,{icon:"tabler-clock-hour-3",size:"16",class:"me-2 text-primary"}),o("span",Wt,r(s(t)("quick_select")),1)]),e(ue,{items:fe.value,"item-title":"title","item-value":"value",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-calendar-time",class:"modern-select","onUpdate:modelValue":he},null,8,["items"])]),o("div",Jt,[o("div",Yt,[e(_,{icon:"tabler-flag",size:"16",class:"me-2 text-primary"}),o("span",Qt,r(s(t)("status")),1)]),e(ue,{modelValue:i.value.status,"onUpdate:modelValue":c[3]||(c[3]=l=>i.value.status=l),items:[{title:s(t)("all"),value:""},{title:s(t)("delivered"),value:"livre"},{title:s(t)("failed"),value:"echec"},{title:s(t)("returned"),value:"retour"},{title:s(t)("canceled"),value:"annule"},{title:s(t)("confirmed"),value:"confirme"},{title:s(t)("pending"),value:"en_attente"}],"item-title":"title","item-value":"value",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"tabler-list-check",class:"modern-select"},null,8,["modelValue","items"])])])])]),_:1})]),_:1}),w.value?(m(),C(Xe,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":c[4]||(c[4]=l=>w.value=null)},{default:a(()=>[p(r(w.value),1)]),_:1})):A("",!0),e(J,{class:"mb-6","data-export":"kpi-cards"},{default:a(()=>[(m(!0),h(Y,null,Q(ve.value,(l,u)=>(m(),C(I,{key:u,cols:"12",sm:"6",lg:"4",xl:"2"},{default:a(()=>[e(E,null,{default:a(()=>[e(R,null,{default:a(()=>[o("div",Xt,[o("div",null,[o("p",Zt,r(l.title),1),o("h3",{class:G(["text-h5 font-weight-bold",{"text-error":!l.isValid}])},r(l.displayValue),3),l.trend?(m(),h("div",ea,[e(_,{icon:l.trend.icon,color:l.trend.color,size:"16",class:"me-1"},null,8,["icon","color"]),o("span",{class:G(["text-sm",`text-${l.trend.color}`])},r(l.trend.text),3),o("span",ta,r(l.trend.label),1)])):l.isValid?A("",!0):(m(),h("div",aa,r(s(t)("invalid_data")),1))]),e(N,{color:l.color,variant:"tonal",size:"40"},{default:a(()=>[e(_,{icon:l.icon},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(J,{class:"mb-6"},{default:a(()=>[e(I,{cols:"12",lg:"8"},{default:a(()=>[e(E,{"data-export":"chart"},{default:a(()=>[e(O,null,{default:a(()=>[e(_,{icon:"tabler-chart-line",class:"me-2"}),p(" "+r(s(t)("sales_over_time")),1)]),_:1}),e(R,null,{default:a(()=>{var l,u;return[g.value.charts?(m(),h("div",sa,[e(U,{indeterminate:"",color:"primary"}),o("p",la,r(s(t)("loading_charts")),1)])):v.value.sales_over_time&&!v.value.sales_over_time.isEmpty?(m(),h("div",ra,[e(s(Fe),{data:s(ie)(v.value.sales_over_time.data,s(t)("sales_mad"),s(t)("delivered_orders_only"),(((u=(l=x.value)==null?void 0:l.total_sales)==null?void 0:u.value)||0)+" MAD",v.value.sales_over_time.growth||"+0%","success"),loading:g.value.charts},null,8,["data","loading"])])):S.value.charts||w.value?(m(),h("div",oa,[e(_,{icon:"tabler-chart-line",size:"48",class:"mb-2 opacity-50"}),w.value?(m(),h("p",ia,r(w.value),1)):(m(),h("p",na,r(s(t)("no_sales_data")),1)),w.value?(m(),C($,{key:2,variant:"outlined",size:"small",class:"mt-2",onClick:H},{default:a(()=>[p(r(s(t)("retry")),1)]),_:1})):A("",!0)])):(m(),h("div",da,[e(_,{icon:"tabler-chart-line",size:"48",class:"mb-2 opacity-50"}),o("p",null,r(s(t)("no_data_available")),1)]))]}),_:1})]),_:1})]),_:1}),e(I,{cols:"12",lg:"4"},{default:a(()=>[e(E,{"data-export":"chart"},{default:a(()=>[e(O,null,{default:a(()=>[e(_,{icon:"tabler-chart-donut",class:"me-2"}),p(" "+r(s(t)("orders_by_status")),1)]),_:1}),e(R,null,{default:a(()=>[g.value.charts?(m(),h("div",ca,[e(U,{indeterminate:"",color:"primary"})])):v.value.status_breakdown&&!v.value.status_breakdown.isEmpty?(m(),C(s(ot),{key:1,data:s(Ue)(v.value.status_breakdown.delivered||0,v.value.status_breakdown.pending||0,s(t)("delivery_rate")),loading:g.value.charts},null,8,["data","loading"])):(m(),h("div",ua,r(s(t)("no_data_available")),1))]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",lg:"6"},{default:a(()=>[e(E,null,{default:a(()=>[e(O,null,{default:a(()=>[e(_,{icon:"tabler-trophy",class:"me-2"}),p(" "+r(s(t)("top_products_by_revenue")),1)]),_:1}),e(R,null,{default:a(()=>{var l,u,y,L;return[g.value.charts?(m(),h("div",ma,[e(U,{indeterminate:"",color:"primary"})])):v.value.top_products&&!v.value.top_products.isEmpty?(m(),C(s(Be),{key:1,data:s(ie)(v.value.top_products.data,s(t)("revenue_mad"),s(t)("top_10_products"),(((u=(l=x.value)==null?void 0:l.total_sales)==null?void 0:u.value)||0)+" MAD",((L=(y=x.value)==null?void 0:y.total_sales)==null?void 0:L.delta)||"+0%","primary"),loading:g.value.charts},null,8,["data","loading"])):(m(),h("div",pa,r(s(t)("no_data_available")),1))]}),_:1})]),_:1})]),_:1}),e(I,{cols:"12",lg:"6"},{default:a(()=>{var l,u,y,L;return[e(s(Ct),{data:{title:s(t)("total_revenue"),value:String(((u=(l=x.value)==null?void 0:l.total_sales)==null?void 0:u.value)||0)+" MAD",subtitle:s(t)("platform_earnings"),icon:"tabler-currency-dollar",color:"success",trend:(L=(y=x.value)==null?void 0:y.total_sales)!=null&&L.delta?{value:String(Math.abs(x.value.total_sales.delta))+"%",direction:x.value.total_sales.delta>=0?"up":"down",period:s(t)("vs_previous_period")}:void 0},loading:g.value.summary},null,8,["data","loading"])]}),_:1})]),_:1}),e(J,null,{default:a(()=>[e(I,{cols:"12",lg:"8"},{default:a(()=>[e(E,null,{default:a(()=>[e(O,{class:"d-flex align-center justify-space-between"},{default:a(()=>[o("div",fa,[e(_,{icon:"tabler-list",class:"me-2"}),p(" "+r(s(t)("recent_orders")),1)]),e($,{variant:"text",size:"small","prepend-icon":"tabler-refresh",loading:g.value.tables,onClick:K},{default:a(()=>[p(r(s(t)("refresh")),1)]),_:1},8,["loading"])]),_:1}),e(R,null,{default:a(()=>{var l,u;return[e(Ze,{items:((l=b.value.orders)==null?void 0:l.data)||[],headers:[{title:s(t)("order_ref"),key:"order_ref"},{title:s(t)("date"),key:"date"},{title:s(t)("affiliate"),key:"affiliate_name"},{title:s(t)("customer"),key:"customer_name"},{title:s(t)("status"),key:"status"},{title:s(t)("items"),key:"items_count"},{title:s(t)("total_mad"),key:"total",align:"end"},{title:s(t)("commission_mad"),key:"commission",align:"end"}],loading:g.value.tables,density:"compact","items-per-page":i.value.per_page,"hide-default-footer":""},{"item.status":a(({item:y})=>[e(et,{color:Ve(y.status),size:"small",variant:"tonal"},{default:a(()=>[p(r(Se(y.status)),1)]),_:2},1032,["color"])]),"item.total":a(({item:y})=>[p(r(y.total.toFixed(2))+" MAD ",1)]),"item.commission":a(({item:y})=>[p(r(y.commission.toFixed(2))+" MAD ",1)]),_:1},8,["items","headers","loading","items-per-page"]),(u=b.value.orders)!=null&&u.pagination?(m(),h("div",va,[e(tt,{modelValue:i.value.page,"onUpdate:modelValue":[c[5]||(c[5]=y=>i.value.page=y),K],length:b.value.orders.pagination.last_page,"total-visible":7},null,8,["modelValue","length"])])):A("",!0)]}),_:1})]),_:1})]),_:1}),e(I,{cols:"12",lg:"4"},{default:a(()=>[e(E,null,{default:a(()=>[e(O,null,{default:a(()=>[e(_,{icon:"tabler-users",class:"me-2"}),p(" "+r(s(t)("top_affiliates_by_sales")),1)]),_:1}),e(R,null,{default:a(()=>{var l;return[(l=b.value.affiliates)!=null&&l.length?(m(),C(X,{key:0},{default:a(()=>[(m(!0),h(Y,null,Q(b.value.affiliates,(u,y)=>(m(),C(P,{key:u.id,class:"px-0"},{prepend:a(()=>[e(N,{color:y<3?["warning","secondary","success"][y]:"grey",size:"32",variant:"tonal"},{default:a(()=>[p(r(y+1),1)]),_:2},1032,["color"])]),append:a(()=>[o("div",_a,[o("div",ha,r(u.total_sales.toFixed(0))+" MAD ",1),o("div",ga,r(u.total_commission.toFixed(0))+" "+r(s(t)("commission")),1)])]),default:a(()=>[e(M,{class:"text-sm font-weight-medium"},{default:a(()=>[p(r(u.name),1)]),_:2},1024),e(pe,{class:"text-xs"},{default:a(()=>[p(r(u.orders_count)+" "+r(s(t)("orders"))+" â€¢ "+r(u.delivered_rate)+"% "+r(s(t)("delivered")),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):g.value.tables?(m(),h("div",ya,[e(U,{indeterminate:"",color:"primary"})])):(m(),h("div",ba,r(s(t)("no_data_available")),1))]}),_:1})]),_:1})]),_:1})]),_:1})]))}}),Qa=ee(xa,[["__scopeId","data-v-46a720c7"]]);export{Qa as default};
