import{b5 as b,r as o,V as p,ba as v}from"./main-DEzoUo6n.js";const L=b("affiliateOrders",()=>{const i=o([]),d=o(null),s=o(!1),n=o(null),c=o({current_page:1,last_page:1,per_page:15,total:0,from:null,to:null}),e=o({q:"",status:[],boutique_id:"",date_from:"",date_to:"",sort:"created_at",dir:"desc",per_page:15}),g=p(()=>i.value.length>0),_=p(()=>s.value),h=async(a=1)=>{var t,f;s.value=!0,n.value=null;try{const r=new URLSearchParams;r.append("page",a.toString()),r.append("per_page",((t=e.value.per_page)==null?void 0:t.toString())||"15"),e.value.q&&r.append("q",e.value.q),(f=e.value.status)!=null&&f.length&&e.value.status.forEach(m=>r.append("status[]",m)),e.value.boutique_id&&r.append("boutique_id",e.value.boutique_id),e.value.date_from&&r.append("date_from",e.value.date_from),e.value.date_to&&r.append("date_to",e.value.date_to),e.value.sort&&r.append("sort",e.value.sort),e.value.dir&&r.append("dir",e.value.dir);const u=await v(`/affiliate/orders?${r.toString()}`);if(u.success)i.value=u.data,c.value=u.pagination;else throw new Error(u.message||"Failed to fetch orders")}catch(r){n.value=r.message||"An error occurred while fetching orders",console.error("Error fetching affiliate orders:",r)}finally{s.value=!1}};let l=null;return{orders:i,currentOrder:d,loading:s,error:n,pagination:c,filters:e,hasOrders:g,isLoading:_,fetchOrders:h,fetchOrder:async a=>{l&&l.abort(),l=new AbortController,s.value=!0,n.value=null;try{const t=await v(`/affiliate/orders/${a}`,{signal:l.signal});if(t.success)d.value=t.data;else throw new Error(t.message||"Failed to fetch order")}catch(t){t.name!=="AbortError"&&(n.value=t.message||"An error occurred while fetching the order",console.error("Error fetching affiliate order:",t))}finally{s.value=!1,l=null}},updateFilters:a=>{e.value={...e.value,...a}},resetFilters:()=>{e.value={q:"",status:[],boutique_id:"",date_from:"",date_to:"",sort:"created_at",dir:"desc",per_page:15}},clearCurrentOrder:()=>{d.value=null},getStatusColor:a=>({pending:"warning",confirmed:"info",sent:"primary",expedited:"purple",delivered:"success",canceled:"error",returned:"orange",returned_to_warehouse:"info",delivery_failed:"error",paid:"success"})[a]||"secondary",getStatusLabel:a=>({pending:"En attente",confirmed:"Confirmée",sent:"Envoyée",expedited:"Expédiée",delivered:"Livrée",canceled:"Annulée",returned:"Retournée",returned_to_warehouse:"Retournée en entrepôt",delivery_failed:"Échec livraison",paid:"Payée"})[a]||a}});export{L as u};
