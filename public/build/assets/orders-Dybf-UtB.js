import{b4 as b,r as o,V as p}from"./main-uLG9IIeX.js";import{$ as v}from"./api-DSi3Suj8.js";const A=b("affiliateOrders",()=>{const u=o([]),d=o(null),s=o(!1),l=o(null),c=o({current_page:1,last_page:1,per_page:15,total:0,from:null,to:null}),e=o({q:"",status:[],boutique_id:"",date_from:"",date_to:"",sort:"created_at",dir:"desc",per_page:15}),g=p(()=>u.value.length>0),_=p(()=>s.value),h=async(a=1)=>{var t,f;s.value=!0,l.value=null;try{const r=new URLSearchParams;r.append("page",a.toString()),r.append("per_page",((t=e.value.per_page)==null?void 0:t.toString())||"15"),e.value.q&&r.append("q",e.value.q),(f=e.value.status)!=null&&f.length&&e.value.status.forEach(m=>r.append("status[]",m)),e.value.boutique_id&&r.append("boutique_id",e.value.boutique_id),e.value.date_from&&r.append("date_from",e.value.date_from),e.value.date_to&&r.append("date_to",e.value.date_to),e.value.sort&&r.append("sort",e.value.sort),e.value.dir&&r.append("dir",e.value.dir);const i=await v(`/affiliate/orders?${r.toString()}`);if(i.success)u.value=i.data,c.value=i.pagination;else throw new Error(i.message||"Failed to fetch orders")}catch(r){l.value=r.message||"An error occurred while fetching orders",console.error("Error fetching affiliate orders:",r)}finally{s.value=!1}};let n=null;return{orders:u,currentOrder:d,loading:s,error:l,pagination:c,filters:e,hasOrders:g,isLoading:_,fetchOrders:h,fetchOrder:async a=>{n&&n.abort(),n=new AbortController,s.value=!0,l.value=null;try{const t=await v(`/affiliate/orders/${a}`,{signal:n.signal});if(t.success)d.value=t.data;else throw new Error(t.message||"Failed to fetch order")}catch(t){t.name!=="AbortError"&&(l.value=t.message||"An error occurred while fetching the order",console.error("Error fetching affiliate order:",t))}finally{s.value=!1,n=null}},updateFilters:a=>{e.value={...e.value,...a}},resetFilters:()=>{e.value={q:"",status:[],boutique_id:"",date_from:"",date_to:"",sort:"created_at",dir:"desc",per_page:15}},clearCurrentOrder:()=>{d.value=null},getStatusColor:a=>({pending:"warning",confirmed:"info",sent:"primary",expedited:"purple",delivered:"success",canceled:"error",returned:"orange",delivery_failed:"error",paid:"success"})[a]||"secondary",getStatusLabel:a=>({pending:"En attente",confirmed:"Confirmée",sent:"Envoyée",expedited:"Expédiée",delivered:"Livrée",canceled:"Annulée",returned:"Retournée",delivery_failed:"Échec livraison",paid:"Payée"})[a]||a}});export{A as u};
