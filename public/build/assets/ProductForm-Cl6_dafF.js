import{d as Yt,k as Zt,u as ea,aL as ta,b8 as qe,r as P,ca as ke,V as R,w as ce,o as aa,ai as xe,c as f,b as u,e as a,g as l,f as n,m as z,v as s,n as i,t as p,az as V,aW as De,cU as lt,ac as F,h as k,F as Fe,j as Se,aU as oa,x as Ae}from"./main-DEzoUo6n.js";import{u as la}from"./produits-D-cmAcMa.js";import{u as ra}from"./boutiques-CLsxH67w.js";import{u as sa}from"./categories-CSoT2jwu.js";import{u as ia}from"./useNotifications-Bc6GUAmT.js";import{u as na}from"./useFormErrors-C8Y5_5Yb.js";import{useQuickConfirm as da}from"./useConfirmAction-lawnJ6WL.js";import{u as w}from"./useApi-czTV0ZEy.js";import{b as J,V as T,c as Ie}from"./VCard-BQBmQiQJ.js";import{V as M,b as ua}from"./VChip-BLx6lUDe.js";import{a as ca,V as Z,b as ma,c as ee}from"./VTabs-CxFrGzcq.js";import{V as Me}from"./VForm-rtEvNB7m.js";import{V as X,a as g}from"./VRow-CCKjjrNU.js";import{V as te}from"./VSelect-DRK_p5uX.js";import{V as U}from"./VTextField-BiqUvfe6.js";import{V as Le}from"./VTextarea-BfvN6PTe.js";import{V as va}from"./VField-BrxQSdNw.js";import{V as pa}from"./VDivider-96JDmIpb.js";import{V as rt}from"./VSwitch-B3ZPFjWQ.js";import{V as _a}from"./VRating-DDe1WMG9.js";import{V as Re}from"./VFileInput-4CKii6WE.js";import{V as Ce}from"./VImg-Dcm3Nb79.js";import{V as Oe}from"./VSpacer-om3XMluz.js";import{V as O}from"./VAlert--Qma1TSN.js";import{V as fa,a as ga,b as ba,d as ya}from"./VList-PlS4cpk2.js";import{V as ae}from"./VCardText-DtKfeQ8i.js";import{V as st}from"./VDataTable-CY4RDaZO.js";import{V as ha}from"./VTable-pKKqnQcU.js";import{V as ka}from"./VSnackbar-Br3eOTz2.js";import{_ as xa}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Va={class:"product-form"},wa={class:"text-h4 font-weight-bold"},Pa={key:0,class:"text-body-1 text-medium-emphasis mt-1"},Fa={class:"copywriting-field"},Sa={class:"rich-text-editor"},Ca={class:"editor-toolbar"},Ea={class:"text-caption text-medium-emphasis mt-1"},$a={key:0,class:"text-error text-caption mt-1"},za={class:"text-subtitle-2 mb-2"},Ua={class:"d-flex align-center justify-space-between"},Ta={class:"text-h6 text-success"},qa={class:"text-caption text-medium-emphasis"},Da={class:"text-caption"},Aa={class:"d-flex justify-space-between"},Ia={class:"d-flex justify-space-between"},Ma={class:"mb-6"},La={class:"text-h6 mb-2"},Ra={class:"text-body-2 text-medium-emphasis"},Oa={class:"mb-4"},Na={class:"text-subtitle-2 mb-2 d-block"},ja={key:0,class:"mb-3"},Ba={key:1,class:"mb-3"},Wa={key:2,class:"text-center py-4"},Ka={class:"text-body-2 text-medium-emphasis"},Ha={key:0,class:"text-center py-12"},Ja={class:"text-h6 mb-2"},Xa={class:"text-body-2 text-medium-emphasis"},Qa={key:1},Ga={class:"mb-6"},Ya={class:"text-h6 mb-2"},Za={class:"text-body-2 text-medium-emphasis"},eo={key:0,class:"text-center py-12"},to={class:"text-h6 mb-2"},ao={class:"text-body-2 text-medium-emphasis"},oo={key:1},lo={class:"mb-6"},ro={class:"text-h6 mb-2"},so={class:"text-body-2 text-medium-emphasis"},io={class:"mb-6"},no={key:0,class:"mb-6"},uo={key:1,class:"mb-6"},co={key:2},mo={class:"text-subtitle-1 mb-4"},vo={key:0,class:"text-center py-12"},po={class:"text-h6 mb-2"},_o={class:"text-body-2 text-medium-emphasis"},fo={key:1},go={class:"mb-6"},bo={class:"text-h6 mb-2"},yo={class:"text-body-2 text-medium-emphasis"},ho={class:"d-flex align-center gap-4"},ko={key:0},xo={class:"text-subtitle-1 mb-4"},Vo={class:"font-weight-medium"},wo={key:0,class:"text-caption text-medium-emphasis"},Po={class:"font-weight-medium"},Fo={key:0,class:"text-caption text-medium-emphasis"},So={class:"d-flex align-center gap-2"},Co={key:1,class:"text-caption text-medium-emphasis"},Eo={key:0,class:"text-center py-12"},$o={class:"text-h6 mb-2"},zo={class:"text-body-2 text-medium-emphasis"},Uo={key:1},To={class:"d-flex justify-space-between align-center"},qo={class:"d-flex gap-2"},Do={key:0,class:"text-center py-8"},Ao={class:"text-body-2 text-medium-emphasis mt-2"},Io={key:1,class:"text-center py-8"},Mo={class:"text-body-2 text-medium-emphasis"},Lo={key:2},Ro={class:"d-flex justify-space-between align-center"},Oo={key:0,class:"d-flex align-center"},No={key:1,class:"text-medium-emphasis"},jo={key:0,class:"font-weight-medium"},Bo={key:1,class:"text-medium-emphasis"},Wo={class:"text-medium-emphasis"},Ko={class:"font-weight-medium"},Ho={colspan:"2",class:"font-weight-bold"},Jo={class:"font-weight-bold"},Xo={class:"font-weight-bold"},Qo={class:"text-medium-emphasis"},Go={class:"text-medium-emphasis"},Yo={key:0,class:"text-center py-12"},Zo={class:"text-h6 mb-2"},el={class:"text-body-2 text-medium-emphasis"},tl={key:1},al={class:"mb-6"},ol={class:"text-h6 mb-2"},ll={class:"text-body-2 text-medium-emphasis"},rl={class:"mb-2"},sl={key:0,class:"mt-2"},il={key:1,class:"mt-2"},nl={key:0,class:"text-center py-12"},dl={class:"text-h6 mb-2"},ul={class:"text-body-2 text-medium-emphasis"},cl={key:1},ml={class:"mb-6"},vl={class:"text-h6 mb-2"},pl={class:"text-body-2 text-medium-emphasis"},_l={key:0},fl={key:1,class:"text-medium-emphasis"},gl=Yt({__name:"ProductForm",props:{mode:{},id:{}},emits:["created","updated"],setup(it,{emit:nt}){const B=it,Ne=nt,je=Zt(),dt=ea(),{t:d}=ta(),{showSuccess:C,showError:_,snackbar:me}=ia(),{confirmCreate:ne,confirmUpdate:Be,confirmDelete:ve}=da(),pe=la(),We=ra(),Ke=sa(),{items:ut}=qe(We),{categories:ct}=qe(Ke),{currentProduit:W,images:Q,videos:oe,variantes:E}=qe(pe),_e=P(dt.query.tab||"details"),le=P(!1),Ve=P(!1),v=P(B.mode==="edit"&&B.id||null);P(!0);const de=P(!1);P(null);const m=P({boutique_id:"",categorie_id:null,titre:"",sku:"",description:"",copywriting:"",prix_achat:null,prix_vente:null,quantite_min:1,notes_admin:"",actif:!0,rating_value:null,stock_total:null,stock_fake:null}),{errors:D,set:mt,clear:He}=na(),re=P([]),q=ke({titre:"",description:"",type:""}),G=P([]),$=ke({variante_id:null,motif:"",started_at:"",expected_restock_at:""}),Y=ke({variante_id:[],motif:[],started_at:[],expected_restock_at:[]}),se=P("url"),we=P(""),fe=P(""),h=ke({attribut_id:"",valeur_id:"",valeur_ids:[],nom:"",valeur:"",prix_vente_variante:null}),Pe=P(!1),Je=P([]),ge=P([]),Xe=P(!1),Qe=P(!1),b=ke({stock_total:0,allocations:[],warehouse_id:null}),K=P([]),S=P([]),Ee=P(!1),$e=P(!1),N=R(()=>S.value.reduce((o,t)=>o+(t.qty||0),0)),Ge=R(()=>S.value.reduce((o,t)=>o+(t.reserved||0),0)),vt=R(()=>N.value-Ge.value),Ye=R(()=>b.stock_total!==N.value),H=R(()=>N.value>b.stock_total);R(()=>!H.value&&b.stock_total>0&&N.value>0);const A=R(()=>!!v.value),be=R(()=>B.mode==="edit"),pt=R(()=>be.value?"Edit Product":"Create Product"),Ze=R(()=>!m.value.prix_vente||!m.value.prix_achat?0:Math.max(0,m.value.prix_vente-m.value.prix_achat));R(()=>Ze.value);const _t=o=>{if(console.debug("[ProductForm] getVariantDisplayName called with:",o),console.debug("[ProductForm] Available variants:",E.value),!o)return"All variants";const t=E.value.find(e=>e.id===o);return console.debug("[ProductForm] Found variant:",t),t?`${t.nom||"Unknown"}: ${t.valeur||"Unknown"}`:"Unknown variant"},ft=async()=>{await Promise.all([We.fetchBoutiques(),Ke.fetchCategories()])},gt=async()=>{if(B.mode==="edit"&&B.id){le.value=!0;try{if(await pe.fetchProduit(B.id),W.value){const o=W.value;console.log("[ProductForm] Loading product data:",{id:o.id,titre:o.titre,stock_total:o.stock_total,quantite_min:o.quantite_min,notes_admin:o.notes_admin}),m.value={boutique_id:o.boutique_id,categorie_id:o.categorie_id,titre:o.titre,sku:o.sku||"",description:o.description||"",copywriting:o.copywriting||"",prix_achat:o.prix_achat,prix_vente:o.prix_vente,quantite_min:o.quantite_min||1,notes_admin:o.notes_admin||"",actif:o.actif,rating_value:o.rating_value||null,stock_total:o.stock_total||null,stock_fake:o.stock_fake||null},console.log("[ProductForm] Form data after loading:",{stock_total:m.value.stock_total,quantite_min:m.value.quantite_min}),xe(()=>{Lt()}),v.value=o.id,console.debug("[ProductForm] Edit mode - variants loaded:",E.value.map(t=>({id:t.id,nom:t.nom,valeur:t.valeur,image_url:t.image_url}))),await tt(),await Vt(),await Jt(),await xe(),de.value=!1}}catch(o){_("Failed to load product"),console.error("Error loading product:",o)}finally{le.value=!1}}},et=async()=>{if(console.debug("[ProductForm] saveProduct called, mode:",B.mode,"localId:",v.value),Ve.value){console.debug("[ProductForm] Save already in progress, ignoring");return}if(!m.value.titre.trim()){_("Product title is required");return}if(!m.value.boutique_id){_("Boutique selection is required");return}try{console.debug("[ProductForm] Showing confirm dialog...");const o=B.mode==="create"&&!v.value?await ne("product"):await Be("product",m.value.titre);if(console.debug("[ProductForm] Confirm dialog result:",o),!o)return}catch(o){console.error("[ProductForm] Error in confirm dialog:",o);return}Ve.value=!0;try{if(console.debug("[ProductForm] Form data before save:",m.value),B.mode==="create"&&!v.value){console.debug("[ProductForm] Creating new product");const o=await pe.createProduit(m.value);v.value=o.id,console.debug("[ProductForm] Created product with ID:",o.id),await pe.fetchProduit(o.id),console.debug("[ProductForm] Fetched product data, images:",Q.value.length,"videos:",oe.value.length,"variants:",E.value.length),console.debug("[ProductForm] Variants with images:",E.value.map(t=>({id:t.id,nom:t.nom,valeur:t.valeur,image_url:t.image_url}))),Ne("created",o),_e.value="images",je.replace(`/admin/produits/${o.id}/edit?tab=images`),He(),C("Product created successfully")}else if(v.value){console.debug("[ProductForm] Updating product with ID:",v.value);const o=await pe.updateProduit(v.value,m.value);Ne("updated",o),He(),C("Product updated successfully"),de.value=!1,await Rt()}else console.error("[ProductForm] Invalid state: create mode but no localId and no create action"),_("Invalid form state")}catch(o){o.errors?(mt(o.errors),_(o.message||"Validation failed"),console.error("Product validation error:",o)):(_(o.message||"Failed to save product"),console.error("Error saving product:",o))}finally{Ve.value=!1}},bt=()=>{je.push({name:"admin-produits"})},yt=()=>{m.value.rating_value!==null&&m.value.rating_value!==void 0&&(m.value.rating_value=Math.max(0,Math.min(5,Number(m.value.rating_value))),m.value.rating_value=Math.round(m.value.rating_value*10)/10)},j=P();ce(()=>m.value.copywriting,async o=>{await xe(),j.value&&j.value.innerHTML!==o&&(j.value.innerHTML=o||"")},{immediate:!0}),ce(()=>b.warehouse_id,o=>{o&&A.value&&ye()});const ue=o=>{var t;document.execCommand(o,!1,""),(t=j.value)==null||t.focus()},ze=o=>document.queryCommandState(o),Ue=o=>{var r;const t={small:"12px",normal:"14px",large:"18px"};document.execCommand("fontSize",!1,"7");const e=document.getElementsByTagName("font");for(let c=0;c<e.length;c++)e[c].size==="7"&&(e[c].removeAttribute("size"),e[c].style.fontSize=t[o]);(r=j.value)==null||r.focus()},ht=o=>{const t=o.target;m.value.copywriting=t.innerHTML,le.value||(de.value=!0)},tt=async()=>{await xe(),j.value&&(j.value.innerHTML=m.value.copywriting||"")},kt=o=>{o.ctrlKey&&o.key==="b"&&(o.preventDefault(),ue("bold")),o.ctrlKey&&o.key==="i"&&(o.preventDefault(),ue("italic")),o.ctrlKey&&o.key==="u"&&(o.preventDefault(),ue("underline"))},xt=o=>new Date(o).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Vt=async()=>{if(v.value)try{const{data:o,error:t}=await w(`/admin/produits/${v.value}/propositions`);if(!t.value&&o.value){const e=o.value;e.success&&(re.value=e.data)}}catch(o){console.error("Error loading propositions:",o)}},wt=async o=>{if(!v.value){console.warn("[ProductForm] Cannot upload images: no product ID");return}console.debug("[ProductForm] [productId] add-image:",v.value);const t=Array.from(o);for(const e of t){const r=new FormData;r.append("file",e);try{const{data:c,error:y}=await w(`/admin/produits/${v.value}/images/upload`,{method:"POST",body:r});if(y.value)console.error("Image upload error details:",y.value),_(y.value.message||"Failed to upload image"),console.error("Image upload error:",y.value);else if(c.value){const x=c.value;x.success&&(Q.value.push(x.data),console.debug("[ProductForm] Image uploaded successfully, total images:",Q.value.length))}}catch(c){console.error("Error uploading image:",c),_(c.message||"Failed to upload image")}}},Pt=async o=>{if(!(!v.value||!await ve("image","cette image")))try{const{error:e}=await w(`/admin/produits/${v.value}/images/${o}`,{method:"DELETE"});if(e.value)_(e.value.message||"Failed to delete image"),console.error("Delete image error:",e.value);else{const r=Q.value.findIndex(c=>c.id===o);r>-1&&(Q.value.splice(r,1),C("Image deleted successfully"))}}catch(e){console.error("Error deleting image:",e),_(e.message||"Failed to delete image")}},Ft=async()=>{if(!v.value||!fe.value){console.warn("[ProductForm] Cannot add video URL: missing product ID or URL");return}if(await ne("vidéo")){console.debug("[ProductForm] [productId] add-video-url:",v.value);try{const{data:t,error:e}=await w(`/admin/produits/${v.value}/videos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:fe.value,titre:we.value})});if(e.value)_(e.value.message||"Failed to add video"),console.error("Add video URL error:",e.value);else if(t.value){const r=t.value;r.success&&(oe.value.push(r.data),fe.value="",we.value="",C("Video added successfully"))}}catch(t){console.error("Error adding video URL:",t),_(t.message||"Failed to add video")}}},St=async o=>{if(!v.value){console.warn("[ProductForm] Cannot upload videos: no product ID");return}console.debug("[ProductForm] [productId] add-video-upload:",v.value);const t=Array.from(o);for(const e of t){const r=new FormData;r.append("file",e);try{const{data:c,error:y}=await w(`/admin/produits/${v.value}/videos/upload`,{method:"POST",body:r});if(y.value)_(y.value.message||"Failed to upload video"),console.error("Video upload error:",y.value);else if(c.value){const x=c.value;x.success&&(oe.value.push(x.data),C("Video uploaded successfully"))}}catch(c){console.error("Error uploading video:",c),_(c.message||"Failed to upload video")}}},Ct=async o=>{if(!(!v.value||!await ve("vidéo","cette vidéo")))try{const{error:e}=await w(`/admin/produits/${v.value}/videos/${o}`,{method:"DELETE"});if(e.value)_(e.value.message||"Failed to delete video"),console.error("Delete video error:",e.value);else{const r=oe.value.findIndex(c=>c.id===o);r>-1&&(oe.value.splice(r,1),C("Video deleted successfully"))}}catch(e){console.error("Error deleting video:",e),_(e.message||"Failed to delete video")}},Et=async()=>{try{Xe.value=!0;const{data:o,error:t}=await w("/admin/variant-attributs?actif=1");if(!t.value&&o.value){const e=o.value;e.success&&(Je.value=e.data)}}catch(o){console.error("Error fetching variant attributes:",o)}finally{Xe.value=!1}},$t=async o=>{try{Qe.value=!0;const{data:t,error:e}=await w(`/admin/variant-attributs/${o}/valeurs?actif=1`);if(!e.value&&t.value){const r=t.value;r.success&&(ge.value=r.data)}}catch(t){console.error("Error fetching variant values:",t)}finally{Qe.value=!1}},zt=()=>{h.valeur_id="",h.valeur_ids=[],ge.value=[],h.attribut_id&&$t(h.attribut_id)},Ut=async()=>{if(!v.value||!h.attribut_id||!h.valeur_id){console.warn("[ProductForm] Cannot add variant: missing product ID, attribute, or value");return}if(await ne("variante")){console.debug("[ProductForm] [productId] add-variant:",v.value);try{const{data:t,error:e}=await w(`/admin/produits/${v.value}/variantes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attribut_id:h.attribut_id,valeur_id:h.valeur_id,prix_vente_variante:h.prix_vente_variante,actif:!0})});if(e.value)_(e.value.message||"Failed to add variant"),console.error("Add variant error:",e.value);else if(t.value){const r=t.value;r.success&&(E.value.push(r.data),at(),C("Variant added successfully"))}}catch(t){console.error("Error adding variant:",t),_(t.message||"Failed to add variant")}}},Tt=async()=>{if(!v.value||!h.attribut_id||!h.valeur_ids.length){console.warn("[ProductForm] Cannot add variants: missing product ID, attribute, or values");return}if(await ne(`${h.valeur_ids.length} variantes`)){console.debug("[ProductForm] [productId] add-variants-bulk:",v.value,h.valeur_ids);try{const{data:t,error:e}=await w(`/admin/produits/${v.value}/variantes/bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attribut_id:h.attribut_id,valeur_ids:h.valeur_ids,prix_vente_variante:h.prix_vente_variante,actif:!0})});if(e.value)_(e.value.message||"Failed to add variants"),console.error("Add variants bulk error:",e.value);else if(t.value){const r=t.value;r.success&&(r.data.created&&E.value.push(...r.data.created),at(),C(r.message||"Variants added successfully"),r.data.skipped&&r.data.skipped.length>0&&console.info("Skipped variants:",r.data.skipped))}}catch(t){console.error("Error adding variants bulk:",t),_(t.message||"Failed to add variants")}}},at=()=>{Object.assign(h,{attribut_id:"",valeur_id:"",valeur_ids:[],nom:"",valeur:"",prix_vente_variante:null}),ge.value=[]},qt=async o=>{if(!(!v.value||!await ve("variante","cette variante")))try{const{error:e}=await w(`/admin/produits/${v.value}/variantes/${o}`,{method:"DELETE"});if(e.value)_(e.value.message||"Failed to delete variant"),console.error("Delete variant error:",e.value);else{const r=E.value.findIndex(c=>c.id===o);r>-1&&(E.value.splice(r,1),C("Variant deleted successfully"))}}catch(e){console.error("Error deleting variant:",e),_(e.message||"Failed to delete variant")}},Dt=async(o,t)=>{if(!v.value||!t){console.warn("[ProductForm] Cannot upload variant image: missing product ID or file",{localId:v.value,file:t});return}console.debug("[ProductForm] [productId] upload-variant-image:",v.value,o,"file:",t.name,"size:",t.size);const e=new FormData;e.append("file",t);try{const{data:r,error:c}=await w(`/admin/produits/${v.value}/variantes/${o}/image`,{method:"POST",body:e});if(console.debug("[ProductForm] Upload response:",{data:r.value,error:c.value}),!c.value&&r.value){const y=r.value;if(y.success){const x=E.value.find(L=>L.id===o);x&&(x.image_url=y.data.image_url,console.debug("[ProductForm] Variant image updated:",x.image_url),C("Variant image uploaded successfully"))}else console.error("[ProductForm] Upload failed:",y.message),_(y.message||"Failed to upload variant image")}else console.error("[ProductForm] API error:",c.value),_("Failed to upload variant image")}catch(r){console.error("Error uploading variant image:",r),_("Failed to upload variant image")}},ot=async()=>{try{const o=m.value.boutique_id?`?boutique_id=${m.value.boutique_id}`:"",{data:t,error:e}=await w(`/admin/warehouses${o}`);if(e.value){console.error("Failed to load warehouses:",e.value),_("Failed to load warehouses");return}const r=t.value;if(r!=null&&r.success){if(K.value=r.data,console.log("[ProductForm] Loaded warehouses for boutique:",m.value.boutique_id),console.log("[ProductForm] Warehouses:",K.value.map(c=>({id:c.id,name:c.name,boutique:c.boutique}))),!b.warehouse_id&&K.value.length>0){const c=K.value.find(y=>y.is_default)||K.value[0];b.warehouse_id=c.id,console.log("Set default warehouse:",c.id)}}else console.error("Invalid warehouse response:",r),_("Invalid warehouse data received")}catch(o){console.error("Exception loading warehouses:",o),_("Error loading warehouses")}},ye=async()=>{var o;if(v.value){Ee.value=!0;try{const t=b.warehouse_id?`?warehouse_id=${b.warehouse_id}`:"",{data:e,error:r}=await w(`/admin/produits/${v.value}/stock/matrix${t}`);if(r.value){if(console.error("Stock matrix API error:",r.value),(o=r.value.message)!=null&&o.includes("Warehouse not found")){if(console.log("Warehouse not found, trying to load warehouses and retry..."),await ot(),b.warehouse_id){const y=`?warehouse_id=${b.warehouse_id}`,{data:x,error:L}=await w(`/admin/produits/${v.value}/stock/matrix${y}`);if(!L.value&&x.value){const ie=x.value;if(ie!=null&&ie.success){S.value=ie.data.matrix||[],console.log("Stock matrix loaded successfully on retry");return}}}_("Warehouse not found. Please check warehouse configuration.")}else _("Failed to load stock matrix: "+(r.value.message||"Unknown error"));S.value=[];return}const c=e.value;c!=null&&c.success?(S.value=c.data.matrix||[],console.log("Stock matrix loaded:",S.value.length,"items"),c.data.warehouse&&!b.warehouse_id&&(b.warehouse_id=c.data.warehouse.id,console.log("Updated warehouse from response:",c.data.warehouse.id))):(console.error("Invalid stock matrix response:",c),S.value=[])}catch(t){console.error("Exception loading stock matrix:",t),S.value=[],_("Error loading stock matrix")}finally{Ee.value=!1}}},At=(o,t)=>{const e=S.value.find(r=>r.variante_id===o);e&&(e.qty=Number(t)||0,e.available=Math.max(0,e.qty-e.reserved))},It=()=>{if(!b.stock_total||!S.value.length)return;const o=Math.floor(b.stock_total/S.value.length),t=b.stock_total%S.value.length;S.value.forEach((e,r)=>{const c=o+(r===0?t:0);e.qty=c,e.available=Math.max(0,c-e.reserved)}),C("Stock distributed across variant combinations")},Mt=async()=>{if(v.value){$e.value=!0;try{const{data:o,error:t}=await w(`/admin/produits/${v.value}/stock/generate-combinations`,{method:"POST"}),e=o.value;e!=null&&e.success?(C(d("combinations_created_success",{count:e.data.created})),await ye()):t.value&&_("Erreur lors de la génération des combinaisons")}catch(o){console.error("Failed to generate combinations:",o),_("Erreur inattendue lors de la génération des combinaisons")}finally{$e.value=!1}}},Lt=async()=>{console.log("[ProductForm] Initializing stock form with stock_total:",m.value.stock_total),console.log("[ProductForm] Current stockForm.stock_total before sync:",b.stock_total),b.stock_total=m.value.stock_total||0,console.log("[ProductForm] stockForm.stock_total after sync:",b.stock_total),await ot(),await ye()},Rt=async()=>{var e,r,c,y;if(!v.value)return;const o=b.stock_total!==(m.value.stock_total||0),t=S.value.some(x=>x.qty>0);if(!o&&!t){console.log("No stock changes detected, skipping allocation");return}if(H.value){_(`Impossible de sauvegarder : La somme des variantes (${N.value}) dépasse le stock total (${b.stock_total})`);return}if(!(Ye.value&&!H.value&&!await Be("Différence de stock détectée",`Le stock total (${b.stock_total}) ne correspond pas à la somme des variantes (${N.value}). Voulez-vous continuer quand même ?`)))try{const x=new Map;S.value.filter(I=>I.variante_id&&I.qty>0).forEach(I=>{const Te=x.get(I.variante_id)||0;x.set(I.variante_id,Te+I.qty)});const L=Array.from(x.entries()).map(([I,Te])=>({variante_id:I,qty:Te}));console.log("Stock allocation data:",{stock_total:b.stock_total,allocations_count:L.length,warehouse_id:b.warehouse_id});const{data:ie,error:he}=await w(`/admin/produits/${v.value}/stock/allocate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({stock_total:b.stock_total,allocations:L,warehouse_id:b.warehouse_id})});if(he.value){let I="Erreur lors de l'allocation du stock";(e=he.value.message)!=null&&e.includes("No warehouse found")?I=d("product.stock.error_no_warehouse"):(r=he.value.message)!=null&&r.includes("Some variant IDs are invalid")?I=d("product.stock.error_invalid_variants"):((c=he.value.message)!=null&&c.includes("SQLSTATE")||(y=he.value.message)!=null&&y.includes("Column not found"))&&(I=d("product.stock.error_database")),_(I)}else ie.value&&ie.value.success&&(C(d("product.stock.save_success")),m.value.stock_total=b.stock_total,await ye())}catch{_("Erreur inattendue lors de l'allocation du stock")}},Ot=async o=>{if(v.value)try{const{data:t,error:e}=await w(`/admin/produits/${v.value}/propositions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(e.value)_(e.value.message||"Failed to add proposition"),console.error("Add proposition error:",e.value);else if(t.value){const r=t.value;if(r.success)return re.value.push(r.data),C("Proposition added successfully"),r.data}}catch(t){console.error("Error adding proposition:",t),_(t.message||"Failed to add proposition")}},Nt=async o=>{if(v.value)try{const{error:t}=await w(`/admin/produits/${v.value}/propositions/${o}`,{method:"DELETE"});if(!t.value){const e=re.value.findIndex(r=>r.id===o);e>-1&&(re.value.splice(e,1),C("Proposition deleted successfully"))}}catch(t){console.error("Error deleting proposition:",t),_("Failed to delete proposition")}},jt=async(o,t)=>{if(!v.value||!t){console.warn("[ProductForm] Cannot upload proposition image: missing product ID or file",{localId:v.value,file:t});return}console.debug("[ProductForm] [productId] upload-proposition-image:",v.value,o,"file:",t.name,"size:",t.size);const e=new FormData;e.append("file",t);try{const{data:r,error:c}=await w(`/admin/produits/${v.value}/propositions/${o}/image`,{method:"POST",body:e});if(console.debug("[ProductForm] Proposition upload response:",{data:r.value,error:c.value}),!c.value&&r.value){const y=r.value;if(y.success){const x=re.value.find(L=>L.id===o);x&&(x.image_url=y.data.image_url,console.debug("[ProductForm] Proposition image updated:",x.image_url),C("Proposition image uploaded successfully"))}else console.error("[ProductForm] Proposition upload failed:",y.message),_(y.message||"Failed to upload proposition image")}else console.error("[ProductForm] Proposition API error:",c.value),_("Failed to upload proposition image")}catch(r){console.error("Error uploading proposition image:",r),_("Failed to upload proposition image")}},Bt=async()=>{if(!q.titre||!q.description||!q.type||!await ne("proposition"))return;await Ot(q)&&Object.assign(q,{titre:"",description:"",type:""})},Wt=async o=>{await ve("proposition","cette proposition")&&await Nt(o)},Kt=o=>{const t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=async e=>{var c;const r=(c=e.target.files)==null?void 0:c[0];r&&await jt(o,r)},t.click()},Ht=o=>{switch(o){case"en_attente":return"warning";case"approuve":return"success";case"refuse":return"error";default:return"grey"}},Jt=async()=>{if(v.value)try{const{data:o,error:t}=await w(`/admin/produits/${v.value}/ruptures`);if(!t.value&&o.value){const e=o.value;e.success&&(console.debug("[ProductForm] Loaded ruptures:",e.data),G.value=e.data)}}catch(o){console.error("Error loading ruptures:",o)}},Xt=async()=>{if(!v.value){console.warn("[ProductForm] Cannot add rupture: no product ID");return}if(await ne("rupture de stock")){if(Object.keys(Y).forEach(t=>{Y[t]=[]}),!$.motif){Y.motif=["Reason is required"];return}if(!$.started_at){Y.started_at=["Started date is required"];return}if(E.value.length>0&&!$.variante_id){Y.variante_id=["Variant selection is required when product has variants"];return}console.debug("[ProductForm] [productId] add-rupture:",v.value,{hasVariants:E.value.length>0,selectedVariant:$.variante_id});try{const{data:t,error:e}=await w(`/admin/produits/${v.value}/ruptures`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(e.value){e.value.errors&&Object.keys(e.value.errors).forEach(r=>{r in Y&&(Y[r]=e.value.errors[r])}),_(e.value.message||"Failed to report stock issue"),console.error("Add rupture error:",e.value);return}if(t.value){const r=t.value;r.success&&(console.debug("[ProductForm] Added rupture response:",r.data),G.value.push(r.data),Object.assign($,{variante_id:null,motif:"",started_at:"",expected_restock_at:""}),C("Stock issue reported successfully"))}}catch(t){console.error("Error adding rupture:",t),_(t.message||"Failed to report stock issue")}}},Qt=async o=>{if(v.value)try{const{data:t,error:e}=await w(`/admin/produits/${v.value}/ruptures/${o}/resolve`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.value&&t.value){const r=t.value;if(r.success){const c=G.value.findIndex(y=>y.id===o);c>-1&&(G.value[c]=r.data),C("Stock issue resolved successfully")}}}catch(t){console.error("Error resolving rupture:",t),_("Failed to resolve stock issue")}},Gt=async o=>{if(!(!v.value||!await ve("rupture de stock","cette rupture de stock")))try{const{error:e}=await w(`/admin/produits/${v.value}/ruptures/${o}`,{method:"DELETE"});if(!e.value){const r=G.value.findIndex(c=>c.id===o);r>-1&&(G.value.splice(r,1),C("Stock issue deleted successfully"))}}catch(e){console.error("Error deleting rupture:",e),_("Failed to delete stock issue")}};return ce(m,()=>{le.value||(de.value=!0)},{deep:!0}),ce(()=>m.value.copywriting,()=>{le.value||(de.value=!0)}),ce(()=>m.value.stock_total,o=>{!le.value&&o!==b.stock_total&&(console.log("Syncing stock_total from main form to stock form:",o),b.stock_total=o||0)}),ce(()=>b.stock_total,o=>{!le.value&&o!==m.value.stock_total&&(console.log("Syncing stock_total from stock form to main form:",o),m.value.stock_total=o,de.value=!0)}),aa(async()=>{await ft(),await gt(),await Et(),await xe(),j.value&&m.value.copywriting&&(j.value.innerHTML=m.value.copywriting)}),(o,t)=>(u(),f("div",Va,[a(T,{class:"mb-6"},{default:l(()=>[a(J,{class:"d-flex align-center justify-space-between pa-6"},{default:l(()=>[n("div",null,[n("h1",wa,s(pt.value),1),be.value&&i(W)?(u(),f("p",Pa,s(i(W).titre),1)):z("",!0)]),a(M,{color:be.value?"primary":"success",variant:"tonal",size:"large"},{default:l(()=>[p(s(be.value?"Edit Mode":"Create Mode"),1)]),_:1},8,["color"])]),_:1})]),_:1}),a(T,null,{default:l(()=>[a(ca,{modelValue:_e.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_e.value=e),"bg-color":"grey-lighten-4",color:"primary",grow:""},{default:l(()=>[a(Z,{value:"details"},{default:l(()=>[a(V,{icon:"tabler-info-circle",class:"me-2"}),p(" "+s(i(d)("product_details")),1)]),_:1}),a(Z,{value:"notation"},{default:l(()=>[a(V,{icon:"tabler-star",class:"me-2"}),p(" "+s(o.$t("products.rating.tab")),1)]),_:1}),a(Z,{disabled:!A.value,value:"images"},{default:l(()=>[a(V,{icon:"tabler-photo",class:"me-2"}),p(" "+s(i(d)("product_images")),1)]),_:1},8,["disabled"]),a(Z,{disabled:!A.value,value:"videos"},{default:l(()=>[a(V,{icon:"tabler-video",class:"me-2"}),p(" "+s(i(d)("product_videos")),1)]),_:1},8,["disabled"]),a(Z,{disabled:!A.value,value:"variants"},{default:l(()=>[a(V,{icon:"tabler-versions",class:"me-2"}),p(" "+s(i(d)("product_variants")),1)]),_:1},8,["disabled"]),a(Z,{disabled:!A.value,value:"stock"},{default:l(()=>[a(V,{icon:"tabler-package",class:"me-2"}),p(" "+s(o.$t("product.tabs.stock")),1)]),_:1},8,["disabled"]),a(Z,{disabled:!A.value,value:"propositions"},{default:l(()=>[a(V,{icon:"tabler-list-details",class:"me-2"}),p(" "+s(i(d)("product_propositions")),1)]),_:1},8,["disabled"]),a(Z,{disabled:!A.value,value:"ruptures"},{default:l(()=>[a(V,{icon:"tabler-alert-triangle",class:"me-2"}),p(" "+s(i(d)("product_stock_issues")),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),a(Me,{onSubmit:De(et,["prevent"])},{default:l(()=>[a(ma,{modelValue:_e.value,"onUpdate:modelValue":t[39]||(t[39]=e=>_e.value=e),class:"pa-6"},{default:l(()=>[a(ee,{value:"details"},{default:l(()=>[a(X,null,{default:l(()=>[a(g,{cols:"12",md:"6"},{default:l(()=>[a(te,{modelValue:m.value.boutique_id,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value.boutique_id=e),items:i(ut),"item-title":"nom","item-value":"id",label:"Boutique",variant:"outlined",required:"","error-messages":i(D).boutique_id},null,8,["modelValue","items","error-messages"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(te,{modelValue:m.value.categorie_id,"onUpdate:modelValue":t[2]||(t[2]=e=>m.value.categorie_id=e),items:i(ct),"item-title":"nom","item-value":"id",label:"Categorie",variant:"outlined",clearable:"","error-messages":i(D).categorie_id},null,8,["modelValue","items","error-messages"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[a(U,{modelValue:m.value.titre,"onUpdate:modelValue":t[3]||(t[3]=e=>m.value.titre=e),label:"Product Title",variant:"outlined",required:"","error-messages":i(D).titre},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:m.value.sku,"onUpdate:modelValue":t[4]||(t[4]=e=>m.value.sku=e),label:"SKU (Stock Keeping Unit)",variant:"outlined",placeholder:"e.g., PROD-001, SKU-ABC123","error-messages":i(D).sku,hint:"Unique product identifier (optional)","persistent-hint":""},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12",md:"6"}),a(g,{cols:"12"},{default:l(()=>[a(Le,{modelValue:m.value.description,"onUpdate:modelValue":t[5]||(t[5]=e=>m.value.description=e),label:"Description",variant:"outlined",rows:"4","error-messages":i(D).description},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[n("div",Fa,[a(va,{class:"mb-2"},{default:l(()=>t[41]||(t[41]=[p("Copywriting (Marketing Text with Rich Formatting)")])),_:1,__:[41]}),n("div",Sa,[n("div",Ca,[a(lt,{variant:"outlined",size:"small",class:"mb-2"},{default:l(()=>[a(F,{onClick:t[6]||(t[6]=e=>ue("bold")),color:ze("bold")?"primary":"default",icon:"tabler-bold",size:"small"},null,8,["color"]),a(F,{onClick:t[7]||(t[7]=e=>ue("italic")),color:ze("italic")?"primary":"default",icon:"tabler-italic",size:"small"},null,8,["color"]),a(F,{onClick:t[8]||(t[8]=e=>ue("underline")),color:ze("underline")?"primary":"default",icon:"tabler-underline",size:"small"},null,8,["color"])]),_:1}),a(lt,{variant:"outlined",size:"small",class:"mb-2 ms-2"},{default:l(()=>[a(F,{onClick:t[9]||(t[9]=e=>Ue("small")),size:"small",text:"A",style:{"font-size":"12px"}}),a(F,{onClick:t[10]||(t[10]=e=>Ue("normal")),size:"small",text:"A",style:{"font-size":"14px"}}),a(F,{onClick:t[11]||(t[11]=e=>Ue("large")),size:"small",text:"A",style:{"font-size":"16px"}})]),_:1})]),n("div",{ref_key:"richTextEditor",ref:j,class:"rich-text-content",contenteditable:"true",onInput:ht,onKeydown:kt,onFocus:tt,placeholder:`🌸 جديد عندنا 🌸

كسوة صيفية بنقشة مميزة وراحة لا مثيل لها

✅ القماش: توب لولان
✅ المقاسات: L / XL / XXL / XXXL
💰 الثمن: غير بـ130 درهم😍

خلي الأناقة ديالك تبدا من هنا 💃`},s(m.value.copywriting),545)]),n("div",Ea,[a(V,{icon:"tabler-info-circle",size:"14",class:"me-1"}),t[42]||(t[42]=p(" Rich text editor with bold, italic, underline, and font size controls. Supports emojis and line breaks. "))]),i(D).copywriting?(u(),f("div",$a,s(i(D).copywriting),1)):z("",!0)])]),_:1}),a(g,{cols:"12",md:"4"},{default:l(()=>[a(U,{modelValue:m.value.prix_achat,"onUpdate:modelValue":t[12]||(t[12]=e=>m.value.prix_achat=e),modelModifiers:{number:!0},label:"Purchase Price",type:"number",variant:"outlined",step:"0.01",suffix:"MAD","error-messages":i(D).prix_achat},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12",md:"4"},{default:l(()=>[a(U,{modelValue:m.value.prix_vente,"onUpdate:modelValue":t[13]||(t[13]=e=>m.value.prix_vente=e),modelModifiers:{number:!0},label:"Sale Price",type:"number",variant:"outlined",step:"0.01",suffix:"MAD",required:"","error-messages":i(D).prix_vente},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12",md:"4"},{default:l(()=>[a(T,{variant:"outlined",class:"pa-4"},{default:l(()=>[n("div",za,s(i(d)("estimated_commission")),1),n("div",Ua,[n("div",null,[n("div",Ta,s(Ze.value.toFixed(2))+" MAD",1),n("div",qa,s(i(d)("sale_price_purchase_price")),1)]),a(V,{icon:"tabler-calculator",color:"success",size:"24"})]),a(pa,{class:"my-3"}),n("div",Da,[n("div",Aa,[n("span",null,s(i(d)("sale_price")),1),n("span",null,s(m.value.prix_vente||0)+" MAD",1)]),n("div",Ia,[n("span",null,s(i(d)("purchase_price")),1),n("span",null,s(m.value.prix_achat||0)+" MAD",1)])])]),_:1})]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:m.value.quantite_min,"onUpdate:modelValue":t[14]||(t[14]=e=>m.value.quantite_min=e),modelModifiers:{number:!0},label:"Minimum Quantity",type:"number",variant:"outlined",min:"1","error-messages":i(D).quantite_min},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:m.value.stock_fake,"onUpdate:modelValue":t[15]||(t[15]=e=>m.value.stock_fake=e),modelModifiers:{number:!0},label:"Stock Fictif (Affiché aux Affiliés)",type:"number",variant:"outlined",min:"0",suffix:"unités","error-messages":i(D).stock_fake,hint:"Stock affiché aux affiliés au lieu du stock réel","persistent-hint":""},null,8,["modelValue","error-messages"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(rt,{modelValue:m.value.actif,"onUpdate:modelValue":t[16]||(t[16]=e=>m.value.actif=e),label:"Active",color:"success"},null,8,["modelValue"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[a(Le,{modelValue:m.value.notes_admin,"onUpdate:modelValue":t[17]||(t[17]=e=>m.value.notes_admin=e),label:"Admin Notes",variant:"outlined",rows:"3","error-messages":i(D).notes_admin},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(ee,{value:"notation"},{default:l(()=>[n("div",Ma,[n("h3",La,s(o.$t("products.rating.tab")),1),n("p",Ra,s(o.$t("products.rating.help")),1)]),a(X,null,{default:l(()=>[a(g,{cols:"12",md:"6"},{default:l(()=>[a(T,{variant:"outlined",class:"pa-4"},{default:l(()=>[n("div",Oa,[n("label",Na,s(o.$t("products.rating.value")),1),a(_a,{"model-value":m.value.rating_value||0,"onUpdate:modelValue":t[18]||(t[18]=e=>m.value.rating_value=Number(e)||null),"half-increments":"",length:"5",color:"warning","background-color":"grey-lighten-2",size:"large",class:"mb-3"},null,8,["model-value"]),a(U,{modelValue:m.value.rating_value,"onUpdate:modelValue":t[19]||(t[19]=e=>m.value.rating_value=e),modelModifiers:{number:!0},type:"number",min:"0",max:"5",step:"0.1",variant:"outlined",density:"compact",label:o.$t("products.rating.value"),"error-messages":i(D).rating_value,onBlur:yt},null,8,["modelValue","label","error-messages"])])]),_:1})]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(T,{variant:"outlined",class:"pa-4"},{default:l(()=>{var e,r,c,y,x,L;return[t[43]||(t[43]=n("h4",{class:"text-subtitle-1 mb-3"},"Metadata",-1)),(r=(e=i(W))==null?void 0:e.rating)!=null&&r.updated_at?(u(),f("div",ja,[a(M,{size:"small",color:"info",variant:"tonal","prepend-icon":"tabler-clock"},{default:l(()=>[p(s(o.$t("products.rating.last_update"))+": "+s(xt(i(W).rating.updated_at)),1)]),_:1})])):z("",!0),(y=(c=i(W))==null?void 0:c.rating)!=null&&y.updated_by?(u(),f("div",Ba,[a(M,{size:"small",color:"primary",variant:"tonal","prepend-icon":"tabler-user"},{default:l(()=>[p(s(o.$t("products.rating.updated_by"))+": "+s(i(W).rating.updated_by),1)]),_:1})])):z("",!0),(L=(x=i(W))==null?void 0:x.rating)!=null&&L.updated_at?z("",!0):(u(),f("div",Wa,[a(V,{icon:"tabler-star-off",size:"48",color:"grey-lighten-1",class:"mb-2"}),n("p",Ka,s(i(d)("no_note_defined")),1)]))]}),_:1,__:[43]})]),_:1})]),_:1})]),_:1}),a(ee,{value:"images"},{default:l(()=>[A.value?(u(),f("div",Qa,[n("div",Ga,[n("h3",Ya,s(i(d)("product_images")),1),n("p",Za,s(i(d)("upload_images_description")),1)]),a(Re,{multiple:"","show-size":"",label:i(d)("upload_images"),accept:"image/*",variant:"outlined","prepend-icon":"tabler-upload",onChange:t[20]||(t[20]=e=>{var r;return wt(((r=e.target)==null?void 0:r.files)||e)})},null,8,["label"]),i(Q).length?(u(),k(X,{key:0,class:"mt-6"},{default:l(()=>[(u(!0),f(Fe,null,Se(i(Q),e=>(u(),k(g,{key:e.id,cols:"6",md:"3",lg:"2"},{default:l(()=>[a(T,null,{default:l(()=>[a(Ce,{src:e.url,"aspect-ratio":"1",cover:""},null,8,["src"]),a(Ie,null,{default:l(()=>[a(Oe),a(F,{icon:"tabler-trash",size:"small",color:"error",variant:"text",onClick:r=>Pt(e.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):z("",!0),i(Q).length?z("",!0):(u(),k(O,{key:1,type:"info",variant:"tonal",class:"mt-6"},{default:l(()=>[p(s(i(d)("no_images_uploaded_yet")),1)]),_:1}))])):(u(),f("div",Ha,[a(V,{icon:"tabler-photo-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),n("h3",Ja,s(i(d)("save_product_first")),1),n("p",Xa,s(i(d)("save_product_before_adding_images")),1)]))]),_:1}),a(ee,{value:"videos"},{default:l(()=>[A.value?(u(),f("div",oo,[n("div",lo,[n("h3",ro,s(i(d)("product_videos")),1),n("p",so,s(i(d)("add_videos_description")),1)]),n("div",io,[a(ua,{modelValue:se.value,"onUpdate:modelValue":t[21]||(t[21]=e=>se.value=e),"selected-class":"text-primary",mandatory:"",class:"mb-4"},{default:l(()=>[a(M,{value:"url",size:"large","prepend-icon":"tabler-link",color:se.value==="url"?"primary":"default",variant:se.value==="url"?"flat":"outlined",class:"me-2"},{default:l(()=>t[44]||(t[44]=[p(" Add by URL ")])),_:1,__:[44]},8,["color","variant"]),a(M,{value:"upload",size:"large","prepend-icon":"tabler-upload",color:se.value==="upload"?"primary":"default",variant:se.value==="upload"?"flat":"outlined"},{default:l(()=>t[45]||(t[45]=[p(" Upload Files ")])),_:1,__:[45]},8,["color","variant"])]),_:1},8,["modelValue"])]),se.value==="url"?(u(),f("div",no,[a(X,null,{default:l(()=>[a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:we.value,"onUpdate:modelValue":t[22]||(t[22]=e=>we.value=e),label:"Video Title",variant:"outlined",placeholder:"Enter video title"},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:fe.value,"onUpdate:modelValue":t[23]||(t[23]=e=>fe.value=e),label:"Video URL",variant:"outlined",placeholder:"https://youtube.com/watch?v=..."},null,8,["modelValue"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[a(F,{color:"primary","prepend-icon":"tabler-plus",onClick:Ft},{default:l(()=>t[46]||(t[46]=[p(" Add Video URL ")])),_:1,__:[46]})]),_:1})]),_:1})])):(u(),f("div",uo,[a(Re,{multiple:"","show-size":"",label:i(d)("upload_videos"),accept:"video/*",variant:"outlined","prepend-icon":"tabler-upload",onChange:t[24]||(t[24]=e=>{var r;return St(((r=e.target)==null?void 0:r.files)||e)})},null,8,["label"])])),i(oe).length?(u(),f("div",co,[n("h4",mo,s(i(d)("uploaded_videos")),1),a(fa,null,{default:l(()=>[(u(!0),f(Fe,null,Se(i(oe),e=>(u(),k(ga,{key:e.id},{append:l(()=>[a(F,{icon:"tabler-trash",size:"small",color:"error",variant:"text",onClick:r=>Ct(e.id)},null,8,["onClick"])]),default:l(()=>[a(ba,null,{default:l(()=>[p(s(e.titre||i(d)("untitled_video")),1)]),_:2},1024),a(ya,null,{default:l(()=>[p(s(e.url),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(u(),k(O,{key:3,type:"info",variant:"tonal"},{default:l(()=>[p(s(i(d)("no_videos_added_yet")),1)]),_:1}))])):(u(),f("div",eo,[a(V,{icon:"tabler-video-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),n("h3",to,s(i(d)("save_product_first")),1),n("p",ao,s(i(d)("save_product_before_adding_videos")),1)]))]),_:1}),a(ee,{value:"variants"},{default:l(()=>[A.value?(u(),f("div",fo,[n("div",go,[n("h3",bo,s(i(d)("product_variants")),1),n("p",yo,s(i(d)("create_variants_description")),1)]),a(T,{variant:"outlined",class:"mb-6"},{default:l(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:l(()=>[n("div",ho,[t[47]||(t[47]=n("span",null,"Add New Variant",-1)),a(rt,{modelValue:Pe.value,"onUpdate:modelValue":t[25]||(t[25]=e=>Pe.value=e),label:i(d)("multi_select"),color:"primary",density:"compact","hide-details":""},null,8,["modelValue","label"])]),a(F,{variant:"text",size:"small",color:"primary","prepend-icon":"tabler-settings",to:"/admin/variants/attributs",target:"_blank"},{default:l(()=>t[48]||(t[48]=[p(" Manage Catalog ")])),_:1,__:[48]})]),_:1}),a(ae,null,{default:l(()=>[a(X,null,{default:l(()=>[a(g,{cols:"12",md:"3"},{default:l(()=>[a(te,{modelValue:h.attribut_id,"onUpdate:modelValue":[t[26]||(t[26]=e=>h.attribut_id=e),zt],label:"Attribute",variant:"outlined",items:Je.value,"item-title":"nom","item-value":"id",placeholder:"Select attribute"},null,8,["modelValue","items"])]),_:1}),a(g,{cols:"12",md:"3"},{default:l(()=>[Pe.value?(u(),k(te,{key:1,modelValue:h.valeur_ids,"onUpdate:modelValue":t[28]||(t[28]=e=>h.valeur_ids=e),label:"Values",variant:"outlined",items:ge.value,"item-title":"libelle","item-value":"id",placeholder:"Select multiple values",disabled:!h.attribut_id,multiple:"",chips:"","closable-chips":""},null,8,["modelValue","items","disabled"])):(u(),k(te,{key:0,modelValue:h.valeur_id,"onUpdate:modelValue":t[27]||(t[27]=e=>h.valeur_id=e),label:"Value",variant:"outlined",items:ge.value,"item-title":"libelle","item-value":"id",placeholder:"Select value",disabled:!h.attribut_id},null,8,["modelValue","items","disabled"]))]),_:1}),a(g,{cols:"12",md:"3"},{default:l(()=>[a(U,{modelValue:h.prix_vente_variante,"onUpdate:modelValue":t[29]||(t[29]=e=>h.prix_vente_variante=e),modelModifiers:{number:!0},label:"Price Override",type:"number",variant:"outlined",step:"0.01",suffix:"MAD",placeholder:"Optional"},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"3",class:"d-flex align-end"},{default:l(()=>[Pe.value?(u(),k(F,{key:1,color:"primary",block:"",disabled:!h.attribut_id||!h.valeur_ids.length,onClick:Tt},{default:l(()=>[p(" Add "+s(h.valeur_ids.length||0)+" Variants ",1)]),_:1},8,["disabled"])):(u(),k(F,{key:0,color:"primary",block:"",disabled:!h.attribut_id||!h.valeur_id,onClick:Ut},{default:l(()=>t[49]||(t[49]=[p(" Add Variant ")])),_:1,__:[49]},8,["disabled"]))]),_:1})]),_:1})]),_:1})]),_:1}),i(E).length?(u(),f("div",ko,[n("h4",xo,s(i(d)("product_variants")),1),a(st,{headers:[{title:i(d)("attribute"),key:"attribut"},{title:i(d)("value"),key:"valeur"},{title:i(d)("price"),key:"prix_vente_variante"},{title:i(d)("image"),key:"image",sortable:!1},{title:i(d)("actions"),key:"actions",sortable:!1}],items:i(E),class:"elevation-1"},{"item.attribut":l(({item:e})=>{var r;return[n("div",null,[n("div",Vo,s(((r=e.attribut)==null?void 0:r.nom)||e.nom),1),e.attribut?(u(),f("div",wo,s(e.attribut.code),1)):z("",!0)])]}),"item.valeur":l(({item:e})=>{var r;return[n("div",null,[n("div",Po,s(((r=e.valeur)==null?void 0:r.libelle)||e.valeur),1),e.valeur?(u(),f("div",Fo,s(e.valeur.code),1)):z("",!0)])]}),"item.prix_vente_variante":l(({item:e})=>[p(s(e.prix_vente_variante?`${e.prix_vente_variante} MAD`:"Default"),1)]),"item.image":l(({item:e})=>[n("div",So,[e.image_url?(u(),k(Ce,{key:0,src:e.image_url,width:"40",height:"40",cover:"",class:"rounded",alt:`Variant ${e.nom} ${e.valeur}`},null,8,["src","alt"])):(u(),f("span",Co,s(i(d)("no_image")),1)),a(Re,{density:"compact","hide-details":"",accept:"image/*",variant:"plain",onChange:r=>{var c,y;return((y=(c=r.target)==null?void 0:c.files)==null?void 0:y[0])&&Dt(e.id,r.target.files[0])}},null,8,["onChange"])])]),"item.actions":l(({item:e})=>[a(F,{icon:"tabler-trash",size:"small",color:"error",variant:"text",onClick:r=>qt(e.id)},null,8,["onClick"])]),_:1},8,["headers","items"])])):(u(),k(O,{key:1,type:"info",variant:"tonal"},{default:l(()=>t[50]||(t[50]=[p(" No variants created yet. Add variants to offer different options for your product. ")])),_:1,__:[50]}))])):(u(),f("div",vo,[a(V,{icon:"tabler-versions-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),n("h3",po,s(i(d)("save_product_first")),1),n("p",_o,s(i(d)("save_product_before_adding_variants")),1)]))]),_:1}),a(ee,{value:"stock"},{default:l(()=>[A.value?(u(),f("div",Uo,[a(T,{variant:"outlined",class:"mb-6"},{default:l(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:l(()=>[n("span",null,s(o.$t("product.stock.global")),1),K.value.length>1?(u(),k(te,{key:0,modelValue:b.warehouse_id,"onUpdate:modelValue":[t[30]||(t[30]=e=>b.warehouse_id=e),ye],items:K.value,"item-title":"name","item-value":"id",label:o.$t("product.stock.warehouse"),variant:"outlined",density:"compact",style:{"max-width":"300px"}},null,8,["modelValue","items","label"])):K.value.length===1?(u(),k(M,{key:1,color:"primary",variant:"tonal"},{default:l(()=>[p(s(K.value[0].name),1)]),_:1})):z("",!0)]),_:1}),a(ae,null,{default:l(()=>[a(X,null,{default:l(()=>[a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:b.stock_total,"onUpdate:modelValue":t[31]||(t[31]=e=>b.stock_total=e),modelModifiers:{number:!0},label:o.$t("product.stock.total"),type:"number",variant:"outlined",min:"0",suffix:"unités",error:H.value,"error-messages":H.value?`Total insuffisant (${N.value} alloués)`:[]},null,8,["modelValue","label","error","error-messages"])]),_:1}),a(g,{cols:"12",md:"6",class:"d-flex align-end"},{default:l(()=>[a(F,{color:"primary",variant:"outlined",disabled:!S.value.length||!b.stock_total,onClick:It},{default:l(()=>[a(V,{icon:"tabler-arrows-split",start:""}),p(" "+s(o.$t("product.stock.distribute")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),a(T,{variant:"outlined",class:"mb-6"},{default:l(()=>[a(J,null,{default:l(()=>[n("div",To,[n("span",null,s(i(d)("stock_by_combination")),1),n("div",qo,[S.value.some(e=>e.is_combination)?(u(),k(M,{key:0,color:"success",variant:"tonal",size:"small"},{default:l(()=>[p(s(i(d)("created_combinations")),1)]),_:1})):S.value.some(e=>e.is_virtual)?(u(),k(M,{key:1,color:"warning",variant:"tonal",size:"small"},{default:l(()=>[p(s(i(d)("virtual_combinations")),1)]),_:1})):z("",!0)])])]),_:1}),a(ae,null,{default:l(()=>[Ee.value?(u(),f("div",Do,[a(oa,{indeterminate:"",color:"primary"}),n("p",Ao,s(i(d)("loading_matrix")),1)])):S.value.length?(u(),f("div",Lo,[S.value.some(e=>e.is_virtual)?(u(),k(O,{key:0,type:"warning",variant:"tonal",class:"mb-4"},{default:l(()=>[n("div",Ro,[n("div",null,[a(V,{icon:"tabler-alert-triangle",start:""}),n("strong",null,s(i(d)("virtual_combinations_detected")),1),p(" "+s(i(d)("separate_size_color_variants_detected"))+" "+s(i(d)("generate_combinations_to_manage_stock")),1)]),a(F,{color:"warning",variant:"outlined",size:"small",onClick:Mt,loading:$e.value},{default:l(()=>[a(V,{icon:"tabler-plus",start:""}),p(" "+s(i(d)("generate_combinations")),1)]),_:1},8,["loading"])])]),_:1})):S.value.some(e=>e.is_combination)?(u(),k(O,{key:1,type:"success",variant:"tonal",class:"mb-4"},{default:l(()=>[a(V,{icon:"tabler-check-circle",start:""}),n("strong",null,s(i(d)("size_color_combinations")),1),p(" "+s(i(d)("stock_info_per_combination")),1)]),_:1})):z("",!0),a(ha,{density:"compact"},{default:l(()=>[n("thead",null,[n("tr",null,[n("th",null,s(o.$t("product.stock.matrix.color")),1),n("th",null,s(o.$t("product.stock.matrix.size")),1),n("th",null,s(o.$t("product.stock.matrix.qty")),1),n("th",null,s(o.$t("product.stock.matrix.reserved")),1),n("th",null,s(o.$t("product.stock.matrix.available")),1)])]),n("tbody",null,[(u(!0),f(Fe,null,Se(S.value,(e,r)=>(u(),f("tr",{key:r},[n("td",null,[e.color?(u(),f("div",Oo,[e.color_image?(u(),k(Ce,{key:0,src:e.color_image,width:"24",height:"24",cover:"",class:"rounded me-2"},null,8,["src"])):z("",!0),n("span",null,s(e.color),1)])):(u(),f("span",No,"-"))]),n("td",null,[e.size?(u(),f("span",jo,s(e.size),1)):(u(),f("span",Bo,"-"))]),n("td",null,[e.is_virtual?(u(),k(M,{key:1,color:"warning",variant:"tonal",size:"small"},{default:l(()=>t[51]||(t[51]=[p(" Virtuel ")])),_:1,__:[51]})):(u(),k(U,{key:0,"model-value":e.qty,type:"number",variant:"outlined",density:"compact",min:"0",style:{width:"100px"},"hide-details":"","onUpdate:modelValue":c=>At(e.variante_id,c)},null,8,["model-value","onUpdate:modelValue"]))]),n("td",Wo,s(e.reserved||0),1),n("td",Ko,s(e.available||0),1)]))),128))]),n("tfoot",null,[n("tr",{class:Ae(H.value?"bg-red-lighten-4":"bg-grey-lighten-4")},[n("td",Ho,s(i(d)("admin_total")),1),n("td",{class:Ae(H.value?"font-weight-bold text-red":"font-weight-bold")},[p(s(N.value)+" ",1),H.value?(u(),k(V,{key:0,icon:"tabler-alert-circle",size:"small",color:"red",class:"ml-1"})):z("",!0)],2),n("td",Jo,s(Ge.value),1),n("td",Xo,s(vt.value),1)],2)])]),_:1}),H.value?(u(),k(O,{key:2,type:"error",variant:"tonal",class:"mt-4"},{default:l(()=>[a(V,{icon:"tabler-alert-circle",start:""}),n("strong",null,s(i(d)("stock_exceeded_error")),1),t[52]||(t[52]=n("br",null,null,-1)),p(" "+s(i(d)("variant_sum_exceeds_total_stock",{variantSum:N.value,totalStock:b.stock_total}))+" ",1),t[53]||(t[53]=n("br",null,null,-1)),n("small",Qo,s(i(d)("reduce_variant_quantities_or_increase_total")),1)]),_:1,__:[52,53]})):Ye.value?(u(),k(O,{key:3,type:"warning",variant:"tonal",class:"mt-4"},{default:l(()=>[a(V,{icon:"tabler-alert-triangle",start:""}),p(" "+s(o.$t("product.stock.mismatch_warning"))+" ",1),t[54]||(t[54]=n("br",null,null,-1)),n("strong",null,"Stock total: "+s(b.stock_total),1),t[55]||(t[55]=p(" | ")),n("strong",null,s(i(d)("variant_sum"))+": "+s(N.value),1),t[56]||(t[56]=n("br",null,null,-1)),n("small",Go,s(i(d)("use_distribute_button_to_balance")),1)]),_:1,__:[54,55,56]})):z("",!0)])):(u(),f("div",Io,[a(V,{icon:"tabler-versions-off",size:"48",color:"grey-lighten-1",class:"mb-4"}),n("p",Mo,s(i(d)("no_variants_found_create_first")),1)]))]),_:1})]),_:1})])):(u(),f("div",Eo,[a(V,{icon:"tabler-package-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),n("h3",$o,s(i(d)("save_product_first")),1),n("p",zo,s(i(d)("save_product_before_managing_stock")),1)]))]),_:1}),a(ee,{value:"propositions"},{default:l(()=>[A.value?(u(),f("div",tl,[n("div",al,[n("h3",ol,s(i(d)("product_propositions")),1),n("p",ll,s(i(d)("create_marketing_propositions_description")),1)]),a(T,{class:"mb-6"},{default:l(()=>[a(J,null,{default:l(()=>t[57]||(t[57]=[p("Add New Proposition")])),_:1,__:[57]}),a(ae,null,{default:l(()=>[a(Me,{onSubmit:De(Bt,["prevent"])},{default:l(()=>[a(X,null,{default:l(()=>[a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:q.titre,"onUpdate:modelValue":t[32]||(t[32]=e=>q.titre=e),label:"Title",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(te,{modelValue:q.type,"onUpdate:modelValue":t[33]||(t[33]=e=>q.type=e),items:[{title:"New",value:"nouveau"},{title:"Modification",value:"modification"},{title:"Deletion",value:"suppression"}],label:"Type",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[a(Le,{modelValue:q.description,"onUpdate:modelValue":t[34]||(t[34]=e=>q.description=e),label:"Description",variant:"outlined",rows:"3",required:""},null,8,["modelValue"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[a(F,{type:"submit",color:"primary",disabled:!q.titre||!q.description||!q.type},{default:l(()=>t[58]||(t[58]=[p(" Add Proposition ")])),_:1,__:[58]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),re.value.length>0?(u(),k(T,{key:0},{default:l(()=>[a(J,null,{default:l(()=>[p(s(i(d)("existing_propositions")),1)]),_:1}),a(ae,null,{default:l(()=>[a(X,null,{default:l(()=>[(u(!0),f(Fe,null,Se(re.value,e=>(u(),k(g,{key:e.id,cols:"12",md:"6"},{default:l(()=>[a(T,{variant:"outlined",class:"h-100"},{default:l(()=>[a(J,{class:"d-flex align-center justify-space-between"},{default:l(()=>[n("span",null,s(e.titre),1),a(M,{color:Ht(e.statut),size:"small"},{default:l(()=>[p(s(e.statut),1)]),_:2},1032,["color"])]),_:2},1024),a(ae,null,{default:l(()=>[n("p",rl,s(e.description),1),a(M,{size:"small",variant:"outlined",class:"mb-2"},{default:l(()=>[p(s(e.type),1)]),_:2},1024),e.image_url?(u(),f("div",sl,[a(Ce,{src:e.image_url,height:"100",class:"rounded",alt:`Proposition ${e.titre||"image"}`,cover:""},null,8,["src","alt"])])):(u(),f("div",il,[a(O,{type:"info",variant:"tonal",density:"compact"},{default:l(()=>t[59]||(t[59]=[p(" No image uploaded ")])),_:1,__:[59]})]))]),_:2},1024),a(Ie,null,{default:l(()=>[a(F,{size:"small",variant:"outlined",disabled:!e.id,onClick:r=>e.id&&Kt(e.id)},{default:l(()=>[p(s(e.image_url?"Change Image":"Add Image"),1)]),_:2},1032,["disabled","onClick"]),a(Oe),a(F,{size:"small",color:"error",variant:"outlined",disabled:!e.id,onClick:r=>e.id&&Wt(e.id)},{default:l(()=>t[60]||(t[60]=[p(" Delete ")])),_:2,__:[60]},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):(u(),k(O,{key:1,type:"info",variant:"tonal"},{default:l(()=>[p(s(i(d)("no_propositions_created_yet")),1)]),_:1}))])):(u(),f("div",Yo,[a(V,{icon:"tabler-list-details-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),n("h3",Zo,s(i(d)("save_product_first")),1),n("p",el,s(i(d)("save_product_before_adding_propositions")),1)]))]),_:1}),a(ee,{value:"ruptures"},{default:l(()=>[A.value?(u(),f("div",cl,[n("div",ml,[n("h3",vl,s(i(d)("product_stock_issues")),1),n("p",pl,s(i(d)("manage_stock_shortages_description")),1)]),a(T,{class:"mb-6"},{default:l(()=>[a(J,null,{default:l(()=>t[61]||(t[61]=[p("Report Stock Issue")])),_:1,__:[61]}),a(ae,null,{default:l(()=>[a(Me,{onSubmit:De(Xt,["prevent"])},{default:l(()=>[a(X,null,{default:l(()=>[i(E).length>0?(u(),k(g,{key:0,cols:"12",md:"6"},{default:l(()=>[a(te,{modelValue:$.variante_id,"onUpdate:modelValue":t[35]||(t[35]=e=>$.variante_id=e),items:[{title:i(d)("product_level_issue_all_variants"),value:null},...i(E).map(e=>(console.debug("[ProductForm] Variant for select:",e),{title:`${e.nom||"Unknown"}: ${e.valeur||"Unknown"}`,value:e.id}))],label:i(E).length>0?i(d)("variant_required"):i(d)("variant_optional"),variant:"outlined",required:i(E).length>0,"error-messages":Y.variante_id},null,8,["modelValue","items","label","required","error-messages"])]),_:1})):(u(),k(g,{key:1,cols:"12",md:"6"},{default:l(()=>[a(O,{type:"info",variant:"tonal",class:"mb-0"},{default:l(()=>t[62]||(t[62]=[p(" This product has no variants. The stock issue will apply to the entire product. ")])),_:1,__:[62]})]),_:1})),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:$.motif,"onUpdate:modelValue":t[36]||(t[36]=e=>$.motif=e),label:"Reason",variant:"outlined",placeholder:"e.g., Supplier delay, High demand",required:""},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:$.started_at,"onUpdate:modelValue":t[37]||(t[37]=e=>$.started_at=e),label:"Started At",type:"datetime-local",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"6"},{default:l(()=>[a(U,{modelValue:$.expected_restock_at,"onUpdate:modelValue":t[38]||(t[38]=e=>$.expected_restock_at=e),label:"Expected Restock (Optional)",type:"datetime-local",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(g,{cols:"12"},{default:l(()=>[a(F,{type:"submit",color:"primary",disabled:!$.motif||!$.started_at},{default:l(()=>t[63]||(t[63]=[p(" Report Issue ")])),_:1,__:[63]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),G.value.length>0?(u(),k(T,{key:0},{default:l(()=>[a(J,null,{default:l(()=>[p(s(i(d)("current_stock_issues")),1)]),_:1}),a(ae,null,{default:l(()=>[a(st,{items:G.value,headers:[{title:"Variant",key:"variante_id"},{title:"Reason",key:"motif"},{title:"Started",key:"started_at"},{title:"Expected Restock",key:"expected_restock_at"},{title:"Status",key:"active"},{title:"Actions",key:"actions",sortable:!1}],class:"elevation-1"},{"item.variante_id":l(({item:e})=>[n("span",{class:Ae(e.variante_id?"":"text-medium-emphasis")},s(_t(e.variante_id)),3)]),"item.started_at":l(({item:e})=>[p(s(new Date(e.started_at).toLocaleDateString()),1)]),"item.expected_restock_at":l(({item:e})=>[e.expected_restock_at?(u(),f("span",_l,s(new Date(e.expected_restock_at).toLocaleDateString()),1)):(u(),f("span",fl,"Not set"))]),"item.active":l(({item:e})=>[a(M,{color:e.active?"error":"success",size:"small"},{default:l(()=>[p(s(e.active?"Active":"Resolved"),1)]),_:2},1032,["color"])]),"item.actions":l(({item:e})=>[e.active?(u(),k(F,{key:0,size:"small",color:"success",variant:"outlined",onClick:r=>Qt(e.id)},{default:l(()=>t[64]||(t[64]=[p(" Resolve ")])),_:2,__:[64]},1032,["onClick"])):z("",!0),a(F,{size:"small",color:"error",variant:"outlined",class:"ml-2",onClick:r=>Gt(e.id)},{default:l(()=>t[65]||(t[65]=[p(" Delete ")])),_:2,__:[65]},1032,["onClick"])]),_:1},8,["items"])]),_:1})]),_:1})):(u(),k(O,{key:1,type:"info",variant:"tonal"},{default:l(()=>[p(s(i(d)("no_stock_issues_reported_yet")),1)]),_:1}))])):(u(),f("div",nl,[a(V,{icon:"tabler-alert-triangle-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),n("h3",dl,s(i(d)("save_product_first")),1),n("p",ul,s(i(d)("save_product_before_managing_stock_issues")),1)]))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(T,{class:"sticky-footer mt-6"},{default:l(()=>[a(Ie,{class:"pa-6"},{default:l(()=>[a(Oe),a(F,{variant:"outlined",size:"large",onClick:bt},{default:l(()=>t[66]||(t[66]=[p(" Cancel ")])),_:1,__:[66]}),a(F,{color:"primary",size:"large",type:"button",loading:Ve.value,onClick:et},{default:l(()=>[p(s(be.value?"Update Product":"Create Product"),1)]),_:1},8,["loading"])]),_:1})]),_:1}),a(ka,{modelValue:i(me).show,"onUpdate:modelValue":t[40]||(t[40]=e=>i(me).show=e),color:i(me).color,timeout:i(me).timeout,location:"top end"},{default:l(()=>[p(s(i(me).message),1)]),_:1},8,["modelValue","color","timeout"])]))}}),Jl=xa(gl,[["__scopeId","data-v-6d7cdfb7"]]);export{Jl as P};
