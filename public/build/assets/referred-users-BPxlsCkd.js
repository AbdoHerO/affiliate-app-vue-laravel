import{d as K,aL as L,j as $,r as p,V as A,D as M,c as O,o as q,e as o,b as t,t as n,m as s,f as a,s as f,cD as G,ac as V,az as g,b5 as C}from"./main-uLG9IIeX.js";import{b as H,V as k}from"./VCard-CB1gT6RB.js";import{V as U}from"./VCardText-BZtszuIK.js";import{V as z,a as m}from"./VRow-aGfXYx3U.js";import{V as h}from"./VTextField-Dxeq5kx5.js";import{V as y}from"./VSelect-sWnAtot-.js";import{V as J}from"./VDataTableServer-DfLBg0lg.js";import{V as D}from"./VChip-B84WcmDa.js";import{V as S}from"./VAvatar-bHPDEsYY.js";import"./createSimpleFunctional-DugzUcbB.js";import"./VImg-BS6_svHJ.js";/* empty css              */import"./VField-CfH1YcVv.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./VList-uZDByhc2.js";import"./ssrBoot-BPhRU-mF.js";import"./VDivider-UqGR4x4D.js";import"./dialog-transition-2hF0ajsQ.js";import"./VMenu-DP1p-55V.js";import"./VCheckboxBtn-CogF2AUK.js";import"./VDataTable-DNqSzzrc.js";import"./VPagination-DYW6O4lq.js";import"./VTable-0U-NvIH3.js";import"./filter-D_SbaZWa.js";const P={class:"d-flex justify-space-between align-center mb-6"},Q={class:"text-h4 font-weight-bold mb-1"},W={class:"text-body-1 mb-0"},X={class:"d-flex gap-2"},Y={class:"d-flex align-center"},Z={class:"font-weight-medium"},ee={class:"text-body-2 text-medium-emphasis"},te={class:"d-flex align-center"},ae={class:"font-weight-medium"},re={class:"text-body-2 text-medium-emphasis"},le={class:"text-center py-8"},se={class:"text-h6 mb-2"},oe={class:"text-body-2"},Re=K({__name:"referred-users",setup(ie){const{t:r}=L(),T=$(),v=p(!1),x=p([]),u=p({current_page:1,last_page:1,per_page:15,total:0}),d=p({search:"",referrer_id:"",verified:null,start_date:"",end_date:"",source:""}),w=p([]),B=A(()=>[{title:r("referred_user"),key:"new_user",sortable:!1},{title:r("referrer"),key:"referrer",sortable:!1},{title:r("signup_date"),key:"attributed_at",sortable:!0},{title:r("verification_status"),key:"verified",sortable:!0},{title:r("source"),key:"source",sortable:!0},{title:r("actions"),key:"actions",sortable:!1}]),_=async(i=1)=>{v.value=!0;try{const l={page:i,per_page:u.value.per_page,...d.value};Object.keys(l).forEach(b=>{(l[b]===""||l[b]===null)&&delete l[b]});const e=await C.get("/admin/referrals/referred-users",{params:l});e.data.success&&(x.value=e.data.data,u.value=e.data.pagination)}catch(l){console.error("Failed to fetch referred users:",l)}finally{v.value=!1}},F=async()=>{try{const i=await C.get("/admin/affiliates",{params:{per_page:100}});i.data.success&&(w.value=i.data.data.map(l=>({value:l.id,title:`${l.nom_complet} (${l.email})`})))}catch(i){console.error("Failed to fetch referrers:",i)}},c=()=>{u.value.current_page=1,_()},R=()=>{d.value={search:"",referrer_id:"",verified:null,start_date:"",end_date:"",source:""},_()},j=i=>new Date(i).toLocaleDateString(),I=i=>i?"success":"warning",N=i=>r(i?"verified":"pending_verification"),E=i=>i==="mobile"?"info":"primary";return M(()=>{_(),F()}),(i,l)=>(q(),O("div",null,[o("div",P,[o("div",null,[o("h1",Q,n(s(r)("referred_users")),1),o("p",W,n(s(r)("referred_users_subtitle")),1)])]),t(k,{class:"mb-6"},{default:a(()=>[t(H,null,{default:a(()=>[f(n(s(r)("filters")),1)]),_:1}),t(U,null,{default:a(()=>[t(z,null,{default:a(()=>[t(m,{cols:"12",md:"3"},{default:a(()=>[t(h,{modelValue:d.value.search,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value.search=e),label:s(r)("search_users"),placeholder:s(r)("search_by_name_email"),"prepend-inner-icon":"tabler-search",clearable:"",onKeyup:G(c,["enter"])},null,8,["modelValue","label","placeholder"])]),_:1}),t(m,{cols:"12",md:"3"},{default:a(()=>[t(y,{modelValue:d.value.referrer_id,"onUpdate:modelValue":[l[1]||(l[1]=e=>d.value.referrer_id=e),c],items:w.value,label:s(r)("referrer"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(m,{cols:"12",md:"2"},{default:a(()=>[t(y,{modelValue:d.value.verified,"onUpdate:modelValue":[l[2]||(l[2]=e=>d.value.verified=e),c],items:[{value:!0,title:s(r)("verified")},{value:!1,title:s(r)("unverified")}],label:s(r)("verification_status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(m,{cols:"12",md:"2"},{default:a(()=>[t(y,{modelValue:d.value.source,"onUpdate:modelValue":[l[3]||(l[3]=e=>d.value.source=e),c],items:[{value:"web",title:s(r)("web")},{value:"mobile",title:s(r)("mobile")}],label:s(r)("source"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(m,{cols:"12",md:"2"},{default:a(()=>[o("div",X,[t(V,{color:"primary",onClick:c},{default:a(()=>[f(n(s(r)("search")),1)]),_:1}),t(V,{variant:"outlined",onClick:R},{default:a(()=>[f(n(s(r)("clear")),1)]),_:1})])]),_:1})]),_:1}),t(z,{class:"mt-2"},{default:a(()=>[t(m,{cols:"12",md:"3"},{default:a(()=>[t(h,{modelValue:d.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=e=>d.value.start_date=e),type:"date",label:s(r)("start_date"),onChange:c},null,8,["modelValue","label"])]),_:1}),t(m,{cols:"12",md:"3"},{default:a(()=>[t(h,{modelValue:d.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=e=>d.value.end_date=e),type:"date",label:s(r)("end_date"),onChange:c},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),t(k,null,{default:a(()=>[t(U,null,{default:a(()=>[t(J,{page:u.value.current_page,"onUpdate:page":[l[6]||(l[6]=e=>u.value.current_page=e),_],headers:B.value,items:x.value,"items-length":u.value.total,"items-per-page":u.value.per_page,loading:v.value,class:"text-no-wrap"},{"item.new_user":a(({item:e})=>[o("div",Y,[t(S,{size:"32",class:"me-3"},{default:a(()=>[t(g,{icon:"tabler-user"})]),_:1}),o("div",null,[o("div",Z,n(e.new_user.nom_complet),1),o("div",ee,n(e.new_user.email),1)])])]),"item.referrer":a(({item:e})=>[o("div",te,[t(S,{size:"32",class:"me-3",color:"primary",variant:"tonal"},{default:a(()=>[t(g,{icon:"tabler-user-star"})]),_:1}),o("div",null,[o("div",ae,n(e.referrer_affiliate.utilisateur.nom_complet),1),o("div",re,n(e.referrer_affiliate.utilisateur.email),1)])])]),"item.attributed_at":a(({item:e})=>[f(n(j(e.attributed_at)),1)]),"item.verified":a(({item:e})=>[t(D,{color:I(e.verified),size:"small"},{default:a(()=>[f(n(N(e.verified)),1)]),_:2},1032,["color"])]),"item.source":a(({item:e})=>[t(D,{color:E(e.source),size:"small"},{default:a(()=>[f(n(e.source),1)]),_:2},1032,["color"])]),"item.actions":a(({item:e})=>[t(V,{icon:"tabler-eye",size:"small",variant:"text",onClick:()=>s(T).push({name:"admin-referrals-referred-users-id",params:{id:e.id}})},null,8,["onClick"])]),"no-data":a(()=>[o("div",le,[t(g,{icon:"tabler-users-off",size:"64",class:"mb-4",color:"disabled"}),o("h6",se,n(s(r)("no_referred_users")),1),o("p",oe,n(s(r)("no_referred_users_description")),1)])]),_:1},8,["page","headers","items","items-length","items-per-page","loading"])]),_:1})]),_:1})]))}});export{Re as default};
