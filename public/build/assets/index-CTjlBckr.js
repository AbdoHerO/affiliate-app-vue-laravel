import{d as de,k as ue,aL as me,b8 as D,r as ce,V as f,w as pe,o as fe,c as y,b as m,e as t,g as o,f as s,v as r,ac as V,t as _,az as k,n as i,aP as _e,h as g,aM as ge}from"./main-3LuWNv9W.js";import{u as he}from"./produits-BKoc20sl.js";import{u as ve}from"./boutiques-QloM7Kn3.js";import{u as be}from"./categories-Bv3Eg7i7.js";import{_ as ye}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-BJ6JYbX8.js";import{useQuickConfirm as Ve}from"./useConfirmAction-CUN-9iuP.js";import{d as ke,S as we}from"./SoftDeleteActions-BNHbnv_L.js";import{S as xe}from"./SoftDeleteFilter-W0gDueIY.js";import{a as u,V as w}from"./VRow-aVZbYr4A.js";import{V as h}from"./VCard-QqgF9aMj.js";import{V as v}from"./VCardText-Dqaeyxp0.js";import{V as x}from"./VAvatar-CH3JpKwD.js";import{V as Ce}from"./VTextField-CsO1UfXI.js";import{V as C}from"./VSelect-V4QjM3w5.js";import{V as Se}from"./VDataTableServer-BIt2YTB3.js";import{V as b}from"./VChip-D2hyzrT3.js";import{V as $e}from"./VRating-glI9uzve.js";import{V as Pe}from"./VImg-DjZhnPY1.js";import{V as De}from"./VDivider-D28qXVrs.js";import{V as qe}from"./VPagination-C9G78dYZ.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useApi-C6mAvy3D.js";import"./useNotifications-B3v5F4dH.js";import"./VBreadcrumbs-Cjt6xYOm.js";import"./ActionIcon-DKcf4fGC.js";import"./VTooltip-DeQJuQst.js";import"./VOverlay-DHKe6cTP.js";import"./forwardRefs-BZg6tG7B.js";import"./lazy-vcHGEOxt.js";/* empty css              */import"./createSimpleFunctional-CbZg_Do-.js";import"./VField-CzoZXYxi.js";import"./VList-DWKF8cD-.js";import"./ssrBoot-DPE17Lki.js";import"./dialog-transition-TWAYErkS.js";import"./VMenu-cCaIVuKn.js";import"./VCheckboxBtn-BQUGQfLA.js";import"./VDataTable-Dz5dOo4J.js";import"./VTable-Dyn4MLHa.js";import"./filter-DJ4i-HET.js";const ze={class:"d-flex align-center justify-space-between"},Ue={class:"text-h4 font-weight-bold mb-2"},Te={class:"text-body-1 text-medium-emphasis"},Fe={class:"d-flex align-center"},Re={class:"text-h5 font-weight-bold"},je={class:"text-body-2 text-medium-emphasis mb-0"},Ae={class:"d-flex align-center"},Ee={class:"text-h5 font-weight-bold"},Ie={class:"text-body-2 text-medium-emphasis mb-0"},Ne={class:"d-flex align-center"},Me={class:"text-h5 font-weight-bold"},Oe={class:"text-body-2 text-medium-emphasis mb-0"},Qe={class:"d-flex justify-center"},Le={class:"product-title-column"},Ge={class:"font-weight-medium product-title"},He={class:"text-caption text-medium-emphasis"},Je={class:"sku-column"},Ke={key:1,class:"text-medium-emphasis text-caption"},We={key:1,class:"text-medium-emphasis"},Xe={key:1,class:"text-medium-emphasis"},Ye={class:"font-weight-medium"},Ze={class:"font-weight-medium"},et={class:"d-flex align-center justify-center gap-2"},tt={class:"text-caption text-medium-emphasis"},at={class:"d-flex gap-1"},ot={class:"text-body-2 text-medium-emphasis"},lt=de({__name:"index",setup(it){const S=ue(),{t:d}=me(),{confirmDelete:st}=Ve(),{filter:$,getQueryParams:F,getStatusColor:R,getStatusText:j}=ke(()=>c(),e=>console.error("Soft delete error:",e)),q=he(),B=ve(),z=be(),{fetchProduits:c,deleteProduit:rt}=q,{produits:P,loading:A,error:nt,pagination:p,filters:l}=D(q),{items:E}=D(B),{categories:I}=D(z);ce(!1);const N=f(()=>p.value.total),M=f(()=>P.value.filter(e=>e.actif).length),O=f(()=>P.value.filter(e=>!e.actif).length),Q=f(()=>[{title:d("title_admin_dashboard"),to:"/admin"},{title:d("admin_produits_title"),active:!0}]),L=f(()=>[{title:d("admin_produits_photo"),key:"image",sortable:!1,width:80,align:"center"},{title:d("admin_produits_titre"),key:"titre",sortable:!0,width:300},{title:d("admin_produits_sku"),key:"sku",sortable:!0,width:120},{title:d("admin_produits_boutique"),key:"boutique.nom",sortable:!0},{title:d("admin_produits_categorie"),key:"categorie.nom",sortable:!0},{title:d("admin_produits_prix_vente"),key:"prix_vente",sortable:!0,align:"end"},{title:d("admin_produits_prix_affilie"),key:"prix_affilie",sortable:!0,align:"end"},{title:d("products.list.column.rating"),key:"rating_value",sortable:!0,align:"center"},{title:d("common.status"),key:"actif",sortable:!0},{title:d("record_status"),key:"record_status",sortable:!1},{title:d("common.actions"),key:"actions",sortable:!1,width:120}]),G=f(()=>[{title:d("common.all"),value:""},{title:d("common.active"),value:"1"},{title:d("common.inactive"),value:"0"}]),H=[10,15,25,50,100],J=ge(async()=>{try{await c({...l.value})}catch(e){e.name!=="AbortError"&&console.error("Error loading products:",e)}},300);pe(l,()=>{J()},{deep:!0});const K=e=>{l.value.page=e.page,l.value.perPage=e.itemsPerPage,e.sortBy&&e.sortBy.length>0&&(l.value.sort=e.sortBy[0].key,l.value.dir=e.sortBy[0].order==="desc"?"desc":"asc")},W=e=>{l.value.q=e,l.value.page=1},X=e=>{l.value.boutique_id=e,l.value.page=1},Y=e=>{l.value.categorie_id=e,l.value.page=1},Z=e=>{l.value.actif=e,l.value.page=1},ee=e=>{l.value.perPage=e,l.value.page=1},te=()=>{Object.assign(l.value,F()),l.value.page=1},ae=async()=>{try{await Promise.all([B.fetchBoutiques(),z.fetchCategories()])}catch(e){console.error("Error loading filter options:",e)}},oe=()=>{S.push("/admin/produits/create")},le=e=>{console.log("[List] Navigating to edit page for product:",e.id),S.push(`/admin/produits/${e.id}/edit`)},ie=e=>{S.push(`/admin/produits/${e.id}`)},se=async e=>{try{const n=`${window.location.origin}/p/${e.slug}`;await navigator.clipboard.writeText(n),console.log("Share link copied to clipboard:",n),window.open(n,"_blank")}catch(n){console.error("Failed to copy share link:",n);const a=`${window.location.origin}/p/${e.slug}`;window.open(a,"_blank")}},U=e=>e?new Intl.NumberFormat("fr-MA",{style:"currency",currency:"MAD",minimumFractionDigits:2}).format(e):"-",re=e=>e?"success":"error",ne=e=>d(e?"common.active":"common.inactive");return fe(async()=>{await ae(),await c({...l.value})}),(e,n)=>(m(),y("div",null,[t(ye,{items:Q.value},null,8,["items"]),t(w,{class:"mb-6"},{default:o(()=>[t(u,{cols:"12"},{default:o(()=>[s("div",ze,[s("div",null,[s("h1",Ue,r(e.$t("admin_produits_title")),1),s("p",Te,r(e.$t("admin_produits_subtitle")),1)]),t(V,{color:"primary","prepend-icon":"tabler-plus",onClick:oe},{default:o(()=>[_(r(e.$t("admin_produits_create")),1)]),_:1})])]),_:1})]),_:1}),t(w,{class:"mb-6"},{default:o(()=>[t(u,{cols:"12",md:"4"},{default:o(()=>[t(h,null,{default:o(()=>[t(v,null,{default:o(()=>[s("div",Fe,[t(x,{color:"primary",variant:"tonal",class:"me-4"},{default:o(()=>[t(k,{icon:"tabler-package"})]),_:1}),s("div",null,[s("h3",Re,r(N.value),1),s("p",je,r(e.$t("admin_produits_total")),1)])])]),_:1})]),_:1})]),_:1}),t(u,{cols:"12",md:"4"},{default:o(()=>[t(h,null,{default:o(()=>[t(v,null,{default:o(()=>[s("div",Ae,[t(x,{color:"success",variant:"tonal",class:"me-4"},{default:o(()=>[t(k,{icon:"tabler-check"})]),_:1}),s("div",null,[s("h3",Ee,r(M.value),1),s("p",Ie,r(e.$t("admin_produits_active")),1)])])]),_:1})]),_:1})]),_:1}),t(u,{cols:"12",md:"4"},{default:o(()=>[t(h,null,{default:o(()=>[t(v,null,{default:o(()=>[s("div",Ne,[t(x,{color:"error",variant:"tonal",class:"me-4"},{default:o(()=>[t(k,{icon:"tabler-x"})]),_:1}),s("div",null,[s("h3",Me,r(O.value),1),s("p",Oe,r(e.$t("admin_produits_inactive")),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),t(h,{class:"mb-6"},{default:o(()=>[t(v,null,{default:o(()=>[t(w,null,{default:o(()=>[t(u,{cols:"12",md:"3"},{default:o(()=>[t(Ce,{modelValue:i(l).q,"onUpdate:modelValue":[n[0]||(n[0]=a=>i(l).q=a),W],label:e.$t("common.search"),placeholder:e.$t("admin_produits_search_placeholder"),"prepend-inner-icon":"tabler-search",clearable:""},null,8,["modelValue","label","placeholder"])]),_:1}),t(u,{cols:"12",md:"2"},{default:o(()=>[t(C,{modelValue:i(l).boutique_id,"onUpdate:modelValue":[n[1]||(n[1]=a=>i(l).boutique_id=a),X],items:i(E),"item-title":"nom","item-value":"id",label:e.$t("admin_produits_boutique"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(u,{cols:"12",md:"2"},{default:o(()=>[t(C,{modelValue:i(l).categorie_id,"onUpdate:modelValue":[n[2]||(n[2]=a=>i(l).categorie_id=a),Y],items:i(I),"item-title":"nom","item-value":"id",label:e.$t("admin_produits_categorie"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(u,{cols:"12",md:"1"},{default:o(()=>[t(C,{modelValue:i(l).actif,"onUpdate:modelValue":[n[3]||(n[3]=a=>i(l).actif=a),Z],items:G.value,"item-title":"title","item-value":"value",label:e.$t("common.status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(u,{cols:"12",md:"2"},{default:o(()=>[t(xe,{modelValue:i($),"onUpdate:modelValue":[n[4]||(n[4]=a=>_e($)?$.value=a:null),te]},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"2"},{default:o(()=>[t(C,{modelValue:i(l).perPage,"onUpdate:modelValue":[n[5]||(n[5]=a=>i(l).perPage=a),ee],items:H,label:e.$t("common.items_per_page")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),t(h,null,{default:o(()=>[t(Se,{headers:L.value,items:i(P),loading:i(A),"no-data-text":e.$t("common_no_data"),"items-per-page":i(l).perPage,page:i(l).page,"items-length":i(p).total,"onUpdate:options":K,"hide-default-footer":""},{"item.image":o(({item:a})=>[s("div",Qe,[a.images&&a.images[0]?(m(),g(Pe,{key:0,src:a.images[0].url,width:"50",height:"50",class:"rounded",cover:""},null,8,["src"])):(m(),g(x,{key:1,color:"grey-lighten-2",size:"50"},{default:o(()=>[t(k,{icon:"tabler-package"})]),_:1}))])]),"item.titre":o(({item:a})=>[s("div",Le,[s("div",Ge,r(a.titre),1),s("div",He,r(a.slug),1)])]),"item.sku":o(({item:a})=>[s("div",Je,[a.sku?(m(),g(b,{key:0,size:"small",color:"info",variant:"outlined",class:"font-mono"},{default:o(()=>[_(r(a.sku),1)]),_:2},1024)):(m(),y("span",Ke,r(i(d)("admin_produits_no_sku")),1))])]),"item.boutique.nom":o(({item:a})=>[a.boutique?(m(),g(b,{key:0,size:"small",color:"primary",variant:"tonal"},{default:o(()=>[_(r(a.boutique.nom),1)]),_:2},1024)):(m(),y("span",We,"-"))]),"item.categorie.nom":o(({item:a})=>[a.categorie?(m(),g(b,{key:0,size:"small",color:"secondary",variant:"tonal"},{default:o(()=>[_(r(a.categorie.nom),1)]),_:2},1024)):(m(),y("span",Xe,"-"))]),"item.prix_vente":o(({item:a})=>[s("span",Ye,r(U(a.prix_vente)),1)]),"item.prix_affilie":o(({item:a})=>[s("span",Ze,r(U(a.prix_affilie)),1)]),"item.rating_value":o(({item:a})=>[s("div",et,[t($e,{"model-value":a.rating_value||0,readonly:"","half-increments":"",length:"5",size:"small",color:"warning","background-color":"grey-lighten-2"},null,8,["model-value"]),s("span",tt,r(a.rating_value?`${a.rating_value}/5`:"-"),1)])]),"item.actif":o(({item:a})=>[t(b,{color:re(a.actif),size:"small"},{default:o(()=>[_(r(ne(a.actif)),1)]),_:2},1032,["color"])]),"item.record_status":o(({item:a})=>[t(b,{color:i(R)(a),size:"small",variant:"elevated"},{default:o(()=>[_(r(i(j)(a)),1)]),_:2},1032,["color"])]),"item.actions":o(({item:a})=>[s("div",at,[t(V,{icon:"tabler-eye",size:"small",variant:"text",onClick:T=>ie(a)},null,8,["onClick"]),t(V,{icon:"tabler-edit",size:"small",variant:"text",onClick:T=>le(a)},null,8,["onClick"]),t(V,{icon:"tabler-share",size:"small",variant:"text",color:"primary",onClick:T=>se(a)},null,8,["onClick"]),t(we,{item:a,"entity-name":"product","api-endpoint":"/admin/produits","item-name-field":"titre",onDeleted:i(c),onRestored:i(c),onPermanentlyDeleted:i(c),"show-edit":!1,"show-view":!1},null,8,["item","onDeleted","onRestored","onPermanentlyDeleted"])])]),_:1},8,["headers","items","loading","no-data-text","items-per-page","page","items-length"]),t(De),t(v,null,{default:o(()=>[t(w,{align:"center",justify:"space-between"},{default:o(()=>[t(u,{cols:"auto"},{default:o(()=>[s("span",ot,r(e.$t("common.showing"))+" "+r(i(p).from)+" "+r(e.$t("common.to"))+" "+r(i(p).to)+" "+r(e.$t("common.of"))+" "+r(i(p).total)+" "+r(e.$t("common.results")),1)]),_:1}),t(u,{cols:"auto"},{default:o(()=>[t(qe,{modelValue:i(l).page,"onUpdate:modelValue":n[6]||(n[6]=a=>i(l).page=a),length:i(p).last_page,"total-visible":5},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1})]))}}),Kt=Be(lt,[["__scopeId","data-v-972be59f"]]);export{Kt as default};
