import{d as L,aL as T,k as I,r as p,o as N,c as j,b as z,e,n as s,g as l,f as F,v as m,ac as v,t as n,aW as M,b0 as R,b1 as E}from"./main-BGmfaZsq.js";import{u as P}from"./boutiques-BK9gpYxU.js";import{u as $}from"./useNotifications-TnKci45M.js";import{useQuickConfirm as A}from"./useConfirmAction-BkzLltMc.js";import{u as D}from"./useApi-CJ-TYkD6.js";import{V as O}from"./VBreadcrumbs-CXXoPXro.js";import{a as i,V as c}from"./VRow-Jzvhbj9T.js";import{V as Q,b as W}from"./VCard-hQ_o7lvO.js";import{V as h}from"./VCardText-BzdllyhI.js";import{V as G}from"./VForm-9k5StL4q.js";import{V as _}from"./VTextField-STn8GDXm.js";import{V as C}from"./VSelect-BYn5Cf2R.js";import{a as H,b as J,d as K}from"./VList-DVfzin0E.js";import{V as X}from"./VTextarea-Dm9Swusq.js";/* empty css              */import"./createSimpleFunctional-BjWjRu3X.js";import"./VAvatar-CXniQsPN.js";import"./VImg-6pMKiBpi.js";import"./VField-BqE6uwOn.js";import"./forwardRefs-BxxmAO9z.js";import"./dialog-transition-BhMeiVQ2.js";import"./VMenu-C3I-a7hP.js";import"./VOverlay-CvSSR2rW.js";import"./lazy-DgLfxsl0.js";import"./VCheckboxBtn-DO9961XV.js";import"./VChip-S_h5DeIW.js";import"./ssrBoot-A30zOnZp.js";import"./VDivider-oo2GmB8o.js";const Se=L({__name:"create",setup(Y){const{t:a}=T(),b=I(),x=P(),{showError:V}=$(),{confirmCreate:k}=A(),t=p({nom:"",slug:"",proprietaire_id:"",email_pro:"",adresse:"",statut:"actif",commission_par_defaut:0}),f=p(!1),u=p({}),g=p([]),B=()=>(u.value={},t.value.nom.trim()||(u.value.nom=[a("name_required")]),t.value.proprietaire_id||(u.value.proprietaire_id=[a("owner_required")]),t.value.email_pro&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value.email_pro)&&(u.value.email_pro=[a("invalid_email_format")]),Object.keys(u.value).length===0),S=async()=>{var d;try{const{data:o,error:r}=await D("/admin/users?per_page=100");if(r.value){V(a("error_loading_users"));return}g.value=((d=o.value)==null?void 0:d.users)||[]}catch{V(a("error_loading_users"))}},q=async()=>{var o;if(!(!B()||!await k(a("boutique")))){f.value=!0;try{await x.create(t.value),b.push({name:"admin-boutiques"})}catch(r){r.status===422&&((o=r.data)!=null&&o.errors)&&(u.value=r.data.errors)}finally{f.value=!1}}},w=()=>{b.push({name:"admin-boutiques"})},U=()=>{t.value.nom&&!t.value.slug&&(t.value.slug=t.value.nom.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))};return N(()=>{S()}),(d,o)=>(z(),j("div",null,[e(O,{items:[{title:s(a)("breadcrumb_home"),to:"/"},{title:s(a)("admin_boutiques_title"),to:"/admin/boutiques"},{title:s(a)("breadcrumb_create")}],class:"pa-0 mb-4"},null,8,["items"]),e(c,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(Q,null,{default:l(()=>[e(W,{class:"d-flex align-center justify-space-between"},{default:l(()=>[F("span",null,m(s(a)("admin_boutiques_create_title")),1),e(v,{variant:"outlined",size:"small",onClick:w},{default:l(()=>[n(m(s(a)("action_cancel")),1)]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(G,{onSubmit:M(q,["prevent"])},{default:l(()=>[e(c,null,{default:l(()=>[e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.nom,"onUpdate:modelValue":o[0]||(o[0]=r=>t.value.nom=r),label:s(a)("admin_boutiques_name"),"error-messages":u.value.nom,variant:"outlined",required:"",onBlur:U},null,8,["modelValue","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.slug,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value.slug=r),label:s(a)("admin_boutiques_slug"),"error-messages":u.value.slug,variant:"outlined",hint:s(a)("slug_hint")},null,8,["modelValue","label","error-messages","hint"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(C,{modelValue:t.value.proprietaire_id,"onUpdate:modelValue":o[2]||(o[2]=r=>t.value.proprietaire_id=r),items:g.value,"item-value":"id","item-title":"nom_complet",label:s(a)("admin_boutiques_owner"),"error-messages":u.value.proprietaire_id,variant:"outlined",required:""},{item:l(({props:r,item:y})=>[e(H,R(E(r)),{default:l(()=>[e(J,null,{default:l(()=>[n(m(y.raw.nom_complet),1)]),_:2},1024),e(K,null,{default:l(()=>[n(m(y.raw.email),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(C,{modelValue:t.value.statut,"onUpdate:modelValue":o[3]||(o[3]=r=>t.value.statut=r),items:[{value:"actif",title:s(a)("admin_boutiques_filter_status_active")},{value:"suspendu",title:s(a)("admin_boutiques_filter_status_inactive")},{value:"desactive",title:s(a)("admin_boutiques_filter_status_pending")}],label:s(a)("admin_boutiques_status"),"error-messages":u.value.statut,variant:"outlined",required:""},null,8,["modelValue","items","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.email_pro,"onUpdate:modelValue":o[4]||(o[4]=r=>t.value.email_pro=r),label:s(a)("admin_boutiques_contact_email"),"error-messages":u.value.email_pro,variant:"outlined",type:"email"},null,8,["modelValue","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.commission_par_defaut,"onUpdate:modelValue":o[5]||(o[5]=r=>t.value.commission_par_defaut=r),modelModifiers:{number:!0},label:s(a)("admin_boutiques_commission_rate"),"error-messages":u.value.commission_par_defaut,variant:"outlined",type:"number",min:"0",max:"100",suffix:"%"},null,8,["modelValue","label","error-messages"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(X,{modelValue:t.value.adresse,"onUpdate:modelValue":o[6]||(o[6]=r=>t.value.adresse=r),label:s(a)("admin_boutiques_address"),"error-messages":u.value.adresse,variant:"outlined",rows:"3"},null,8,["modelValue","label","error-messages"])]),_:1})]),_:1}),e(c,{class:"mt-4"},{default:l(()=>[e(i,{cols:"12",class:"d-flex gap-4 justify-end"},{default:l(()=>[e(v,{variant:"outlined",onClick:w},{default:l(()=>[n(m(s(a)("common.cancel")),1)]),_:1}),e(v,{type:"button",color:"primary",loading:f.value,onClick:q},{default:l(()=>[n(m(s(a)("common.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}});export{Se as default};
