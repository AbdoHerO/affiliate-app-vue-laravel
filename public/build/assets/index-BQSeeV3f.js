import{d as Ee,aL as Le,u as ze,j as Pe,r as w,V as z,D as Fe,c as y,o as m,e as i,b as t,aV as ye,t as o,m as p,ac as f,g as C,l as x,f as s,s as r,az as v,p as Me,F as xe,i as je}from"./main-uLG9IIeX.js";import{u as Ue}from"./shipping-CrLFy0ND.js";import{useConfirmAction as Oe}from"./useConfirmAction-C-KKQTYr.js";import{u as Be}from"./useNotifications-DDBS_wPD.js";import{V}from"./VChip-B84WcmDa.js";import{V as qe,a as Z,b as ee}from"./VList-uZDByhc2.js";import{V as Ge}from"./VMenu-DP1p-55V.js";import{V as te,a as Ke}from"./VTabs-BkhoRyPL.js";import{V as ie,a as He}from"./VWindowItem-DPvP18Ki.js";import{V as S,b as A,c as We}from"./VCard-CB1gT6RB.js";import{V as N}from"./VCardText-BZtszuIK.js";import{V as O,a as h}from"./VRow-aGfXYx3U.js";import{V as Ye}from"./VDivider-UqGR4x4D.js";import{V as Je,a as Qe}from"./VTimeline-BKtdccnZ.js";import{V as Xe}from"./VAlert-TgguXW_5.js";import{V as Ze}from"./VTextField-Dxeq5kx5.js";import{V as et}from"./VSelect-sWnAtot-.js";import{V as tt}from"./VTextarea-BuIc6d95.js";import{V as it}from"./VSpacer-BCNmCEP9.js";import{V as st}from"./VDialog-DU1pBIct.js";import"./VAvatar-bHPDEsYY.js";import"./VImg-BS6_svHJ.js";import"./ssrBoot-BPhRU-mF.js";import"./createSimpleFunctional-DugzUcbB.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./dialog-transition-2hF0ajsQ.js";/* empty css              */import"./VField-CfH1YcVv.js";import"./VCheckboxBtn-CogF2AUK.js";const at={class:"d-flex flex-column gap-6"},lt={key:0,class:"text-center py-8"},ot={class:"mt-4"},nt={key:1},rt={class:"d-flex justify-space-between align-center mb-6"},dt={class:"d-flex align-center gap-4"},ut={class:"text-h4 font-weight-bold mb-1"},ct={class:"d-flex align-center gap-2"},mt={class:"d-flex gap-2"},_t={class:"mb-4"},pt={class:"text-body-2 text-medium-emphasis mb-1"},vt={class:"text-h6"},ft={class:"mb-4"},bt={class:"text-body-2 text-medium-emphasis mb-1"},gt={class:"text-body-1"},yt=["href"],xt={key:0,class:"mb-4"},ht={class:"text-body-2 text-medium-emphasis mb-1"},kt={class:"text-body-1"},Ct={class:"mb-4"},Vt={class:"text-body-2 text-medium-emphasis mb-1"},Tt={class:"text-h6"},wt={class:"mb-4"},St={class:"text-body-2 text-medium-emphasis mb-1"},At={class:"text-body-1"},Nt={key:0,class:"mb-4"},It={class:"text-body-2 text-medium-emphasis mb-1"},Rt={class:"text-body-1"},$t={class:"mb-4"},Dt={class:"text-body-2 text-medium-emphasis mb-1"},Et={class:"text-body-1"},Lt={class:"mb-4"},zt={class:"mb-4"},Pt={class:"text-body-2 text-medium-emphasis mb-1"},Ft={class:"text-body-1"},Mt={class:"mb-4"},jt={class:"text-body-2 text-medium-emphasis mb-1"},Ut={class:"text-body-1"},Ot={class:"mb-4"},Bt={class:"text-body-2 text-medium-emphasis mb-1"},qt={class:"mb-4"},Gt={class:"text-body-2 text-medium-emphasis mb-1"},Kt={class:"text-body-1"},Ht={class:"mb-4"},Wt={class:"text-body-2 text-medium-emphasis mb-1"},Yt={class:"text-h6"},Jt={class:"mb-4"},Qt={class:"text-body-1"},Xt={class:"text-body-1"},Zt={class:"text-body-2 text-medium-emphasis mb-1"},ei={class:"text-body-1"},ti={class:"text-body-1"},ii={class:"text-body-2"},si={class:"mb-4"},ai={class:"text-body-1"},li={class:"text-caption text-medium-emphasis"},oi={class:"mb-4"},ni={class:"text-body-1"},ri={class:"text-caption text-medium-emphasis"},di={class:"mb-4"},ui={class:"mb-4"},ci={class:"text-body-2 text-medium-emphasis mb-1"},mi={class:"text-h6"},_i={class:"text-center py-8"},pi={key:1},vi={class:"d-flex flex-column flex-md-row align-md-center justify-space-between gap-4 mb-4"},fi={class:"d-flex align-center gap-2"},bi={class:"d-flex align-center gap-2"},gi={key:0,class:"text-body-2 text-medium-emphasis"},yi={class:"mb-3"},xi={class:"text-body-1 font-weight-medium"},hi={class:"mb-3"},ki={class:"text-body-1"},Ci={class:"mb-3"},Vi={class:"text-body-1"},Ti={class:"mb-3"},wi={class:"text-body-1"},Si={class:"mb-3"},Ai={class:"text-h6 text-primary"},Ni={key:0},Ii={class:"d-flex flex-column flex-md-row align-md-center justify-space-between"},Ri={class:"text-body-1 font-weight-medium mb-1"},$i={key:0,class:"text-body-2 text-medium-emphasis mb-2"},Di={class:"text-body-2 text-medium-emphasis"},Ei={key:1,class:"text-center py-8"},Li={class:"text-center py-8"},zi={key:0},Pi={class:"mb-4"},Fi={class:"d-flex gap-2 mb-4"},Mi={key:1},ji={class:"mb-4"},Ui={class:"d-flex gap-2"},Oi={key:2,class:"text-center py-8"},Bi={class:"mb-4"},hs=Ee({__name:"index",setup(qi){const{t:u}=Le(),he=ze(),se=Pe(),I=Ue(),{confirm:H}=Oe(),{showSuccess:D,showError:T}=Be(),B=w("parcel"),P=w(null),E=w(!1),W=w(null),k=w("");w([]);const j=w(!1),q=w(!1),R=w(""),U=w(""),ke=z(()=>I.isLoading),l=z(()=>I.currentShippingOrder),Ce=z(()=>he.params.id),Y=async()=>{await I.fetchShippingOrder(Ce.value)},G=async()=>{var a,e;if((e=(a=l.value)==null?void 0:a.shipping_parcel)!=null&&e.tracking_number){E.value=!0;try{P.value=await I.getTracking(l.value.shipping_parcel.tracking_number),D(u("admin_shipping_tracking_success"))}catch(n){T(n.message||u("admin_shipping_tracking_error"))}finally{E.value=!1}}},Ve=async()=>{var a,e;if((e=(a=l.value)==null?void 0:a.shipping_parcel)!=null&&e.tracking_number)try{W.value=await I.getParcelInfo(l.value.shipping_parcel.tracking_number)}catch(n){T(n.message||u("admin_shipping_parcel_info_error"))}},Te=async()=>{if(await H({title:u("admin_shipping_delivery_note_create_confirm_title"),text:u("admin_shipping_delivery_note_create_confirm_text"),confirmText:u("admin_shipping_delivery_note_create_confirm_button"),color:"primary"}))try{const e=await I.createDeliveryNote();k.value=e,D(`Bon de livraison créé: ${e}`)}catch(e){T(e.message||u("admin_shipping_delivery_note_create_error"))}},we=async()=>{var e,n;if(!k.value||!((n=(e=l.value)==null?void 0:e.shipping_parcel)!=null&&n.tracking_number)){T(u("admin_shipping_delivery_note_required"));return}if(await H({title:"Ajouter le colis au bon de livraison",text:`Ajouter le colis ${l.value.shipping_parcel.tracking_number} au bon ${k.value} ?`,confirmText:"Ajouter",color:"primary"}))try{await I.addParcelsToDeliveryNote(k.value,[l.value.shipping_parcel.tracking_number]),D(u("admin_shipping_parcel_added"))}catch(c){T(c.message||u("admin_shipping_add_parcel_error"))}},Se=async()=>{if(!k.value){T(u("admin_shipping_delivery_note_no_save"));return}if(await H({title:"Sauvegarder le bon de livraison",text:`Sauvegarder le bon de livraison ${k.value} ?`,confirmText:"Sauvegarder",color:"success"}))try{await I.saveDeliveryNote(k.value),D(u("admin_shipping_delivery_note_saved")),await Y()}catch(e){T(e.message||u("admin_shipping_save_error"))}},F=(a,e)=>{let n="";switch(e){case"pdf":n=`https://client.ozoneexpress.ma/pdf-delivery-note?dn-ref=${a}`;break;case"a4":n=`https://client.ozoneexpress.ma/pdf-delivery-note-tickets?dn-ref=${a}`;break;case"100x100":n=`https://client.ozoneexpress.ma/pdf-delivery-note-tickets-4-4?dn-ref=${a}`;break}n&&window.open(n,"_blank")},Ae=()=>{var a,e;R.value=((e=(a=l.value)==null?void 0:a.shipping_parcel)==null?void 0:e.status)||"",U.value="",j.value=!0},Ne=async()=>{if(!(!R.value||!l.value)){q.value=!0;try{await I.updateShippingStatus(l.value.id,{status:R.value,note:U.value||void 0}),D(`Statut mis à jour vers: ${ae(R.value)}`+(R.value==="livree"?" (Commission créée automatiquement)":"")),j.value=!1,await Y()}catch(a){T(a.message||"Erreur lors de la mise à jour du statut")}finally{q.value=!1}}},Ie=()=>{j.value=!1,R.value="",U.value=""},Re=a=>{switch(a){case"created":return"info";case"in_transit":return"warning";case"delivered":return"success";case"returned":return"error";default:return"default"}},ae=a=>{switch(a){case"created":return"Créé";case"in_transit":return"En transit";case"delivered":return"Livré";case"returned":return u("order.status.returned");default:return a}},M=a=>new Intl.NumberFormat("fr-MA",{style:"currency",currency:"MAD"}).format(a),le=z(()=>{var a,e,n;return((n=(e=(a=P.value)==null?void 0:a.tracking_info)==null?void 0:e.TRACKING)==null?void 0:n["TRACKING-NUMBER"])||""}),K=z(()=>{var a,e,n;return((n=(e=(a=P.value)==null?void 0:a.tracking_info)==null?void 0:e.TRACKING)==null?void 0:n.LAST_TRACKING)||null}),oe=z(()=>{var e,n,c;const a=(c=(n=(e=P.value)==null?void 0:e.tracking_info)==null?void 0:n.TRACKING)==null?void 0:c.HISTORY;return a?Object.values(a).filter(b=>b&&b.TIME_STR).sort((b,g)=>new Date(g.TIME_STR).getTime()-new Date(b.TIME_STR).getTime()):[]}),L=z(()=>{var a,e,n;return((n=(e=(a=P.value)==null?void 0:a.parcel_info)==null?void 0:e.PARCEL_INFO)==null?void 0:n.INFOS)||null}),ne=a=>{if(!a)return"secondary";const e=a.toLowerCase();return e.includes("nouveau")||e.includes("créé")?"info":e.includes("en cours")||e.includes("transit")?"warning":e.includes("livré")?"success":e.includes(u("order.status.returned").toLowerCase())||e.includes("refusé")?"error":"secondary"},re=a=>{if(!a)return"";try{return new Date(a).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return a}},$e=async()=>{const a=le.value;if(a)try{await navigator.clipboard.writeText(a),D(u("admin_shipping_tracking_copied"))}catch{T(u("admin_shipping_copy_error"))}},de=()=>{se.push({name:"admin-orders-shipping"})},ue=()=>{var a,e,n,c,b,g;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.nom_complet)||((c=(n=l.value)==null?void 0:n.shipping_parcel)==null?void 0:c.receiver)||((g=(b=l.value)==null?void 0:b.client)==null?void 0:g.nom_complet)||"-"},J=()=>{var a,e,n,c,b,g;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.telephone)||((c=(n=l.value)==null?void 0:n.shipping_parcel)==null?void 0:c.phone)||((g=(b=l.value)==null?void 0:b.client)==null?void 0:g.telephone)||"-"},ce=()=>{var a,e,n,c;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.email)||((c=(n=l.value)==null?void 0:n.client)==null?void 0:c.email)||null},me=()=>{var a,e,n,c,b,g;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.ville)||((c=(n=l.value)==null?void 0:n.shipping_parcel)==null?void 0:c.city_name)||((g=(b=l.value)==null?void 0:b.adresse)==null?void 0:g.ville)||"-"},Q=()=>{var a,e,n,c,b,g;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.adresse)||((c=(n=l.value)==null?void 0:n.shipping_parcel)==null?void 0:c.address)||((g=(b=l.value)==null?void 0:b.adresse)==null?void 0:g.adresse)||"-"},_e=()=>{var a,e,n,c;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.code_postal)||((c=(n=l.value)==null?void 0:n.adresse)==null?void 0:c.code_postal)||null},pe=()=>{var a,e,n,c;return((e=(a=l.value)==null?void 0:a.client_final_data)==null?void 0:e.pays)||((c=(n=l.value)==null?void 0:n.adresse)==null?void 0:c.pays)||"MA"},De=async()=>{const a=`${ue()}
${J()}
${Q()}
${me()}, ${pe()}`;try{await navigator.clipboard.writeText(a),D(u("admin_shipping_address_copied"))}catch{T(u("admin_shipping_address_copy_failed"))}};return Fe(()=>{Y()}),(a,e)=>{var n,c,b,g,ve;return m(),y(xe,null,[i("div",at,[ke.value?(m(),y("div",lt,[t(ye,{indeterminate:"",color:"primary",size:"64"}),i("p",ot,o(p(u)("loading_order")),1)])):l.value?(m(),y("div",nt,[i("div",rt,[i("div",dt,[t(f,{icon:"tabler-arrow-left",variant:"text",onClick:de}),i("div",null,[i("h1",ut,o(p(u)("shipment"))+" "+o(l.value.id.slice(0,8)),1),i("div",ct,[(n=l.value.shipping_parcel)!=null&&n.tracking_number?(m(),C(V,{key:0,size:"small",color:"primary",variant:"tonal",class:"font-mono"},{default:s(()=>[r(o(l.value.shipping_parcel.tracking_number),1)]),_:1})):x("",!0),t(V,{size:"small",color:Re(((c=l.value.shipping_parcel)==null?void 0:c.status)||"unknown"),variant:"tonal"},{default:s(()=>{var d;return[r(o(ae(((d=l.value.shipping_parcel)==null?void 0:d.status)||"unknown")),1)]}),_:1},8,["color"]),t(V,{size:"small",color:(b=l.value.shipping_parcel)!=null&&b.sent_to_carrier?"primary":"warning",variant:"tonal"},{default:s(()=>{var d,_;return[t(v,{start:"",icon:(d=l.value.shipping_parcel)!=null&&d.sent_to_carrier?"tabler-truck":"tabler-package"},null,8,["icon"]),r(" "+o((_=l.value.shipping_parcel)!=null&&_.sent_to_carrier?p(u)("carrier"):p(u)("local")),1)]}),_:1},8,["color"]),t(V,{size:"small",color:"info",variant:"tonal"},{default:s(()=>{var d,_;return[r(o(((d=l.value.shipping_parcel)==null?void 0:d.city_name)||((_=l.value.adresse)==null?void 0:_.ville)||"-"),1)]}),_:1})])])]),i("div",mt,[t(f,{color:"info",variant:"outlined",onClick:G,loading:E.value},{default:s(()=>[t(v,{start:"",icon:"tabler-route"}),e[13]||(e[13]=r(" Tracking "))]),_:1,__:[13]},8,["loading"]),t(f,{color:"secondary",variant:"outlined",onClick:Ve},{default:s(()=>[t(v,{start:"",icon:"tabler-info-circle"}),e[14]||(e[14]=r(" Infos Colis "))]),_:1,__:[14]}),(g=l.value.shipping_parcel)!=null&&g.sent_to_carrier?x("",!0):(m(),C(f,{key:0,color:"warning",variant:"outlined",onClick:Ae},{default:s(()=>[t(v,{start:"",icon:"tabler-edit"}),e[15]||(e[15]=r(" Modifier Statut "))]),_:1,__:[15]})),(ve=l.value.shipping_parcel)!=null&&ve.delivery_note_ref?(m(),C(Ge,{key:1},{activator:s(({props:d})=>[t(f,Me({color:"primary",variant:"elevated"},d),{default:s(()=>[t(v,{start:"",icon:"tabler-file-download"}),e[16]||(e[16]=r(" PDFs "))]),_:2,__:[16]},1040)]),default:s(()=>[t(qe,null,{default:s(()=>[t(Z,{onClick:e[0]||(e[0]=d=>{var _;return F(((_=l.value.shipping_parcel)==null?void 0:_.delivery_note_ref)||"","pdf")})},{default:s(()=>[t(ee,null,{default:s(()=>e[17]||(e[17]=[r("PDF Standard")])),_:1,__:[17]})]),_:1}),t(Z,{onClick:e[1]||(e[1]=d=>{var _;return F(((_=l.value.shipping_parcel)==null?void 0:_.delivery_note_ref)||"","a4")})},{default:s(()=>[t(ee,null,{default:s(()=>e[18]||(e[18]=[r("Étiquettes A4")])),_:1,__:[18]})]),_:1}),t(Z,{onClick:e[2]||(e[2]=d=>{var _;return F(((_=l.value.shipping_parcel)==null?void 0:_.delivery_note_ref)||"","100x100")})},{default:s(()=>[t(ee,null,{default:s(()=>e[19]||(e[19]=[r("Étiquettes 100x100")])),_:1,__:[19]})]),_:1})]),_:1})]),_:1})):x("",!0)])]),t(Ke,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=d=>B.value=d),class:"mb-6"},{default:s(()=>[t(te,{value:"parcel"},{default:s(()=>[t(v,{start:"",icon:"tabler-package"}),e[20]||(e[20]=r(" Informations Colis "))]),_:1,__:[20]}),t(te,{value:"tracking"},{default:s(()=>[t(v,{start:"",icon:"tabler-route"}),e[21]||(e[21]=r(" Suivi "))]),_:1,__:[21]}),t(te,{value:"delivery-note"},{default:s(()=>[t(v,{start:"",icon:"tabler-file-text"}),e[22]||(e[22]=r(" Bon de Livraison "))]),_:1,__:[22]})]),_:1},8,["modelValue"]),t(He,{modelValue:B.value,"onUpdate:modelValue":e[9]||(e[9]=d=>B.value=d)},{default:s(()=>[t(ie,{value:"parcel"},{default:s(()=>[t(S,{class:"mb-6"},{default:s(()=>[t(A,{class:"d-flex align-center justify-space-between"},{default:s(()=>[i("span",null,o(a.$t("orders.client_final.title")),1),Q()?(m(),C(f,{key:0,size:"small",color:"primary",variant:"outlined","prepend-icon":"tabler-copy",onClick:De},{default:s(()=>[r(o(a.$t("orders.client_final.copy_address")),1)]),_:1})):x("",!0)]),_:1}),t(N,null,{default:s(()=>[t(O,null,{default:s(()=>[t(h,{cols:"12",md:"6"},{default:s(()=>[i("div",_t,[i("div",pt,o(a.$t("orders.client_final.name")),1),i("div",vt,o(ue()),1)]),i("div",ft,[i("div",bt,o(a.$t("orders.client_final.phone")),1),i("div",gt,[i("a",{href:`tel:${J()}`,class:"text-decoration-none"},o(J()),9,yt)])]),ce()?(m(),y("div",xt,[i("div",ht,o(a.$t("orders.client_final.email")),1),i("div",kt,o(ce()),1)])):x("",!0)]),_:1}),t(h,{cols:"12",md:"6"},{default:s(()=>[i("div",Ct,[i("div",Vt,o(a.$t("orders.client_final.city")),1),i("div",Tt,[t(V,{color:"secondary",variant:"tonal",size:"small"},{default:s(()=>[r(o(me()),1)]),_:1})])]),i("div",wt,[i("div",St,o(a.$t("orders.client_final.address")),1),i("div",At,o(Q()),1)]),_e()?(m(),y("div",Nt,[i("div",It,o(a.$t("orders.client_final.postal_code")),1),i("div",Rt,o(_e()),1)])):x("",!0),i("div",$t,[i("div",Dt,o(a.$t("orders.client_final.country")),1),i("div",Et,o(pe()),1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(O,null,{default:s(()=>[t(h,{cols:"12",md:"8"},{default:s(()=>[t(S,null,{default:s(()=>[t(A,null,{default:s(()=>[r(o(p(u)("labels.packageDetails")),1)]),_:1}),t(N,null,{default:s(()=>[t(O,null,{default:s(()=>[t(h,{cols:"12",md:"6"},{default:s(()=>[i("div",Lt,[e[23]||(e[23]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Numéro de suivi",-1)),t(V,{color:"primary",variant:"tonal",class:"font-mono"},{default:s(()=>[r(o(l.value.shipping_parcel.tracking_number),1)]),_:1})]),i("div",zt,[i("div",Pt,o(p(u)("recipient")),1),i("div",Ft,o(l.value.shipping_parcel.receiver),1)]),i("div",Mt,[i("div",jt,o(p(u)("phone")),1),i("div",Ut,o(l.value.shipping_parcel.phone),1)])]),_:1}),t(h,{cols:"12",md:"6"},{default:s(()=>[i("div",Ot,[i("div",Bt,o(p(u)("city")),1),t(V,{color:"info",variant:"tonal"},{default:s(()=>[r(o(l.value.shipping_parcel.city_name),1)]),_:1})]),i("div",qt,[i("div",Gt,o(p(u)("address")),1),i("div",Kt,o(l.value.shipping_parcel.address),1)]),i("div",Ht,[i("div",Wt,o(p(u)("price")),1),i("div",Yt,o(M(l.value.shipping_parcel.price||0)),1)])]),_:1})]),_:1}),t(Ye,{class:"my-4"}),i("div",Jt,[e[24]||(e[24]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Note",-1)),i("div",Qt,o(l.value.shipping_parcel.note||"Aucune note"),1)]),l.value.shipping_parcel.delivered_price?(m(),C(O,{key:0},{default:s(()=>[t(h,{cols:"4"},{default:s(()=>[e[25]||(e[25]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Prix livraison",-1)),i("div",Xt,o(M(l.value.shipping_parcel.delivered_price)),1)]),_:1,__:[25]}),t(h,{cols:"4"},{default:s(()=>[i("div",Zt,o(p(u)("labels.returnFee")),1),i("div",ei,o(M(l.value.shipping_parcel.returned_price||0)),1)]),_:1}),t(h,{cols:"4"},{default:s(()=>[e[26]||(e[26]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Prix refus",-1)),i("div",ti,o(M(l.value.shipping_parcel.refused_price||0)),1)]),_:1,__:[26]})]),_:1})):x("",!0)]),_:1})]),_:1}),W.value?(m(),C(S,{key:0,class:"mt-4"},{default:s(()=>[t(A,null,{default:s(()=>e[27]||(e[27]=[r("Informations API")])),_:1,__:[27]}),t(N,null,{default:s(()=>[i("pre",ii,o(JSON.stringify(W.value,null,2)),1)]),_:1})]),_:1})):x("",!0)]),_:1}),t(h,{cols:"12",md:"4"},{default:s(()=>[t(S,null,{default:s(()=>[t(A,null,{default:s(()=>e[28]||(e[28]=[r("Commande Originale")])),_:1,__:[28]}),t(N,null,{default:s(()=>{var d,_,$,fe,be,ge;return[i("div",si,[e[29]||(e[29]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Client",-1)),i("div",ai,o(((d=l.value.client)==null?void 0:d.nom_complet)||"-"),1),i("div",li,o(((_=l.value.client)==null?void 0:_.telephone)||"-"),1)]),i("div",oi,[e[30]||(e[30]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Affilié",-1)),i("div",ni,o(((fe=($=l.value.affilie)==null?void 0:$.utilisateur)==null?void 0:fe.nom_complet)||"-"),1),i("div",ri,o(((ge=(be=l.value.affilie)==null?void 0:be.utilisateur)==null?void 0:ge.email)||"-"),1)]),i("div",di,[e[31]||(e[31]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Boutique",-1)),t(V,{color:"info",variant:"tonal"},{default:s(()=>{var X;return[r(o(((X=l.value.boutique)==null?void 0:X.nom)||"-"),1)]}),_:1})]),i("div",ui,[i("div",ci,o(p(u)("admin_total")),1),i("div",mi,o(M(l.value.total_ttc||0)),1)]),t(f,{color:"primary",variant:"outlined",block:"",onClick:e[4]||(e[4]=X=>p(se).push({name:"admin-orders-pre-id",params:{id:l.value.id}}))},{default:s(()=>[r(o(p(u)("actions.viewOrder")),1)]),_:1})]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(ie,{value:"tracking"},{default:s(()=>[E.value?(m(),C(S,{key:0},{default:s(()=>[t(A,null,{default:s(()=>e[32]||(e[32]=[r("Suivi du Colis")])),_:1,__:[32]}),t(N,null,{default:s(()=>[i("div",_i,[t(ye,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),e[33]||(e[33]=i("h3",{class:"text-h6 mb-2"},"Récupération des données de suivi...",-1)),e[34]||(e[34]=i("p",{class:"text-body-2 text-medium-emphasis"}," Veuillez patienter pendant que nous récupérons les informations ",-1))])]),_:1})]),_:1})):P.value?(m(),y("div",pi,[t(S,{class:"mb-4"},{default:s(()=>[t(A,{class:"d-flex align-center justify-space-between"},{default:s(()=>[e[36]||(e[36]=i("span",null,"Suivi du Colis",-1)),t(f,{color:"primary",variant:"outlined",onClick:G,loading:E.value},{default:s(()=>[t(v,{start:"",icon:"tabler-refresh"}),e[35]||(e[35]=r(" Actualiser "))]),_:1,__:[35]},8,["loading"])]),_:1,__:[36]}),t(N,null,{default:s(()=>{var d,_;return[i("div",vi,[i("div",fi,[t(V,{color:"primary",variant:"tonal",class:"font-mono",size:"large"},{default:s(()=>[r(o(le.value),1)]),_:1}),t(f,{icon:"tabler-copy",variant:"text",size:"small",onClick:$e})]),i("div",bi,[t(V,{color:ne(((d=K.value)==null?void 0:d.STATUT)||""),variant:"tonal",size:"large"},{default:s(()=>{var $;return[r(o((($=K.value)==null?void 0:$.STATUT)||"Statut inconnu"),1)]}),_:1},8,["color"]),(_=K.value)!=null&&_.TIME_STR?(m(),y("div",gi," Mis à jour le "+o(re(K.value.TIME_STR)),1)):x("",!0)])]),L.value?(m(),C(O,{key:0},{default:s(()=>[t(h,{cols:"12",md:"6"},{default:s(()=>[i("div",yi,[e[37]||(e[37]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Destinataire",-1)),i("div",xi,o(L.value.RECEIVER||"-"),1)]),i("div",hi,[e[38]||(e[38]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Téléphone",-1)),i("div",ki,o(L.value.PHONE||"-"),1)])]),_:1}),t(h,{cols:"12",md:"6"},{default:s(()=>[i("div",Ci,[e[39]||(e[39]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Ville",-1)),i("div",Vi,o(L.value.CITY_NAME||"-"),1)]),i("div",Ti,[e[40]||(e[40]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Adresse",-1)),i("div",wi,o(L.value.ADDRESS||"-"),1)])]),_:1}),L.value.PRICE?(m(),C(h,{key:0,cols:"12"},{default:s(()=>[i("div",Si,[e[41]||(e[41]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Prix",-1)),i("div",Ai,o(M(parseFloat(L.value.PRICE)||0)),1)])]),_:1})):x("",!0)]),_:1})):x("",!0)]}),_:1})]),_:1}),t(S,null,{default:s(()=>[t(A,null,{default:s(()=>e[42]||(e[42]=[r("Historique du Suivi")])),_:1,__:[42]}),t(N,null,{default:s(()=>[oe.value.length>0?(m(),y("div",Ni,[t(Je,{side:"end",align:"start","truncate-line":"both",density:"compact"},{default:s(()=>[(m(!0),y(xe,null,je(oe.value,(d,_)=>(m(),C(Qe,{key:_,"dot-color":ne(d.STATUT),size:"small"},{icon:s(()=>{var $;return[t(v,{icon:($=d.STATUT)!=null&&$.toLowerCase().includes("livré")?"tabler-check":"tabler-package",size:"16"},null,8,["icon"])]}),default:s(()=>[i("div",Ii,[i("div",null,[i("div",Ri,o(d.STATUT),1),d.COMMENT?(m(),y("div",$i,o(d.COMMENT),1)):x("",!0)]),i("div",Di,o(re(d.TIME_STR)),1)])]),_:2},1032,["dot-color"]))),128))]),_:1})])):(m(),y("div",Ei,[t(v,{icon:"tabler-timeline",size:"64",class:"mb-4",color:"disabled"}),e[43]||(e[43]=i("h3",{class:"text-h6 mb-2"},"Aucun événement de suivi",-1)),e[44]||(e[44]=i("p",{class:"text-body-2 text-medium-emphasis"}," Aucun événement de suivi pour le moment. ",-1))]))]),_:1})]),_:1})])):(m(),C(S,{key:2},{default:s(()=>[t(A,{class:"d-flex align-center justify-space-between"},{default:s(()=>[e[46]||(e[46]=i("span",null,"Suivi du Colis",-1)),t(f,{color:"primary",variant:"outlined",onClick:G,loading:E.value},{default:s(()=>[t(v,{start:"",icon:"tabler-refresh"}),e[45]||(e[45]=r(" Récupérer le Suivi "))]),_:1,__:[45]},8,["loading"])]),_:1,__:[46]}),t(N,null,{default:s(()=>[i("div",Li,[t(v,{icon:"tabler-route",size:"64",class:"mb-4",color:"disabled"}),e[48]||(e[48]=i("h3",{class:"text-h6 mb-2"},"Aucune donnée de suivi",-1)),e[49]||(e[49]=i("p",{class:"text-body-2 text-medium-emphasis mb-4"},' Cliquez sur "Récupérer le Suivi" pour obtenir les informations de suivi ',-1)),t(f,{color:"primary",variant:"elevated",onClick:G,loading:E.value},{default:s(()=>[t(v,{start:"",icon:"tabler-route"}),e[47]||(e[47]=r(" Récupérer le Suivi "))]),_:1,__:[47]},8,["loading"])])]),_:1})]),_:1}))]),_:1}),t(ie,{value:"delivery-note"},{default:s(()=>[t(S,null,{default:s(()=>[t(A,null,{default:s(()=>e[50]||(e[50]=[r("Gestion du Bon de Livraison")])),_:1,__:[50]}),t(N,null,{default:s(()=>[l.value.shipping_parcel.delivery_note_ref?(m(),y("div",zi,[i("div",Pi,[e[51]||(e[51]=i("div",{class:"text-body-2 text-medium-emphasis mb-1"},"Référence du bon",-1)),t(V,{color:"success",variant:"tonal",class:"font-mono"},{default:s(()=>[r(o(l.value.shipping_parcel.delivery_note_ref),1)]),_:1})]),i("div",Fi,[t(f,{color:"primary",variant:"elevated",onClick:e[5]||(e[5]=d=>F(l.value.shipping_parcel.delivery_note_ref,"pdf"))},{default:s(()=>[t(v,{start:"",icon:"tabler-file-download"}),e[52]||(e[52]=r(" PDF Standard "))]),_:1,__:[52]}),t(f,{color:"secondary",variant:"outlined",onClick:e[6]||(e[6]=d=>F(l.value.shipping_parcel.delivery_note_ref,"a4"))},{default:s(()=>e[53]||(e[53]=[r(" Étiquettes A4 ")])),_:1,__:[53]}),t(f,{color:"info",variant:"outlined",onClick:e[7]||(e[7]=d=>F(l.value.shipping_parcel.delivery_note_ref,"100x100"))},{default:s(()=>e[54]||(e[54]=[r(" Étiquettes 100x100 ")])),_:1,__:[54]})])])):(m(),y("div",Mi,[t(Xe,{type:"info",variant:"tonal",class:"mb-4"},{default:s(()=>e[55]||(e[55]=[r(" Ce colis n'est pas encore associé à un bon de livraison ")])),_:1,__:[55]}),i("div",ji,[t(Ze,{modelValue:k.value,"onUpdate:modelValue":e[8]||(e[8]=d=>k.value=d),label:"Référence du bon de livraison",placeholder:p(u)("admin_shipping_delivery_note_placeholder"),variant:"outlined"},null,8,["modelValue","placeholder"])]),i("div",Ui,[t(f,{color:"primary",variant:"elevated",onClick:Te},{default:s(()=>[t(v,{start:"",icon:"tabler-file-plus"}),e[56]||(e[56]=r(" Créer Bon "))]),_:1,__:[56]}),t(f,{color:"secondary",variant:"outlined",disabled:!k.value,onClick:we},{default:s(()=>[t(v,{start:"",icon:"tabler-plus"}),e[57]||(e[57]=r(" Ajouter Colis "))]),_:1,__:[57]},8,["disabled"]),t(f,{color:"success",variant:"outlined",disabled:!k.value,onClick:Se},{default:s(()=>[t(v,{start:"",icon:"tabler-check"}),e[58]||(e[58]=r(" Sauvegarder "))]),_:1,__:[58]},8,["disabled"])])]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):(m(),y("div",Oi,[t(v,{icon:"tabler-alert-circle",size:"64",class:"mb-4",color:"error"}),e[59]||(e[59]=i("h3",{class:"text-h6 mb-2"},"Commande introuvable",-1)),e[60]||(e[60]=i("p",{class:"text-body-2 text-medium-emphasis mb-4"}," La commande demandée n'existe pas ou n'a pas été expédiée ",-1)),t(f,{color:"primary",variant:"elevated",onClick:de},{default:s(()=>[r(o(p(u)("actions.backToList")),1)]),_:1})]))]),t(st,{modelValue:j.value,"onUpdate:modelValue":e[12]||(e[12]=d=>j.value=d),"max-width":"500",persistent:""},{default:s(()=>[t(S,null,{default:s(()=>[t(A,{class:"text-h6"},{default:s(()=>[t(v,{start:"",icon:"tabler-edit",color:"warning"}),r(" "+o(p(u)("labels.modifyShippingStatus")),1)]),_:1}),t(N,null,{default:s(()=>[i("p",Bi,[r(o(p(u)("modify_local_shipment_status"))+" ",1),i("strong",null,o(p(u)("note"))+":",1),r(" "+o(p(u)("note_delivered_status_commission")),1)]),t(et,{modelValue:R.value,"onUpdate:modelValue":e[10]||(e[10]=d=>R.value=d),label:"Nouveau statut",items:[{title:"En attente",value:"pending"},{title:"Expédiée",value:"expediee"},{title:"Livrée",value:"livree"},{title:"Refusée",value:"refusee"},{title:p(u)("order.status.returned_feminine"),value:"retournee"},{title:"Annulée",value:"annulee"}],variant:"outlined",class:"mb-4"},null,8,["modelValue","items"]),t(tt,{modelValue:U.value,"onUpdate:modelValue":e[11]||(e[11]=d=>U.value=d),label:"Note (optionnelle)",placeholder:p(u)("admin_shipping_status_note_placeholder"),rows:"3",variant:"outlined"},null,8,["modelValue","placeholder"])]),_:1}),t(We,null,{default:s(()=>[t(it),t(f,{variant:"text",onClick:Ie,disabled:q.value},{default:s(()=>e[61]||(e[61]=[r(" Annuler ")])),_:1,__:[61]},8,["disabled"]),t(f,{color:"warning",variant:"elevated",loading:q.value,disabled:!R.value,onClick:Ne},{default:s(()=>[t(v,{start:"",icon:"tabler-check"}),e[62]||(e[62]=r(" Mettre à jour "))]),_:1,__:[62]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});export{hs as default};
