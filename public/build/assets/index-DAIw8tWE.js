import{d as fe,aL as ge,V as j,g as V,o as y,f as t,s as d,t as r,l as q,az as g,r as f,w as Ce,D as qe,b as e,m as c,e as _,a$ as Me,b0 as Re,j as it,b7 as rt,ai as nt,bb as ct,c as O,ac as h,aV as ut,b8 as dt,p as mt}from"./main-uLG9IIeX.js";import{u as pt}from"./tickets-DRUXQMK1.js";import{useQuickConfirm as _t}from"./useConfirmAction-C-KKQTYr.js";import{$ as Ae}from"./api-DSi3Suj8.js";import{V as re}from"./VChip-B84WcmDa.js";import{a as F,b as I,d as Fe,V as ft}from"./VList-uZDByhc2.js";import{V as ne}from"./VAvatar-bHPDEsYY.js";import{V as _e}from"./VImg-BS6_svHJ.js";import{V as Ie}from"./VAutocomplete-ZR_xQm-B.js";import{C as gt}from"./ConfirmActionDialog-uPYgr6qv.js";import{a as vt,V as yt}from"./VAlert-TgguXW_5.js";import{a as k,V as se}from"./VRow-aGfXYx3U.js";import{V as B,b as be,c as Ve}from"./VCard-CB1gT6RB.js";import{V as L}from"./VCardText-BZtszuIK.js";import{V as oe}from"./VTextField-Dxeq5kx5.js";import{V as we}from"./VDivider-UqGR4x4D.js";import{V as pe}from"./VSpacer-BCNmCEP9.js";import{V as ie}from"./VSelect-sWnAtot-.js";import{V as Le}from"./VCheckbox-BPY3LPcF.js";import{V as ht}from"./VDataTableServer-DfLBg0lg.js";import{V as kt}from"./VMenu-DP1p-55V.js";import{V as xe}from"./VDialog-DU1pBIct.js";import"./useNotifications-DDBS_wPD.js";import"./index-D-EbNoF1.js";import"./ssrBoot-BPhRU-mF.js";import"./createSimpleFunctional-DugzUcbB.js";import"./filter-D_SbaZWa.js";import"./VField-CfH1YcVv.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./VCheckboxBtn-CogF2AUK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css              */import"./dialog-transition-2hF0ajsQ.js";import"./VDataTable-DNqSzzrc.js";import"./VPagination-DYW6O4lq.js";import"./VTable-0U-NvIH3.js";const bt=fe({__name:"TicketStatusBadge",props:{status:{},size:{default:"small"},variant:{default:"tonal"}},setup(N){const z=N,{t:C}=ge(),o=x=>({open:"info",pending:"warning",waiting_user:"orange",waiting_third_party:"purple",resolved:"success",closed:"secondary"})[x]||"secondary",$=x=>({open:C("ticket_status_open"),pending:C("ticket_status_pending"),waiting_user:C("ticket_status_waiting_user"),waiting_third_party:C("ticket_status_waiting_third_party"),resolved:C("ticket_status_resolved"),closed:C("ticket_status_closed")})[x]||x,M=j(()=>o(z.status)),w=j(()=>$(z.status));return(x,U)=>(y(),V(re,{color:M.value,variant:x.variant,size:x.size},{default:t(()=>[d(r(w.value),1)]),_:1},8,["color","variant","size"]))}}),Vt=fe({__name:"TicketPriorityBadge",props:{priority:{},size:{default:"small"},variant:{default:"tonal"},showIcon:{type:Boolean,default:!1}},setup(N){const z=N,{t:C}=ge(),o=A=>({low:"success",normal:"info",high:"warning",urgent:"error"})[A]||"secondary",$=A=>({low:C("ticket_priority_low"),normal:C("ticket_priority_normal"),high:C("ticket_priority_high"),urgent:C("ticket_priority_urgent")})[A]||A,M=A=>({low:"tabler-arrow-down",normal:"tabler-minus",high:"tabler-arrow-up",urgent:"tabler-alert-triangle"})[A]||"tabler-minus",w=j(()=>o(z.priority)),x=j(()=>$(z.priority)),U=j(()=>M(z.priority));return(A,P)=>(y(),V(re,{color:w.value,variant:A.variant,size:A.size},{default:t(()=>[A.showIcon?(y(),V(g,{key:0,icon:U.value,size:A.size==="small"?14:16,class:"me-1"},null,8,["icon","size"])):q("",!0),d(" "+r(x.value),1)]),_:1},8,["color","variant","size"]))}}),wt={class:"d-flex align-center"},Te=fe({__name:"TicketAssigneeSelect",props:{modelValue:{},label:{default:"Assignee"},placeholder:{default:"Search for a user..."},clearable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},variant:{default:"outlined"},density:{default:"default"},hideDetails:{type:Boolean,default:!1},errorMessages:{}},emits:["update:modelValue"],setup(N,{expose:z,emit:C}){const o=N,$=C,{t:M}=ge(),w=f([]),x=f(!1),U=f(""),A=async v=>{if(!v||v.length<2){w.value=[];return}x.value=!0;try{const T=new URLSearchParams({search:v,per_page:"20",role:"admin"}),b=await Ae(`/admin/users?${T.toString()}`);if(console.log("ðŸ” [TicketAssigneeSelect] Search response:",b),b&&b.users&&Array.isArray(b.users)){const m=b.users.filter(p=>p.roles&&p.roles.some(R=>R.name==="admin"));w.value=m.map(p=>({...p,nom_complet:p.nom_complet||p.name||"Unknown User",email:p.email||"",photo_profil:p.photo_profil||null})),console.log("âœ… [TicketAssigneeSelect] Admin users found:",w.value.length)}else w.value=[]}catch(T){console.error("Failed to search users:",T),w.value=[]}finally{x.value=!1}},P=async()=>{x.value=!0;try{const v=new URLSearchParams({per_page:"50",role:"admin"}),T=await Ae(`/admin/users?${v.toString()}`);if(console.log("ðŸ” [TicketAssigneeSelect] Load admin users response:",T),T&&T.users&&Array.isArray(T.users)){const b=T.users.filter(m=>m.roles&&m.roles.some(p=>p.name==="admin"));w.value=b.map(m=>({...m,nom_complet:m.nom_complet||m.name||"Unknown User",email:m.email||"",photo_profil:m.photo_profil||null})),console.log("âœ… [TicketAssigneeSelect] Admin users loaded:",w.value.length)}else w.value=[]}catch(v){console.error("âŒ [TicketAssigneeSelect] Failed to load admin users:",v),w.value=[]}finally{x.value=!1}};let G=null;Ce(U,v=>{G&&clearTimeout(G),G=setTimeout(()=>{v?A(v):P()},300)}),qe(()=>{P()}),z({loadAdminUsers:P,refresh:P});const K=f(null);Ce(()=>o.modelValue,v=>{v?K.value=w.value.find(T=>T.id===v)||null:K.value=null},{immediate:!0});const ve=v=>{$("update:modelValue",(v==null?void 0:v.id)||null)};return(v,T)=>(y(),V(Ie,{"model-value":K.value,items:w.value,loading:x.value,label:v.label,placeholder:v.placeholder,clearable:v.clearable,disabled:v.disabled,variant:v.variant,density:v.density,"hide-details":v.hideDetails,"error-messages":v.errorMessages,"item-title":"nom_complet","item-value":"id","return-object":"","onUpdate:modelValue":ve,"onUpdate:search":T[0]||(T[0]=b=>U.value=b),onFocus:P},{item:t(({props:b,item:m})=>[e(F,Me(Re(b)),{prepend:t(()=>[e(ne,{size:"32"},{default:t(()=>[m.raw.photo_profil&&typeof m.raw.photo_profil=="string"?(y(),V(_e,{key:0,src:m.raw.photo_profil,alt:m.raw.nom_complet||"User"},null,8,["src","alt"])):(y(),V(g,{key:1,icon:"tabler-user",size:"18"}))]),_:2},1024)]),default:t(()=>[e(I,null,{default:t(()=>{var p;return[d(r(((p=m.raw)==null?void 0:p.nom_complet)||"Unknown User"),1)]}),_:2},1024),e(Fe,null,{default:t(()=>{var p;return[d(r(((p=m.raw)==null?void 0:p.email)||""),1)]}),_:2},1024)]),_:2},1040)]),selection:t(({item:b})=>[_("div",wt,[e(ne,{size:"24",class:"me-2"},{default:t(()=>[b.raw.photo_profil&&typeof b.raw.photo_profil=="string"?(y(),V(_e,{key:0,src:b.raw.photo_profil,alt:b.raw.nom_complet||"User"},null,8,["src","alt"])):(y(),V(g,{key:1,icon:"tabler-user",size:"14"}))]),_:2},1024),_("span",null,r(b.raw.nom_complet||"Unknown User"),1)])]),"no-data":t(()=>[e(F,null,{default:t(()=>[e(I,null,{default:t(()=>[d(r(U.value?c(M)("no_users_found"):c(M)("type_to_search")),1)]),_:1})]),_:1})]),_:1},8,["model-value","items","loading","label","placeholder","clearable","disabled","variant","density","hide-details","error-messages"]))}}),xt={key:1,class:"d-flex justify-center align-center",style:{"min-height":"400px"}},Tt={class:"ms-4"},Ct={key:2},At={class:"d-flex justify-space-between align-center mb-6"},Ut={class:"text-h4 font-weight-bold mb-1"},zt={class:"text-body-1 text-medium-emphasis mb-0"},$t={class:"text-h5 font-weight-bold"},Pt={class:"text-body-2 text-medium-emphasis"},Dt={class:"text-h5 font-weight-bold"},Et={class:"text-body-2 text-medium-emphasis"},Bt={class:"text-h5 font-weight-bold"},Lt={class:"text-body-2 text-medium-emphasis"},qt={class:"text-h5 font-weight-bold"},Mt={class:"text-body-2 text-medium-emphasis"},Rt={class:"text-h5 font-weight-bold"},Ft={class:"text-body-2 text-medium-emphasis"},It={class:"text-h5 font-weight-bold"},jt={class:"text-body-2 text-medium-emphasis"},St={class:"d-flex align-center gap-3 flex-wrap"},Ot={key:0,class:"d-flex align-center gap-2"},Nt={class:"d-flex flex-column"},Ht=["onClick"],Qt={key:0,class:"text-caption text-medium-emphasis"},Wt={key:0,class:"d-flex align-center"},Gt={class:"d-flex flex-column"},Kt={class:"text-body-2 font-weight-medium"},Yt={class:"text-caption text-medium-emphasis"},Jt={key:0,class:"d-flex align-center"},Xt={class:"d-flex flex-column"},Zt={class:"text-body-2 font-weight-medium"},el={class:"text-caption text-medium-emphasis"},tl={class:"d-flex flex-column"},ll={class:"text-body-2"},al={class:"text-caption text-medium-emphasis"},sl={class:"text-center py-8"},ol={class:"text-h6 mb-2"},il={class:"text-body-2 text-medium-emphasis mb-4"},Nl=fe({__name:"index",setup(N){const z=it(),{t:C}=ge();let o;const{confirm:$,confirmDelete:M,confirmBulkDelete:w,isDialogVisible:x,isLoading:U,dialogTitle:A,dialogText:P,dialogIcon:G,dialogColor:K,confirmButtonText:ve,cancelButtonText:v,handleConfirm:T,handleCancel:b}=_t();try{console.log("ðŸŽ« [Tickets] Initializing tickets store..."),o=pt(),console.log("âœ… [Tickets] Tickets store initialized successfully")}catch(i){console.error("ðŸš« [Tickets] Error initializing tickets store:",i),o={tickets:f([]),loading:f(!1),pagination:f({current_page:1,per_page:15,total:0}),filters:f({}),statistics:f(null),hasTickets:f(!1),totalTickets:f(0),fetchTickets:()=>Promise.resolve(),fetchStatistics:()=>Promise.resolve(),assignTicket:()=>Promise.resolve(),changeStatus:()=>Promise.resolve(),deleteTicket:()=>Promise.resolve(),bulkAction:()=>Promise.resolve()}}const m=f(!1),p=f([]),R=f(!1),Y=f(!1),J=f(!1),X=f(!1),H=f(null),Q=f(""),ce=f(null),Z=f(null),ee=f([]),ye=f(!1);f(!0);const W=f(!1),ue=f("");let te,le,de,n,ae,Ue,he;try{console.log("ðŸŽ« [Tickets] Accessing store refs...");const i=rt(o);te=i.tickets,le=i.loading,de=i.pagination,n=i.filters,ae=i.statistics,Ue=i.hasTickets,he=i.totalTickets,console.log("âœ… [Tickets] Store refs accessed successfully")}catch(i){console.error("ðŸš« [Tickets] Error accessing store refs:",i),te=f([]),le=f(!1),de=f({current_page:1,per_page:15,total:0}),n=f({}),ae=f(null),Ue=f(!1),he=f(0)}const S=j(()=>{try{return(ae==null?void 0:ae.value)||null}catch(i){return console.error("ðŸš« [Tickets] Error accessing statistics:",i),null}}),je=j(()=>{try{return(te==null?void 0:te.value)||[]}catch(i){return console.error("ðŸš« [Tickets] Error accessing tickets:",i),[]}}),Se=j(()=>{try{return(le==null?void 0:le.value)||!1}catch(i){return console.error("ðŸš« [Tickets] Error accessing loading state:",i),!1}}),a=(i,l)=>{try{return C(i)}catch(s){return console.error(`ðŸš« [Tickets] Translation error for key: ${i}`,s),l||i}},ze=[{title:a("ticket_status_open","Open"),value:"open"},{title:a("ticket_status_pending","Pending"),value:"pending"},{title:a("ticket_status_waiting_user","Waiting User"),value:"waiting_user"},{title:a("ticket_status_waiting_third_party","Waiting Third Party"),value:"waiting_third_party"},{title:a("ticket_status_resolved","Resolved"),value:"resolved"},{title:a("ticket_status_closed","Closed"),value:"closed"}],Oe=[{title:a("ticket_priority_low","Low"),value:"low"},{title:a("ticket_priority_normal","Normal"),value:"normal"},{title:a("ticket_priority_high","High"),value:"high"},{title:a("ticket_priority_urgent","Urgent"),value:"urgent"}],Ne=[{title:a("ticket_category_general","General"),value:"general"},{title:a("ticket_category_orders","Orders"),value:"orders"},{title:a("ticket_category_payments","Payments"),value:"payments"},{title:a("ticket_category_commissions","Commissions"),value:"commissions"},{title:a("ticket_category_kyc","KYC"),value:"kyc"},{title:a("ticket_category_technical","Technical"),value:"technical"},{title:a("ticket_category_other","Other"),value:"other"}],He=[{title:a("has_response","Has Response"),value:"true"},{title:a("no_response","No Response"),value:"false"}];a("sort_last_activity","Last Activity"),a("sort_created_date","Created Date"),a("sort_subject","Subject"),a("sort_priority","Priority"),a("sort_status","Status");const Qe=[{title:"",key:"select",sortable:!1,width:48},{title:a("ticket_ref","Ticket #"),key:"id",sortable:!1,width:120},{title:a("subject","Subject"),key:"subject",sortable:!0},{title:a("category","Category"),key:"category",sortable:!0,width:120},{title:a("priority","Priority"),key:"priority",sortable:!0,width:100},{title:a("status","Status"),key:"status",sortable:!0,width:120},{title:a("requester","Requester"),key:"requester",sortable:!1,width:180},{title:a("assignee","Assignee"),key:"assignee",sortable:!1,width:180},{title:a("last_activity","Last Activity"),key:"last_activity_at",sortable:!0,width:150},{title:a("actions","Actions"),key:"actions",sortable:!1,width:120}],$e=async()=>{var i;if(!m.value)try{U.value=!0,W.value=!1,ue.value="",o&&typeof o.fetchTickets=="function"&&await Promise.all([o.fetchTickets(),((i=o.fetchStatistics)==null?void 0:i.call(o))||Promise.resolve()])}catch(l){console.error("Error fetching tickets data:",l),W.value=!0,ue.value="Failed to load tickets data"}finally{m.value||(U.value=!1)}},We=i=>{var l;if(!m.value)try{(l=o==null?void 0:o.fetchTickets)==null||l.call(o,{q:i,page:1})}catch(s){console.error("Error handling search:",s)}},Pe=()=>{var i;if(!m.value)try{const l={...n==null?void 0:n.value};l.unassigned&&(l.unassigned=l.unassigned?"true":void 0),l.my_tickets&&(l.my_tickets=l.my_tickets?"true":void 0),(i=o==null?void 0:o.fetchTickets)==null||i.call(o,{...l,page:1})}catch(l){console.error("Error handling filter change:",l)}},De=()=>{var i;if(!m.value)try{n!=null&&n.value&&(n.value={page:1,per_page:15,sort:"last_activity_at",dir:"desc",q:"",status:[],priority:[],category:"",assignee_id:null,requester_id:null,date_from:"",date_to:"",activity_from:"",activity_to:"",has_response:"",unassigned:!1,my_tickets:!1}),ee.value=[],(i=o==null?void 0:o.fetchTickets)==null||i.call(o)}catch(l){console.error("Error clearing filters:",l)}},Ge=({key:i,order:l})=>{var s;if(!m.value)try{(s=o==null?void 0:o.fetchTickets)==null||s.call(o,{sort:i,dir:l==="asc"?"asc":"desc",page:1})}catch(D){console.error("Error handling sort:",D)}},Ke=i=>{var l;if(!m.value)try{(l=o==null?void 0:o.fetchTickets)==null||l.call(o,{page:i})}catch(s){console.error("Error handling page change:",s)}},ke=i=>{if(!m.value)try{z.push(`/admin/support/tickets/${i.id}`)}catch(l){console.error("Error navigating to ticket:",l)}},Ee=()=>{if(!m.value)try{z.push("/admin/support/tickets/create")}catch(i){console.error("Error navigating to create ticket:",i)}},Ye=async(i,l)=>{var s;if(!m.value)try{await((s=o==null?void 0:o.assignTicket)==null?void 0:s.call(o,i,l))}catch(D){console.error("Error assigning ticket:",D)}},Je=i=>{ce.value=i,Z.value=null,X.value=!0},Xe=async()=>{if(ce.value)try{await Ye(ce.value,Z.value),X.value=!1,ce.value=null,Z.value=null}catch(i){console.error("Error in individual assign:",i)}},Ze=async i=>{if(!i||i.length<2){ee.value=[];return}ye.value=!0;try{const l=new URLSearchParams({search:i,per_page:"20"}),s=await Ae(`/admin/users?${l.toString()}`);s.users&&(ee.value=s.users)}catch(l){console.error("Failed to search requesters:",l),ee.value=[]}finally{ye.value=!1}},me=i=>{if(!(m.value||!(n!=null&&n.value)))try{switch(De(),i){case"unassigned":n.value.unassigned=!0;break;case"my_tickets":n.value.my_tickets=!0;break;case"no_response":n.value.has_response="false";break;case"high_priority":n.value.priority=["high","urgent"];break}Pe()}catch(l){console.error("Error applying quick filter:",l)}},Be=async(i,l)=>{var s;if(!m.value)try{await((s=o==null?void 0:o.changeStatus)==null?void 0:s.call(o,i,l))}catch(D){console.error("Error changing ticket status:",D)}},et=async i=>{var l;if(!m.value)try{await M("ticket",i.subject)&&await((l=o==null?void 0:o.deleteTicket)==null?void 0:l.call(o,i.id))}catch(s){console.error("Error deleting ticket:",s)}},tt=()=>{Y.value=!0},lt=()=>{J.value=!0},at=async()=>{var i;if(!(m.value||p.value.length===0||!H.value))try{await($==null?void 0:$({title:a("confirm_bulk_assign_title","Confirm Bulk Assign"),text:a("confirm_bulk_assign_text",`Assign ${p.value.length} tickets?`),type:"info",confirmText:a("assign","Assign"),cancelText:a("cancel","Cancel"),icon:"tabler-user-check",color:"primary"}))&&(await((i=o==null?void 0:o.bulkAction)==null?void 0:i.call(o,"assign",p.value,{assignee_id:H.value})),p.value=[],H.value=null,Y.value=!1)}catch(l){console.error("Error in bulk assign:",l)}},st=async()=>{var i;if(!(m.value||p.value.length===0||!Q.value))try{await($==null?void 0:$({title:a("confirm_bulk_status_title","Confirm Status Change"),text:a("confirm_bulk_status_text",`Change status of ${p.value.length} tickets?`),type:"warning",confirmText:a("change_status","Change Status"),cancelText:a("cancel","Cancel"),icon:"tabler-edit",color:"warning"}))&&(await((i=o==null?void 0:o.bulkAction)==null?void 0:i.call(o,"status",p.value,{status:Q.value})),p.value=[],Q.value="",J.value=!1)}catch(l){console.error("Error in bulk status change:",l)}},ot=async()=>{var i;if(!(m.value||p.value.length===0))try{await w("tickets",p.value.length)&&(await((i=o==null?void 0:o.bulkAction)==null?void 0:i.call(o,"delete",p.value)),p.value=[])}catch(l){console.error("Error in bulk delete:",l)}};return Ce(()=>n==null?void 0:n.value,Pe,{deep:!0}),qe(async()=>{try{console.log("ðŸŽ« [Tickets] Component mounting..."),await nt(),m.value||(await $e(),console.log("ðŸŽ« [Tickets] Component mounted successfully"))}catch(i){console.error("ðŸš« [Tickets] Error during component mount:",i),W.value=!0,ue.value="Failed to initialize tickets page",setTimeout(()=>{m.value||z.push("/admin/dashboard").catch(console.error)},2e3)}}),ct(()=>{console.log("ðŸŽ« [Tickets] Component unmounting..."),m.value=!0,p.value=[],H.value=null,Q.value=""}),(i,l)=>(y(),O("div",null,[W.value?(y(),V(yt,{key:0,type:"error",variant:"tonal",class:"mb-6"},{append:t(()=>[e(h,{size:"small",variant:"outlined",onClick:$e},{default:t(()=>[d(r(a("retry","Retry")),1)]),_:1})]),default:t(()=>[e(vt,null,{default:t(()=>[d(r(a("error","Error")),1)]),_:1}),d(" "+r(ue.value)+" ",1)]),_:1})):q("",!0),c(U)&&!W.value?(y(),O("div",xt,[e(ut,{indeterminate:"",color:"primary",size:"64"}),_("span",Tt,r(a("loading_tickets","Loading tickets...")),1)])):W.value?q("",!0):(y(),O("div",Ct,[_("div",At,[_("div",null,[_("h1",Ut,r(a("support_tickets","Support Tickets")),1),_("p",zt,r(a("support_tickets_description","Manage customer support tickets")),1)]),e(h,{color:"primary",onClick:Ee},{default:t(()=>[e(g,{icon:"tabler-plus",class:"me-2"}),d(" "+r(a("create_ticket_admin","Create Ticket")),1)]),_:1})]),S.value?(y(),V(se,{key:0,class:"mb-6"},{default:t(()=>[e(k,{cols:"12",sm:"6",md:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(g,{icon:"tabler-ticket",size:"32",color:"info",class:"mb-2"}),_("div",$t,r(S.value.open||0),1),_("div",Pt,r(a("open_tickets","Open")),1)]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",sm:"6",md:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(g,{icon:"tabler-check",size:"32",color:"success",class:"mb-2"}),_("div",Dt,r(S.value.resolved||0),1),_("div",Et,r(a("resolved_tickets","Resolved")),1)]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",sm:"6",md:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(g,{icon:"tabler-x",size:"32",color:"secondary",class:"mb-2"}),_("div",Bt,r(S.value.closed||0),1),_("div",Lt,r(a("closed_tickets","Closed")),1)]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",sm:"6",md:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(g,{icon:"tabler-user-x",size:"32",color:"warning",class:"mb-2"}),_("div",qt,r(S.value.unassigned||0),1),_("div",Mt,r(a("unassigned_tickets","Unassigned")),1)]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",sm:"6",md:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(g,{icon:"tabler-alert-triangle",size:"32",color:"error",class:"mb-2"}),_("div",Rt,r(S.value.high_priority||0),1),_("div",Ft,r(a("high_priority_tickets","High Priority")),1)]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",sm:"6",md:"2"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(g,{icon:"tabler-sum",size:"32",color:"primary",class:"mb-2"}),_("div",It,r(S.value.total||0),1),_("div",jt,r(a("total_tickets","Total")),1)]),_:1})]),_:1})]),_:1})]),_:1})):q("",!0),e(B,{class:"mb-6"},{default:t(()=>[e(L,null,{default:t(()=>[e(se,null,{default:t(()=>[e(k,{cols:"12",md:"4"},{default:t(()=>{var s;return[e(oe,{"model-value":((s=c(n))==null?void 0:s.q)||"",label:a("search_tickets","Search tickets"),placeholder:a("search_placeholder","Search by subject, ID..."),variant:"outlined",density:"compact","prepend-inner-icon":"tabler-search",clearable:"","onUpdate:modelValue":We},null,8,["model-value","label","placeholder"])]}),_:1}),e(k,{cols:"12",md:"8"},{default:t(()=>[_("div",St,[e(h,{variant:"outlined",size:"small",color:R.value?"primary":"default",onClick:l[0]||(l[0]=s=>R.value=!R.value)},{default:t(()=>[e(g,{icon:"tabler-filter",class:"me-2"}),d(" "+r(a("filters","Filters")),1)]),_:1},8,["color"]),e(h,{variant:"outlined",size:"small",onClick:De},{default:t(()=>[e(g,{icon:"tabler-x",class:"me-2"}),d(" "+r(a("clear_filters","Clear")),1)]),_:1}),e(we,{vertical:"",class:"mx-2"}),e(h,{variant:"text",size:"small",color:"warning",onClick:l[1]||(l[1]=s=>me("unassigned"))},{default:t(()=>[e(g,{icon:"tabler-user-off",class:"me-1"}),d(" "+r(a("unassigned","Unassigned")),1)]),_:1}),e(h,{variant:"text",size:"small",color:"info",onClick:l[2]||(l[2]=s=>me("my_tickets"))},{default:t(()=>[e(g,{icon:"tabler-user-check",class:"me-1"}),d(" "+r(a("my_tickets","My Tickets")),1)]),_:1}),e(h,{variant:"text",size:"small",color:"error",onClick:l[3]||(l[3]=s=>me("no_response"))},{default:t(()=>[e(g,{icon:"tabler-message-off",class:"me-1"}),d(" "+r(a("no_response","No Response")),1)]),_:1}),e(h,{variant:"text",size:"small",color:"success",onClick:l[4]||(l[4]=s=>me("high_priority"))},{default:t(()=>[e(g,{icon:"tabler-alert-triangle",class:"me-1"}),d(" "+r(a("high_priority","High Priority")),1)]),_:1}),e(pe),p.value.length>0?(y(),O("div",Ot,[e(re,{color:"primary",size:"small"},{default:t(()=>[d(r(a("selected_count",`${p.value.length} selected`)),1)]),_:1}),e(h,{variant:"outlined",size:"small",color:"primary",onClick:tt},{default:t(()=>[e(g,{icon:"tabler-user-check",class:"me-2"}),d(" "+r(a("assign","Assign")),1)]),_:1}),e(h,{variant:"outlined",size:"small",color:"warning",onClick:lt},{default:t(()=>[e(g,{icon:"tabler-edit",class:"me-2"}),d(" "+r(a("change_status","Change Status")),1)]),_:1}),e(h,{variant:"outlined",size:"small",color:"error",onClick:ot},{default:t(()=>[e(g,{icon:"tabler-trash",class:"me-2"}),d(" "+r(a("delete","Delete")),1)]),_:1})])):q("",!0)])]),_:1})]),_:1}),e(dt,null,{default:t(()=>[R.value?(y(),V(se,{key:0,class:"mt-4"},{default:t(()=>[e(k,{cols:"12",md:"3"},{default:t(()=>[e(ie,{modelValue:c(n).status,"onUpdate:modelValue":l[5]||(l[5]=s=>c(n).status=s),items:ze,label:a("status","Status"),variant:"outlined",density:"compact",multiple:"",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(ie,{modelValue:c(n).priority,"onUpdate:modelValue":l[6]||(l[6]=s=>c(n).priority=s),items:Oe,label:a("priority","Priority"),variant:"outlined",density:"compact",multiple:"",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(ie,{modelValue:c(n).category,"onUpdate:modelValue":l[7]||(l[7]=s=>c(n).category=s),items:Ne,label:a("category","Category"),variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(Te,{modelValue:c(n).assignee_id,"onUpdate:modelValue":l[8]||(l[8]=s=>c(n).assignee_id=s),label:a("assignee","Assignee"),variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1})):q("",!0),R.value?(y(),V(se,{key:1,class:"mt-2"},{default:t(()=>[e(k,{cols:"12",md:"3"},{default:t(()=>[e(Ie,{modelValue:c(n).requester_id,"onUpdate:modelValue":l[9]||(l[9]=s=>c(n).requester_id=s),items:ee.value,loading:ye.value,label:a("requester","Requester"),variant:"outlined",density:"compact",clearable:"","item-title":"nom_complet","item-value":"id",placeholder:"Search requesters...","onUpdate:search":Ze},{item:t(({props:s,item:D})=>[e(F,Me(Re(s)),{prepend:t(()=>[e(ne,{size:"24"},{default:t(()=>[e(g,{icon:"tabler-user",size:"14"})]),_:1})]),default:t(()=>[e(I,null,{default:t(()=>[d(r(D.raw.nom_complet),1)]),_:2},1024),e(Fe,null,{default:t(()=>[d(r(D.raw.email),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","loading","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(oe,{modelValue:c(n).date_from,"onUpdate:modelValue":l[10]||(l[10]=s=>c(n).date_from=s),label:a("date_from","Date From"),variant:"outlined",density:"compact",type:"date",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(oe,{modelValue:c(n).date_to,"onUpdate:modelValue":l[11]||(l[11]=s=>c(n).date_to=s),label:a("date_to","Date To"),variant:"outlined",density:"compact",type:"date",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(ie,{modelValue:c(n).has_response,"onUpdate:modelValue":l[12]||(l[12]=s=>c(n).has_response=s),items:He,label:a("response_status","Response Status"),variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1})):q("",!0),R.value?(y(),V(se,{key:2,class:"mt-2"},{default:t(()=>[e(k,{cols:"12",md:"3"},{default:t(()=>[e(oe,{modelValue:c(n).activity_from,"onUpdate:modelValue":l[13]||(l[13]=s=>c(n).activity_from=s),label:a("activity_from","Activity From"),variant:"outlined",density:"compact",type:"date",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(oe,{modelValue:c(n).activity_to,"onUpdate:modelValue":l[14]||(l[14]=s=>c(n).activity_to=s),label:a("activity_to","Activity To"),variant:"outlined",density:"compact",type:"date",clearable:""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(Le,{modelValue:c(n).unassigned,"onUpdate:modelValue":l[15]||(l[15]=s=>c(n).unassigned=s),label:a("unassigned_only","Unassigned Only"),density:"compact","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(Le,{modelValue:c(n).my_tickets,"onUpdate:modelValue":l[16]||(l[16]=s=>c(n).my_tickets=s),label:a("my_tickets_only","My Tickets Only"),density:"compact","hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})):q("",!0)]),_:1})]),_:1})]),_:1}),e(B,null,{default:t(()=>{var s,D;return[e(ht,{modelValue:p.value,"onUpdate:modelValue":l[17]||(l[17]=u=>p.value=u),headers:Qe,items:je.value,loading:Se.value,"items-length":c(he)||0,"items-per-page":((s=c(de))==null?void 0:s.per_page)||15,page:((D=c(de))==null?void 0:D.current_page)||1,"item-value":"id","show-select":"","onUpdate:options":Ge,"onUpdate:page":Ke},{"item.id":t(({item:u})=>[e(h,{variant:"text",size:"small",color:"primary",onClick:E=>ke(u)},{default:t(()=>{var E;return[d(" #"+r(((E=u.id)==null?void 0:E.toString().slice(-8))||"N/A"),1)]}),_:2},1032,["onClick"])]),"item.subject":t(({item:u})=>[_("div",Nt,[_("span",{class:"font-weight-medium cursor-pointer",onClick:E=>ke(u)},r(u.subject||"No Subject"),9,Ht),u.messages_count?(y(),O("div",Qt,r(a("messages_count",`${u.messages_count} messages`)),1)):q("",!0)])]),"item.category":t(({item:u})=>[e(re,{size:"small",variant:"tonal"},{default:t(()=>[d(r(a(`ticket_category_${u.category}`,u.category)),1)]),_:2},1024)]),"item.priority":t(({item:u})=>[e(Vt,{priority:u.priority,"show-icon":""},null,8,["priority"])]),"item.status":t(({item:u})=>[e(bt,{status:u.status},null,8,["status"])]),"item.requester":t(({item:u})=>[u.requester?(y(),O("div",Wt,[e(ne,{size:"32",class:"me-2"},{default:t(()=>[u.requester.photo_profil?(y(),V(_e,{key:0,src:u.requester.photo_profil,alt:u.requester.nom_complet},null,8,["src","alt"])):(y(),V(g,{key:1,icon:"tabler-user",size:"18"}))]),_:2},1024),_("div",Gt,[_("span",Kt,r(u.requester.nom_complet),1),_("span",Yt,r(u.requester.email),1)])])):q("",!0)]),"item.assignee":t(({item:u})=>[u.assignee?(y(),O("div",Jt,[e(ne,{size:"32",class:"me-2"},{default:t(()=>[u.assignee.photo_profil?(y(),V(_e,{key:0,src:u.assignee.photo_profil,alt:u.assignee.nom_complet},null,8,["src","alt"])):(y(),V(g,{key:1,icon:"tabler-user",size:"18"}))]),_:2},1024),_("div",Xt,[_("span",Zt,r(u.assignee.nom_complet),1),_("span",el,r(u.assignee.email),1)])])):(y(),V(re,{key:1,size:"small",variant:"outlined",color:"warning"},{default:t(()=>[d(r(a("unassigned","Unassigned")),1)]),_:1}))]),"item.last_activity_at":t(({item:u})=>[_("div",tl,[_("span",ll,r(new Date(u.last_activity_at).toLocaleDateString()),1),_("span",al,r(new Date(u.last_activity_at).toLocaleTimeString()),1)])]),"item.actions":t(({item:u})=>[e(kt,null,{activator:t(({props:E})=>[e(h,mt({icon:"tabler-dots-vertical",variant:"text",size:"small"},E),null,16)]),default:t(()=>[e(ft,null,{default:t(()=>[e(F,{onClick:E=>ke(u)},{prepend:t(()=>[e(g,{icon:"tabler-eye"})]),default:t(()=>[e(I,null,{default:t(()=>[d(r(a("view","View")),1)]),_:1})]),_:2},1032,["onClick"]),e(F,{onClick:E=>Je(u.id)},{prepend:t(()=>[e(g,{icon:"tabler-user-check"})]),default:t(()=>[e(I,null,{default:t(()=>[d(r(a("assign","Assign")),1)]),_:1})]),_:2},1032,["onClick"]),e(we),e(F,{onClick:E=>Be(u.id,"resolved")},{prepend:t(()=>[e(g,{icon:"tabler-check"})]),default:t(()=>[e(I,null,{default:t(()=>[d(r(a("mark_resolved","Mark Resolved")),1)]),_:1})]),_:2},1032,["onClick"]),e(F,{onClick:E=>Be(u.id,"closed")},{prepend:t(()=>[e(g,{icon:"tabler-x"})]),default:t(()=>[e(I,null,{default:t(()=>[d(r(a("mark_closed","Mark Closed")),1)]),_:1})]),_:2},1032,["onClick"]),e(we),e(F,{onClick:E=>et(u),class:"text-error"},{prepend:t(()=>[e(g,{icon:"tabler-trash"})]),default:t(()=>[e(I,null,{default:t(()=>[d(r(a("delete","Delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),"no-data":t(()=>[_("div",sl,[e(g,{icon:"tabler-ticket-off",size:"64",class:"mb-4",color:"disabled"}),_("h3",ol,r(a("no_tickets_found","No tickets found")),1),_("p",il,r(a("no_tickets_description","No tickets match your current filters")),1),e(h,{color:"primary",onClick:Ee},{default:t(()=>[e(g,{icon:"tabler-plus",class:"me-2"}),d(" "+r(a("create_first_ticket","Create First Ticket")),1)]),_:1})])]),_:1},8,["modelValue","items","loading","items-length","items-per-page","page"])]}),_:1}),e(xe,{modelValue:Y.value,"onUpdate:modelValue":l[20]||(l[20]=s=>Y.value=s),"max-width":"400"},{default:t(()=>[e(B,null,{default:t(()=>[e(be,null,{default:t(()=>[d(r(a("bulk_assign_tickets","Bulk Assign Tickets")),1)]),_:1}),e(L,null,{default:t(()=>[e(Te,{modelValue:H.value,"onUpdate:modelValue":l[18]||(l[18]=s=>H.value=s),label:a("select_assignee","Select Assignee")},null,8,["modelValue","label"])]),_:1}),e(Ve,null,{default:t(()=>[e(pe),e(h,{onClick:l[19]||(l[19]=s=>Y.value=!1)},{default:t(()=>[d(r(a("cancel","Cancel")),1)]),_:1}),e(h,{color:"primary",onClick:at},{default:t(()=>[d(r(a("assign","Assign")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(xe,{modelValue:X.value,"onUpdate:modelValue":l[23]||(l[23]=s=>X.value=s),"max-width":"400"},{default:t(()=>[e(B,null,{default:t(()=>[e(be,null,{default:t(()=>[d(r(a("assign_ticket","Assign Ticket")),1)]),_:1}),e(L,null,{default:t(()=>[e(Te,{modelValue:Z.value,"onUpdate:modelValue":l[21]||(l[21]=s=>Z.value=s),label:a("select_assignee","Select Assignee")},null,8,["modelValue","label"])]),_:1}),e(Ve,null,{default:t(()=>[e(pe),e(h,{onClick:l[22]||(l[22]=s=>X.value=!1)},{default:t(()=>[d(r(a("cancel","Cancel")),1)]),_:1}),e(h,{color:"primary",onClick:Xe},{default:t(()=>[d(r(a("assign","Assign")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(xe,{modelValue:J.value,"onUpdate:modelValue":l[26]||(l[26]=s=>J.value=s),"max-width":"400"},{default:t(()=>[e(B,null,{default:t(()=>[e(be,null,{default:t(()=>[d(r(a("bulk_change_status","Bulk Change Status")),1)]),_:1}),e(L,null,{default:t(()=>[e(ie,{modelValue:Q.value,"onUpdate:modelValue":l[24]||(l[24]=s=>Q.value=s),items:ze,label:a("select_status","Select Status"),variant:"outlined"},null,8,["modelValue","label"])]),_:1}),e(Ve,null,{default:t(()=>[e(pe),e(h,{onClick:l[25]||(l[25]=s=>J.value=!1)},{default:t(()=>[d(r(a("cancel","Cancel")),1)]),_:1}),e(h,{color:"primary",onClick:st},{default:t(()=>[d(r(a("change_status","Change Status")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])),e(gt,{"is-dialog-visible":c(x),"is-loading":c(U),"dialog-title":c(A),"dialog-text":c(P),"dialog-icon":c(G),"dialog-color":c(K),"confirm-button-text":c(ve),"cancel-button-text":c(v),onConfirm:c(T),onCancel:c(b)},null,8,["is-dialog-visible","is-loading","dialog-title","dialog-text","dialog-icon","dialog-color","confirm-button-text","cancel-button-text","onConfirm","onCancel"])]))}});export{Nl as default};
