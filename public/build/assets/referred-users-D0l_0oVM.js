import{d as E,aL as K,k as L,r as _,V as $,o as A,c as G,b as M,f as o,e as t,v as n,n as s,g as r,t as f,cG as O,ac as w,az as V,b6 as C}from"./main-3LuWNv9W.js";import{b as q,V as k}from"./VCard-QqgF9aMj.js";import{V as U}from"./VCardText-Dqaeyxp0.js";import{V as z,a as m}from"./VRow-aVZbYr4A.js";import{V as g}from"./VTextField-CsO1UfXI.js";import{V as h}from"./VSelect-V4QjM3w5.js";import{V as H}from"./VDataTableServer-BIt2YTB3.js";import{V as S}from"./VChip-D2hyzrT3.js";import{V as T}from"./VAvatar-CH3JpKwD.js";import"./createSimpleFunctional-CbZg_Do-.js";import"./VImg-DjZhnPY1.js";/* empty css              */import"./VField-CzoZXYxi.js";import"./forwardRefs-BZg6tG7B.js";import"./VList-DWKF8cD-.js";import"./ssrBoot-DPE17Lki.js";import"./VDivider-D28qXVrs.js";import"./dialog-transition-TWAYErkS.js";import"./VMenu-cCaIVuKn.js";import"./VOverlay-DHKe6cTP.js";import"./lazy-vcHGEOxt.js";import"./VCheckboxBtn-BQUGQfLA.js";import"./VDataTable-Dz5dOo4J.js";import"./VPagination-C9G78dYZ.js";import"./VTable-Dyn4MLHa.js";import"./filter-DJ4i-HET.js";const J={class:"d-flex justify-space-between align-center mb-6"},P={class:"text-h4 font-weight-bold mb-1"},Q={class:"text-body-1 mb-0"},W={class:"d-flex gap-2"},X={class:"d-flex align-center"},Y={class:"font-weight-medium"},Z={class:"text-body-2 text-medium-emphasis"},ee={class:"d-flex align-center"},te={class:"font-weight-medium"},ae={class:"text-body-2 text-medium-emphasis"},re={class:"text-center py-8"},le={class:"text-h6 mb-2"},se={class:"text-body-2"},Re=E({__name:"referred-users",setup(oe){const{t:l}=K();L();const v=_(!1),y=_([]),u=_({current_page:1,last_page:1,per_page:15,total:0}),d=_({search:"",referrer_id:"",verified:null,start_date:"",end_date:"",source:""}),x=_([]),D=$(()=>[{title:l("referred_user"),key:"new_user",sortable:!1},{title:l("referrer"),key:"referrer",sortable:!1},{title:l("signup_date"),key:"attributed_at",sortable:!0},{title:l("verification_status"),key:"verified",sortable:!0},{title:l("source"),key:"source",sortable:!0}]),p=async(i=1)=>{v.value=!0;try{const a={page:i,per_page:u.value.per_page,...d.value};Object.keys(a).forEach(b=>{(a[b]===""||a[b]===null)&&delete a[b]});const e=await C.get("/admin/referrals/referred-users",{params:a});e.data.success&&(y.value=e.data.data,u.value=e.data.pagination)}catch(a){console.error("Failed to fetch referred users:",a)}finally{v.value=!1}},B=async()=>{try{const i=await C.get("/admin/affiliates",{params:{per_page:100}});i.data.success&&(x.value=i.data.data.map(a=>({value:a.id,title:`${a.nom_complet} (${a.email})`})))}catch(i){console.error("Failed to fetch referrers:",i)}},c=()=>{u.value.current_page=1,p()},F=()=>{d.value={search:"",referrer_id:"",verified:null,start_date:"",end_date:"",source:""},p()},R=i=>new Date(i).toLocaleDateString(),I=i=>i?"success":"warning",N=i=>l(i?"verified":"pending_verification"),j=i=>i==="mobile"?"info":"primary";return A(()=>{p(),B()}),(i,a)=>(M(),G("div",null,[o("div",J,[o("div",null,[o("h1",P,n(s(l)("referred_users")),1),o("p",Q,n(s(l)("referred_users_subtitle")),1)])]),t(k,{class:"mb-6"},{default:r(()=>[t(q,null,{default:r(()=>[f(n(s(l)("filters")),1)]),_:1}),t(U,null,{default:r(()=>[t(z,null,{default:r(()=>[t(m,{cols:"12",md:"3"},{default:r(()=>[t(g,{modelValue:d.value.search,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value.search=e),label:s(l)("search_users"),placeholder:s(l)("search_by_name_email"),"prepend-inner-icon":"tabler-search",clearable:"",onKeyup:O(c,["enter"])},null,8,["modelValue","label","placeholder"])]),_:1}),t(m,{cols:"12",md:"3"},{default:r(()=>[t(h,{modelValue:d.value.referrer_id,"onUpdate:modelValue":[a[1]||(a[1]=e=>d.value.referrer_id=e),c],items:x.value,label:s(l)("referrer"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(m,{cols:"12",md:"2"},{default:r(()=>[t(h,{modelValue:d.value.verified,"onUpdate:modelValue":[a[2]||(a[2]=e=>d.value.verified=e),c],items:[{value:!0,title:s(l)("verified")},{value:!1,title:s(l)("unverified")}],label:s(l)("verification_status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(m,{cols:"12",md:"2"},{default:r(()=>[t(h,{modelValue:d.value.source,"onUpdate:modelValue":[a[3]||(a[3]=e=>d.value.source=e),c],items:[{value:"web",title:s(l)("web")},{value:"mobile",title:s(l)("mobile")}],label:s(l)("source"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(m,{cols:"12",md:"2"},{default:r(()=>[o("div",W,[t(w,{color:"primary",onClick:c},{default:r(()=>[f(n(s(l)("search")),1)]),_:1}),t(w,{variant:"outlined",onClick:F},{default:r(()=>[f(n(s(l)("clear")),1)]),_:1})])]),_:1})]),_:1}),t(z,{class:"mt-2"},{default:r(()=>[t(m,{cols:"12",md:"3"},{default:r(()=>[t(g,{modelValue:d.value.start_date,"onUpdate:modelValue":a[4]||(a[4]=e=>d.value.start_date=e),type:"date",label:s(l)("start_date"),onChange:c},null,8,["modelValue","label"])]),_:1}),t(m,{cols:"12",md:"3"},{default:r(()=>[t(g,{modelValue:d.value.end_date,"onUpdate:modelValue":a[5]||(a[5]=e=>d.value.end_date=e),type:"date",label:s(l)("end_date"),onChange:c},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),t(k,null,{default:r(()=>[t(U,null,{default:r(()=>[t(H,{page:u.value.current_page,"onUpdate:page":[a[6]||(a[6]=e=>u.value.current_page=e),p],headers:D.value,items:y.value,"items-length":u.value.total,"items-per-page":u.value.per_page,loading:v.value,class:"text-no-wrap"},{"item.new_user":r(({item:e})=>[o("div",X,[t(T,{size:"32",class:"me-3"},{default:r(()=>[t(V,{icon:"tabler-user"})]),_:1}),o("div",null,[o("div",Y,n(e.new_user_name),1),o("div",Z,n(e.new_user_email),1)])])]),"item.referrer":r(({item:e})=>[o("div",ee,[t(T,{size:"32",class:"me-3",color:"primary",variant:"tonal"},{default:r(()=>[t(V,{icon:"tabler-user-star"})]),_:1}),o("div",null,[o("div",te,n(e.affiliate_name),1),o("div",ae,n(e.affiliate_email),1)])])]),"item.attributed_at":r(({item:e})=>[f(n(R(e.attributed_at)),1)]),"item.verified":r(({item:e})=>[t(S,{color:I(e.verified),size:"small"},{default:r(()=>[f(n(N(e.verified)),1)]),_:2},1032,["color"])]),"item.source":r(({item:e})=>[t(S,{color:j(e.source),size:"small"},{default:r(()=>[f(n(e.source),1)]),_:2},1032,["color"])]),"no-data":r(()=>[o("div",re,[t(V,{icon:"tabler-users-off",size:"64",class:"mb-4",color:"disabled"}),o("h6",le,n(s(l)("no_referred_users")),1),o("p",se,n(s(l)("no_referred_users_description")),1)])]),_:1},8,["page","headers","items","items-length","items-per-page","loading"])]),_:1})]),_:1})]))}});export{Re as default};
