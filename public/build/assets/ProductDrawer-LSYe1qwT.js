import{b5 as He,r as x,ca as Pe,V as w,d as je,aL as Ue,w as ce,h as $,b as u,g,f as a,e as i,m as C,aU as Se,az as Q,t as z,v as l,aW as Ce,ac as G,c as y,F as ae,j as oe,q as Ye,x as Ve,n as r,G as Ze,o as We,at as Je,cT as Ke,ai as ea}from"./main-3LuWNv9W.js";import{V as he,c as qe}from"./VCard-QqgF9aMj.js";import{V as ze}from"./VImg-DjZhnPY1.js";import{V as W}from"./VChip-D2hyzrT3.js";import{V as Re}from"./VTooltip-DeQJuQst.js";import{V as Ee}from"./VCardText-Dqaeyxp0.js";import{_ as Qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as fe}from"./useApi-C6mAvy3D.js";import{u as Ge}from"./useNotifications-B3v5F4dH.js";import{u as aa,V as ta,a as la}from"./VNavigationDrawer-DA7Dgz6f.js";import{V as oa}from"./VSpacer-Ckvg-9-2.js";import{V as sa}from"./VDialog-DuTMUR2U.js";import{V as ia,a as Oe}from"./VRow-aVZbYr4A.js";import{V as ra,a as Fe}from"./VRadioGroup-DYdfkKR-.js";import{V as we}from"./VAlert-cTzgSexk.js";import{V as Be}from"./VTextField-CsO1UfXI.js";import{V as na}from"./VTable-Dyn4MLHa.js";import{V as ca}from"./VAvatar-CH3JpKwD.js";const Xe=He("affiliate-catalogue",()=>{const ie=x([]),re=x(null),d=x(!1),J=x(!1),s=x(null),t=Pe({current_page:1,last_page:1,per_page:12,total:0,from:0,to:0}),P=Pe({q:"",category_id:"",min_profit:void 0,color:"",size:"",page:1,per_page:12}),X=x({items_count:0,total_amount:0}),Z=x(null),R=x(null),L=x(!1),q=x(null),K=x(null),te=x(null),E=x(1),A=x(0),U=x({}),S=x([]),H=x([]),o=x([]),ee=(e,c)=>{const p=(e==null?void 0:e.trim())||"âˆ…",m=(c==null?void 0:c.trim())||"âˆ…";return`${p}|${m}`},ue=e=>{U.value={},S.value=[],H.value=[],o.value=[];const c=new Set,p=new Map;e.forEach(m=>{const{type:M,color:I,size:f,id:j,stock_available:T,image_url:ne}=m,D=ee(I,f);U.value[D]={id:j,stock_available:T||0,image_url:ne},f&&c.add(f),I&&p.set(I,{name:I,swatch:I,image_url:ne}),I&&f&&o.value.push({qty:T||0,color:I,size:f})}),S.value=Array.from(c).sort((m,M)=>{const I=["XS","S","M","L","XL","2XL","3XL","4XL","5XL"],f=I.indexOf(m),j=I.indexOf(M);return f!==-1&&j!==-1?f-j:f!==-1?-1:j!==-1?1:m.localeCompare(M)}),H.value=Array.from(p.values()).sort((m,M)=>m.name.localeCompare(M.name)),o.value.sort((m,M)=>{const I=["XS","S","M","L","XL","2XL","3XL","4XL","5XL"],f=I.indexOf(m.size),j=I.indexOf(M.size);if(f!==j){if(f!==-1&&j!==-1)return f-j;if(f!==-1)return-1;if(j!==-1)return 1}return m.color.localeCompare(M.color)})},ye=w(()=>ie.value.length>0),n=w(()=>d.value),O=w(()=>J.value),Y=w(()=>t.total),{showSuccess:h,showError:k}=Ge(),F=e=>{var j,T,ne,D;console.log("ðŸ”„ [Store] Mapping product to normalized:",e.id,{title:e.titre,images:e.images,variantes:e.variantes,variants:e.variants});const c=((T=(j=e.images)==null?void 0:j[0])==null?void 0:T.url)||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzE2MS4wNDYgMTAwIDE3MCA5MC45NTQzIDE3MCA4MEM1NyA2OS4wNDU3IDE0Ny45NTQgNjAgMTM2IDYwQzEyNC45NTQgNjAgMTE2IDY5LjA0NTcgMTE2IDgwQzExNiA5MC45NTQzIDEyNC45NTQgMTAwIDEzNiAxMDBIMTUwWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMTgwIDEyMEgxMjBDMTE2LjY4NiAxMjAgMTE0IDEyMi42ODYgMTE0IDEyNlYyMDBDMTE0IDIwMy4zMTQgMTE2LjY4NiAyMDYgMTIwIDIwNkgxODBDMTgzLjMxNCAyMDYgMTg2IDIwMy4zMTQgMTg2IDIwMFYxMjZDMTg2IDEyMi42ODYgMTgzLjMxNCAxMjAgMTgwIDEyMFoiIGZpbGw9IiNDQ0NDQ0MiLz4KPC9zdmc+";console.log("ðŸ–¼ï¸ [Store] Main image extracted:",c);let p=[],m=[],M=[],I=[];const f=e.variants;if(f&&(f.sizes||f.colors))console.log("ðŸŽ¯ [Store] Using API-parsed variants:",f),f.sizes&&Array.isArray(f.sizes)&&(p=f.sizes.filter(N=>N.stock>0),I=p.map(N=>N.value)),f.colors&&Array.isArray(f.colors)&&(m=f.colors.filter(N=>N.stock>0),M=m.map(N=>({name:N.value,swatch:N.color||N.value,image_url:N.image_url})));else{console.log("ðŸ”§ [Store] Manually parsing variants from variantes array");const N=new Set,me=new Map;(ne=e.variantes)==null||ne.forEach(b=>{var ge,pe;const le=b.stock||0;if(le<=0)return;const ve=(ge=b.attribut_principal)==null?void 0:ge.toLowerCase();if(console.log("ðŸ”§ [Store] Processing variant:",{id:b.id,attribut_principal:b.attribut_principal,valeur:b.valeur,stock:le,attributCode:ve,color:b.color,image_url:b.image_url}),(pe=b.valeur)!=null&&pe.includes(" - ")){const[_e,De]=b.valeur.split(" - ");_e&&me.set(_e,{name:_e,swatch:b.color||_e,image_url:b.image_url||void 0}),De&&N.add(De),_e&&m.push({id:b.id,value:_e,color:b.color||void 0,image_url:b.image_url||void 0,stock:le}),De&&p.push({id:b.id,value:De,stock:le})}else["taille","size"].includes(ve)?(N.add(b.valeur),p.push({id:b.id,value:b.valeur,stock:le})):["couleur","color"].includes(ve)&&(me.set(b.valeur,{name:b.valeur,swatch:b.color||b.valeur,image_url:b.image_url||void 0}),m.push({id:b.id,value:b.valeur,color:b.color||void 0,image_url:b.image_url||void 0,stock:le}))}),M=Array.from(me.values()).sort((b,le)=>b.name.localeCompare(le.name)),I=Array.from(N).sort((b,le)=>{const ve=["XS","S","M","L","XL","2XL","3XL","4XL","5XL"],ge=ve.indexOf(b),pe=ve.indexOf(le);return ge!==-1&&pe!==-1?ge-pe:ge!==-1?-1:pe!==-1?1:b.localeCompare(le)})}return console.log("âœ… [Store] Final normalized product:",{id:e.id,mainImage:c,colors:M,sizes:I,variantSizes:p,variantColors:m,totalVariants:((D=e.variantes)==null?void 0:D.length)||0}),{id:e.id,titre:e.titre,categorie:e.categorie,mainImage:c,prix_achat:e.prix_achat,prix_vente:e.prix_vente,prix_affilie:e.prix_affilie,stock_total:e.stock_total,quantite_min:e.quantite_min||1,rating_value:e.rating_value||0,variants:{sizes:p,colors:m},colors:M,sizes:I,variantsByCombo:{},slug:e.slug,description:e.description}},B=(e,c)=>{var m;const p=(m=e.colors)==null?void 0:m.find(M=>M.name===c);return p!=null&&p.image_url?p.image_url:e.mainImage},se=async e=>{d.value=!0,s.value=null;try{const c={...P,...e},p=new URLSearchParams(Object.entries(c).filter(([j,T])=>T!==void 0&&T!=="").map(([j,T])=>[j,String(T)])).toString(),m=p?`/affiliate/catalogue?${p}`:"/affiliate/catalogue",{data:M,error:I}=await fe(m);if(I.value)throw I.value;const f=M.value;if(f){const j=f.data||[];ie.value=j.map(T=>F(T)),f.meta&&Object.assign(t,{current_page:f.meta.current_page,last_page:f.meta.last_page,per_page:f.meta.per_page,total:f.meta.total,from:f.meta.from,to:f.meta.to})}}catch(c){s.value=c.message||"Erreur lors du chargement du catalogue",k(s.value||"Erreur inconnue")}finally{d.value=!1}},Ae=async e=>{J.value=!0,s.value=null;try{const{data:c,error:p}=await fe(`/affiliate/catalogue/${e}`,{method:"GET"});if(p.value)throw p.value;c.value&&(re.value=c.value)}catch(c){s.value=c.message||"Erreur lors du chargement du produit",k(s.value||"Erreur inconnue")}finally{J.value=!1}},Ne=async e=>{try{const{data:c,error:p}=await fe("/affiliate/cart/items",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(p.value)throw p.value;return h("Produit ajoutÃ© au panier"),await be(),c.value}catch(c){const p=c.message||"Erreur lors de l'ajout au panier";throw k(p),c}},be=async()=>{try{const{data:e,error:c}=await fe("/affiliate/cart/summary",{method:"GET"});if(c.value)throw c.value;e.value&&(X.value=e.value)}catch(e){console.error("Error fetching cart summary:",e)}},Me=e=>{Object.assign(P,e),P.page=1},xe=()=>{Object.assign(P,{q:"",category_id:"",min_profit:void 0,color:"",size:"",page:1,per_page:12})},de=()=>{re.value=null},$e=e=>{P.page=e},Le=async e=>{Z.value=e,J.value=!0,s.value=null;try{const{data:c,error:p}=await fe(`/affiliate/catalogue/${e}`);if(p.value){s.value=p.value.message||"Failed to fetch product details",k(s.value||"Failed to fetch product details");return}if(c.value){const m=c.value;R.value=Ie(m),ue(m.variantes||[]),q.value=null,K.value=null,te.value=null,E.value=m.quantite_min||1,A.value=0}}catch(c){s.value=c.message||"Failed to fetch product details",k(s.value||"Failed to fetch product details")}finally{J.value=!1}},Ie=e=>{var f,j,T,ne;const c=((f=e.images)==null?void 0:f.sort((D,N)=>D.ordre-N.ordre))||[],p=((j=c[0])==null?void 0:j.url)||"",m=[],M=[],I=[];return(T=e.variantes)==null||T.forEach(D=>{var me,b;const N=((me=D.attribut)==null?void 0:me.code)||((b=D.attribut_principal)==null?void 0:b.toLowerCase());["taille","size"].includes(N)?m.push({id:D.id,value:D.valeur,stock:D.stock}):["couleur","color"].includes(N)&&M.push({id:D.id,name:D.valeur,swatch:D.color||D.swatch,image_url:D.image_url||void 0,stock:D.stock}),I.push({size:["taille","size"].includes(N)?D.valeur:void 0,color:["couleur","color"].includes(N)?D.valeur:void 0,stock:D.stock,variant_id:D.id})}),{id:e.id,ref:e.ref,titre:e.titre,sku:e.sku,description:e.description,copywriting:e.copywriting,notes_admin:e.notes_admin,prix_achat:e.prix_achat,prix_vente:e.prix_vente,prix_affilie:e.prix_affilie,stock_total:e.stock_total,stock_fake:e.stock_fake,quantite_min:e.quantite_min||1,rating_value:e.rating_value,categorie:e.categorie,gallery:{main:p,thumbnails:c},sizes:m.sort((D,N)=>D.value.localeCompare(N.value)),colors:M.sort((D,N)=>D.name.localeCompare(N.name)),matrix:I,images:c,videos:((ne=e.videos)==null?void 0:ne.map(D=>({id:D.id,url:D.url,title:D.titre||D.title})))||[],variantes:e.variantes}},ke=(e,c)=>{var M,I;const p=ee(e,c),m=U.value[p];if(m){te.value=m.id,A.value=m.stock_available;const f=((M=R.value)==null?void 0:M.quantite_min)||1;E.value>A.value?E.value=Math.max(f,Math.min(A.value,f)):E.value<f&&(E.value=f)}else te.value=null,A.value=0,E.value=((I=R.value)==null?void 0:I.quantite_min)||1};return{items:ie,selectedProduct:re,loading:d,detailLoading:J,error:s,pagination:t,filters:P,cartSummary:X,selectedId:Z,drawerProduct:R,addingToCart:L,selectedColor:q,selectedSize:K,selectedVariantId:te,selectedQty:E,maxQty:A,variantsByCombo:U,sizes:S,colors:H,matrixRows:o,hasItems:ye,isLoading:n,isDetailLoading:O,totalItems:Y,fetchList:se,fetchOne:Ae,addToCart:Ne,fetchCartSummary:be,updateFilters:Me,resetFilters:xe,clearSelectedProduct:de,setPage:$e,mapProductToNormalized:F,imageForColor:B,fetchOneForDrawer:Le,selectColor:e=>{q.value=e,ke(q.value,K.value);const c=U.value[ee(e,null)];c!=null&&c.image_url&&R.value&&(R.value.gallery.main=c.image_url)},selectSize:e=>{K.value=e,ke(q.value,K.value)},addToCartFromDrawer:async e=>{var c;L.value=!0;try{const{data:p,error:m}=await fe("/affiliate/cart/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(m.value){if(m.value.status===422){const M=((c=m.value.data)==null?void 0:c.message)||"Stock insuffisant ou donnÃ©es invalides";k(M)}else m.value.status===404?k("Produit non trouvÃ©"):k(m.value.message||"Erreur lors de l'ajout au panier");return!1}return p.value?(await be(),!0):!1}catch(p){return k(p.message||"Erreur lors de l'ajout au panier"),!1}finally{L.value=!1}}}}),ua={class:"catalogue-card__image-container"},da={class:"d-flex align-center justify-center fill-height bg-grey-lighten-4"},ma={key:0,class:"mb-2"},va={class:"d-flex align-center gap-1 flex-wrap"},ga={class:"text-caption"},pa={key:1,class:"mb-3"},_a={class:"d-flex align-center gap-1 flex-wrap"},fa={key:2,class:"mb-2"},ha={class:"text-caption d-flex align-center"},ya={class:"mb-3"},ba={class:"d-flex align-center justify-space-between mb-2"},xa={class:"text-body-2 text-medium-emphasis"},ka={class:"font-weight-medium"},wa={class:"text-body-2 text-medium-emphasis"},Ca={class:"font-weight-medium"},za={class:"text-primary font-weight-bold mb-2"},Ma={key:3,class:"text-caption text-warning mb-2"},Ia={class:"text-body-1 font-weight-medium catalogue-card__title mb-1"},Da={key:4,class:"mb-1"},Ta={class:"d-flex align-center justify-space-between mb-2"},Sa={class:"text-caption text-medium-emphasis"},Va={key:0,class:"d-flex align-center"},Ea={class:"text-caption font-weight-medium"},Te="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzE2MS4wNDYgMTAwIDE3MCA5MC45NTQzIDE3MCA4MEM1NyA2OS4wNDU3IDE0Ny45NTQgNjAgMTM2IDYwQzEyNC45NTQgNjAgMTE2IDY5LjA0NTcgMTE2IDgwQzExNiA5MC45NTQzIDEyNC45NTQgMTAwIDEzNiAxMDBIMTUwWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMTgwIDEyMEgxMjBDMTE2LjY4NiAxMjAgMTE0IDEyMi42ODYgMTE0IDEyNlYyMDBDMTE0IDIwMy4zMTQgMTE2LjY4NiAyMDYgMTIwIDIwNkgxODBDMTgzLjMxNCAyMDYgMTg2IDIwMy4zMTQgMTg2IDIwMFYxMjZDMTg2IDEyMi42ODYgMTgzLjMxNCAxMjAgMTgwIDEyMFoiIGZpbGw9IiNDQ0NDQ0MiLz4KPC9zdmc+",Aa=je({__name:"CatalogueCard",props:{product:{}},emits:["open","addToCart","variantChange","qtyChange"],setup(ie,{emit:re}){const d=ie,J=re,{t:s}=Ue();Xe(),x(!1);const t=x(""),P=x(""),X=x(1);ce(()=>d.product.quantite_min,n=>{n&&X.value<n&&(X.value=n)},{immediate:!0});const Z=x(""),R=x(!0),L=x(!1),q=w(()=>d.product.stock_total===0?"error":d.product.stock_total<10?"warning":"primary"),K=w(()=>d.product.stock_total===0?s("catalogue.card.out_of_stock"):d.product.stock_total.toString()),te=w(()=>`+${Math.max(0,(d.product.prix_vente||0)-(d.product.prix_achat||0)).toFixed(2)} MAD`),E=w(()=>{var O,Y;const n=[];return console.log("ðŸŽ¨ [CatalogueCard] Computing color swatches for product:",d.product.id,{enhancedColors:d.product.colors,variantColors:(O=d.product.variants)==null?void 0:O.colors}),d.product.colors&&d.product.colors.length>0?d.product.colors.forEach(h=>{var F,B;const k=(B=(F=d.product.variants)==null?void 0:F.colors)==null?void 0:B.find(se=>se.value===h.name);k&&k.stock>0&&n.push({id:k.id,name:h.name,swatch:h.swatch||k.color,stock:k.stock})}):(Y=d.product.variants)!=null&&Y.colors&&d.product.variants.colors.forEach(h=>{h.stock>0&&n.push({id:h.id,name:h.value,swatch:h.color,stock:h.stock})}),console.log("ðŸŽ¨ [CatalogueCard] Final color swatches:",n),n}),A=w(()=>{var O,Y;const n=[];return console.log("ðŸ“ [CatalogueCard] Computing size chips for product:",d.product.id,{enhancedSizes:d.product.sizes,variantSizes:(O=d.product.variants)==null?void 0:O.sizes}),d.product.sizes&&d.product.sizes.length>0?d.product.sizes.forEach(h=>{var F,B;const k=(B=(F=d.product.variants)==null?void 0:F.sizes)==null?void 0:B.find(se=>se.value===h);k&&k.stock>0&&n.push({id:k.id,value:h,stock:k.stock})}):(Y=d.product.variants)!=null&&Y.sizes&&d.product.variants.sizes.forEach(h=>{h.stock>0&&n.push(h)}),console.log("ðŸ“ [CatalogueCard] Final size chips:",n),n});ce(()=>d.product.mainImage,n=>{var O,Y,h,k,F,B;console.log("ðŸ–¼ï¸ [CatalogueCard] Image watch triggered:",{productId:d.product.id,newImage:n,hasColors:(O=d.product.colors)==null?void 0:O.length,hasVariantColors:(h=(Y=d.product.variants)==null?void 0:Y.colors)==null?void 0:h.length,hasSizes:(k=d.product.sizes)==null?void 0:k.length,hasVariantSizes:(B=(F=d.product.variants)==null?void 0:F.sizes)==null?void 0:B.length}),n?(Z.value=n,R.value=!0,L.value=!1):(Z.value=Te,R.value=!1,L.value=!1)},{immediate:!0});const U=w(()=>t.value?A.value.find(n=>n.id===t.value):P.value?E.value.find(n=>n.id===P.value):null),S=w(()=>{var Y;let n=d.product.stock_total;U.value&&(n=U.value.stock);const O=Math.min(n,10);return console.log("ðŸ“Š [CatalogueCard] Max quantity calculated:",{productId:d.product.id,totalStock:d.product.stock_total,selectedVariant:U.value,variantStock:(Y=U.value)==null?void 0:Y.stock,finalMax:O}),O});w(()=>{const n=d.product.stock_total>0&&X.value<=S.value;return A.value.length>0&&E.value.length>0?n&&t.value&&P.value:A.value.length>0?n&&t.value:E.value.length>0?n&&P.value:n});const H=n=>{t.value=n,J("variantChange",n)},o=n=>{var Y,h,k;P.value=n,console.log("ðŸŽ¨ [CatalogueCard] Color selected:",n);const O=E.value.find(F=>F.id===n);if(O){console.log("ðŸŽ¨ [CatalogueCard] Found color:",O);const F=(h=(Y=d.product.variants)==null?void 0:Y.colors)==null?void 0:h.find(B=>B.id===n);if(F!=null&&F.image_url)console.log("ðŸ–¼ï¸ [CatalogueCard] Using variant image:",F.image_url),Z.value=F.image_url,R.value=!0,L.value=!1;else{const B=(k=d.product.colors)==null?void 0:k.find(se=>se.name===O.name);B!=null&&B.image_url?(console.log("ðŸ–¼ï¸ [CatalogueCard] Using enhanced color image:",B.image_url),Z.value=B.image_url,R.value=!0,L.value=!1):(console.log("ðŸ–¼ï¸ [CatalogueCard] No variant image, using main image"),Z.value=d.product.mainImage)}}J("variantChange",n)},ee=()=>{J("open",d.product.id)};ce(()=>d.product.id,()=>{t.value="",P.value="",X.value=d.product.quantite_min||1,Z.value=d.product.mainImage});const ue=()=>{R.value=!1,L.value=!1},ye=()=>{R.value=!1,L.value=!0,console.log("âŒ [CatalogueCard] Image failed to load:",Z.value),Z.value!==Te&&(Z.value=Te)};return(n,O)=>(u(),$(he,{class:"catalogue-card",elevation:"2",onClick:ee},{default:g(()=>[a("div",ua,[i(ze,{src:Z.value||Te,alt:n.product.titre,"aspect-ratio":"1.2",cover:"",class:"catalogue-card__image",onLoad:ue,onError:ye},{placeholder:g(()=>[a("div",da,[R.value&&!L.value?(u(),$(Se,{key:0,indeterminate:"",color:"primary",size:"40"})):L.value?(u(),$(Q,{key:1,icon:"tabler-photo-off",size:"40",color:"grey"})):C("",!0)])]),_:1},8,["src","alt"]),i(W,{color:q.value,size:"small",variant:"elevated",class:"catalogue-card__stock-badge"},{default:g(()=>[z(l(K.value),1)]),_:1},8,["color"]),i(G,{icon:"",size:"small",variant:"elevated",color:"primary",class:"catalogue-card__eye-btn",onClick:Ce(ee,["stop"])},{default:g(()=>[i(Q,{icon:"tabler-eye"})]),_:1})]),i(Ee,{class:"catalogue-card__content pa-3"},{default:g(()=>{var Y;return[E.value.length?(u(),y("div",ma,[a("div",va,[(u(!0),y(ae,null,oe(E.value.slice(0,3),(h,k)=>(u(),$(W,{key:h.id||k,color:P.value===h.id?"primary":"default",variant:P.value===h.id?"flat":"outlined",size:"small",class:"color-chip cursor-pointer",onClick:Ce(F=>o(h.id),["stop"])},{default:g(()=>[h.swatch?(u(),$(Q,{key:0,style:Ze({color:h.swatch}),icon:"tabler-circle-filled",start:"",size:"14"},null,8,["style"])):C("",!0),a("span",ga,l(h.name),1)]),_:2},1032,["color","variant","onClick"]))),128)),E.value.length>3?(u(),$(Re,{key:0,location:"top"},{activator:g(({props:h})=>[i(W,Ye(h,{size:"small",variant:"outlined",class:"text-caption"}),{default:g(()=>[z(" +"+l(E.value.length-3),1)]),_:2},1040)]),default:g(()=>[a("span",null,l(E.value.slice(3).map(h=>h.name).join(", ")),1)]),_:1})):C("",!0)])])):C("",!0),A.value.length?(u(),y("div",pa,[a("div",_a,[(u(!0),y(ae,null,oe(A.value.slice(0,5),h=>(u(),$(W,{key:h.id,color:t.value===h.id?"primary":"default",variant:t.value===h.id?"flat":"outlined",size:"small",class:"size-chip",onClick:Ce(k=>H(h.id),["stop"])},{default:g(()=>[z(l(h.value),1)]),_:2},1032,["color","variant","onClick"]))),128))])])):C("",!0),A.value.length>0&&E.value.length>0?(u(),y("div",fa,[a("div",ha,[i(Q,{icon:t.value&&P.value?"tabler-check-circle":"tabler-circle",color:t.value&&P.value?"success":"default",size:"14",class:"me-1"},null,8,["icon","color"]),a("span",{class:Ve(t.value&&P.value?"text-success":"text-medium-emphasis")},l(t.value&&P.value?"Variantes sÃ©lectionnÃ©es":"SÃ©lectionnez taille et couleur"),3)])])):C("",!0),a("div",ya,[i(G,{color:"primary",variant:"flat",size:"small",block:"",onClick:Ce(ee,["stop"])},{default:g(()=>[i(Q,{icon:"tabler-shopping-cart",class:"me-2"}),z(" "+l(r(s)("catalogue.order_button")),1)]),_:1})]),a("div",ba,[a("div",xa,[z(l(r(s)("catalogue.buy"))+": ",1),a("span",ka,l(n.product.prix_achat)+" Ø¯Ø±Ù‡Ù…",1)]),a("div",wa,[z(l(r(s)("catalogue.sell"))+": ",1),a("span",Ca,l(n.product.prix_vente)+" Ø¯Ø±Ù‡Ù…",1)])]),a("div",za,l(te.value)+" "+l(r(s)("catalogue.profit")),1),n.product.quantite_min&&n.product.quantite_min>1?(u(),y("div",Ma,[i(Q,{icon:"tabler-info-circle",size:"14",class:"me-1"}),z(" "+l(r(s)("catalogue.minimum_quantity",{quantity:n.product.quantite_min})),1)])):C("",!0),a("h6",Ia,l(n.product.titre),1),n.product.sku?(u(),y("div",Da,[i(W,{size:"x-small",color:"secondary",variant:"outlined",class:"font-mono"},{default:g(()=>[z(l(n.product.sku),1)]),_:1})])):C("",!0),a("div",Ta,[a("div",Sa,l(((Y=n.product.categorie)==null?void 0:Y.nom)||"Sans catÃ©gorie"),1),n.product.rating_value?(u(),y("div",Va,[i(Q,{icon:"tabler-star-filled",size:"14",color:"warning",class:"me-1"}),a("span",Ea,l(n.product.rating_value.toFixed(1)),1)])):C("",!0)])]}),_:1})]),_:1}))}}),Sl=Qe(Aa,[["__scopeId","data-v-a8dc0daa"]]),Na={class:"d-flex align-center justify-space-between w-100"},$a={key:0,class:"text-white"},La={class:"d-flex align-center gap-2"},ja={class:"d-flex align-center justify-center fill-height"},Qa={class:"d-flex gap-2"},Pa=je({__name:"ImageZoomModal",props:{modelValue:{type:Boolean},images:{},initialIndex:{default:0}},emits:["update:modelValue"],setup(ie,{emit:re}){const d=ie,J=re,s=x(d.initialIndex),t=x(!1),P=x(),X=w({get:()=>d.modelValue,set:S=>J("update:modelValue",S)}),Z=w(()=>d.images[s.value]||null),R=w(()=>s.value>0),L=w(()=>s.value<d.images.length-1),q=w(()=>d.images.length>1),K=()=>{X.value=!1,t.value=!1},te=()=>{R.value&&(s.value--,t.value=!1)},E=()=>{L.value&&(s.value++,t.value=!1)},A=()=>{t.value=!t.value},U=S=>{if(X.value)switch(S.key){case"Escape":K();break;case"ArrowLeft":te();break;case"ArrowRight":E();break;case" ":case"Enter":S.preventDefault(),A();break}};return ce(()=>d.modelValue,S=>{S&&(s.value=d.initialIndex,t.value=!1)}),ce(()=>d.initialIndex,S=>{d.modelValue&&(s.value=S,t.value=!1)}),We(()=>{document.addEventListener("keydown",U)}),Je(()=>{document.removeEventListener("keydown",U)}),(S,H)=>(u(),$(sa,{modelValue:X.value,"onUpdate:modelValue":H[0]||(H[0]=o=>X.value=o),fullscreen:"",scrim:!0,transition:"dialog-bottom-transition",class:"image-zoom-modal"},{default:g(()=>[Z.value?(u(),$(he,{key:0,class:"image-zoom-modal__card"},{default:g(()=>[i(qe,{class:"image-zoom-modal__header pa-4"},{default:g(()=>[a("div",Na,[q.value?(u(),y("div",$a,l(s.value+1)+" / "+l(S.images.length),1)):(u(),$(oa,{key:1})),a("div",La,[q.value?(u(),$(G,{key:0,icon:"tabler-chevron-left",variant:"text",color:"white",disabled:!R.value,onClick:te},null,8,["disabled"])):C("",!0),q.value?(u(),$(G,{key:1,icon:"tabler-chevron-right",variant:"text",color:"white",disabled:!L.value,onClick:E},null,8,["disabled"])):C("",!0),i(G,{icon:t.value?"tabler-zoom-out":"tabler-zoom-in",variant:"text",color:"white",onClick:A},null,8,["icon"]),i(G,{icon:"tabler-x",variant:"text",color:"white",onClick:K})])])]),_:1}),i(Ee,{class:"image-zoom-modal__content pa-0"},{default:g(()=>[a("div",{class:Ve(["image-zoom-modal__image-container",{"image-zoom-modal__image-container--zoomed":t.value}]),onClick:A},[i(ze,{ref_key:"imageRef",ref:P,src:Z.value.url,alt:Z.value.alt||`Image ${s.value+1}`,class:Ve(["image-zoom-modal__image",{"image-zoom-modal__image--zoomed":t.value}]),contain:""},{placeholder:g(()=>[a("div",ja,[i(Se,{indeterminate:"",color:"white"})])]),_:1},8,["src","alt","class"])],2)]),_:1}),q.value?(u(),$(qe,{key:0,class:"image-zoom-modal__footer pa-4 justify-center"},{default:g(()=>[a("div",Qa,[(u(!0),y(ae,null,oe(S.images,(o,ee)=>(u(),$(G,{key:ee,icon:ee===s.value?"tabler-circle-filled":"tabler-circle",variant:"text",color:"white",size:"small",onClick:ue=>{s.value=ee,t.value=!1}},null,8,["icon","onClick"]))),128))])]),_:1})):C("",!0)]),_:1})):C("",!0)]),_:1},8,["modelValue"]))}}),qa=Qe(Pa,[["__scopeId","data-v-829207cc"]]),Oa={key:0,class:"d-flex justify-center align-center",style:{height:"100vh"}},Fa={class:"product-drawer__header pa-4 border-b bg-surface position-sticky",style:{top:"0","z-index":"10"}},Ba={class:"d-flex justify-space-between align-center mb-3"},Ua={class:"flex-grow-1"},Ya={class:"text-h5 font-weight-bold mb-1"},Za={class:"text-body-2 text-medium-emphasis"},Ra={class:"d-flex gap-3 flex-wrap"},Ga={class:"drawer-content",style:{height:"calc(100vh - 140px)","overflow-y":"auto","padding-bottom":"80px"}},Xa={class:"pa-6 border-b"},Ha={class:"main-image-container mb-4 position-relative"},Wa={key:0,class:"thumbnails-rail"},Ja={class:"d-flex gap-2 flex-wrap justify-center"},Ka={key:0,class:"mb-4"},et={class:"text-subtitle-1 mb-3"},at={class:"d-flex gap-2 flex-wrap"},tt={key:0,class:"text-caption text-medium-emphasis mt-1"},lt={key:1,class:"mb-4"},ot={class:"text-subtitle-1 mb-3"},st={class:"d-flex gap-2 flex-wrap"},it={key:0,class:"text-caption text-medium-emphasis mt-1"},rt={class:"mb-4"},nt={class:"text-subtitle-1 mb-3"},ct={key:0,class:"mt-1"},ut={class:"mb-4"},dt={class:"text-subtitle-1 mb-3"},mt={class:"d-flex justify-space-between align-center mb-3"},vt={class:"text-caption text-medium-emphasis"},gt={class:"text-body-1"},pt={class:"text-center"},_t={class:"text-caption text-medium-emphasis"},ft={class:"text-h6 text-primary"},ht={class:"text-end"},yt={class:"text-caption text-medium-emphasis"},bt={class:"text-h6 text-success"},xt={key:0,class:"mb-4"},kt={class:"d-flex align-center mb-3"},wt={class:"d-flex gap-2 flex-wrap"},Ct={class:"mb-4"},zt={class:"text-subtitle-1 mb-3"},Mt={key:0},It={key:1},Dt={class:"d-flex align-center gap-3"},Tt={class:"text-caption text-medium-emphasis"},St={key:1,class:"text-caption text-warning mt-2"},Vt={key:2,class:"text-caption text-error mt-2"},Et={class:"pa-6 border-b"},At={key:0,class:"mb-6"},Nt={class:"text-h6 mb-3"},$t=["innerHTML"],Lt={key:1,class:"mb-6"},jt={class:"text-h6 mb-3"},Qt={key:2,class:"mb-6"},Pt={class:"d-flex justify-space-between align-center mb-3"},qt={class:"text-h6"},Ot=["innerHTML"],Ft={class:"pa-6"},Bt={key:0,class:"mb-6"},Ut={class:"font-weight-medium"},Yt={class:"font-weight-medium"},Zt={key:1,class:"mb-6"},Rt={class:"text-h6 mb-3"},Gt={class:"d-flex gap-4 flex-wrap"},Xt={class:"d-flex gap-1 flex-column"},Ht={key:2,class:"mb-8"},Wt={class:"d-flex align-center mb-4"},Jt={class:"text-h6 font-weight-bold text-primary"},Kt={class:"d-flex gap-4 flex-wrap video-list"},el={class:"d-flex align-center mb-3"},al={class:"flex-grow-1"},tl={class:"text-subtitle-2 font-weight-medium"},ll={class:"d-flex gap-2 flex-column"},ol={class:"drawer-footer pa-4 border-t bg-surface position-sticky",style:{bottom:"0","z-index":"10"}},sl={class:"d-flex justify-space-between align-center mb-3"},il={class:"text-body-2"},rl={key:0,class:"me-2"},nl={key:1,class:"me-2"},cl={class:"text-h6 font-weight-bold text-success"},ul={key:2,class:"d-flex align-center justify-center pa-8"},dl=je({__name:"ProductDrawer",props:{modelValue:{type:Boolean},productId:{}},emits:["update:modelValue"],setup(ie,{emit:re}){const d=ie,J=re,{t:s}=Ue(),t=Xe(),P=aa(),{showSuccess:X,showError:Z}=Ge(),{openCartDrawer:R}=la(),L=x(0),q=x(""),K=x(!1),te=w(()=>{var _;return(_=o.value)!=null&&_.gallery.thumbnails?o.value.gallery.thumbnails.map(v=>{var V;return{url:v.url,alt:`${(V=o.value)==null?void 0:V.titre} - Image`}}):[]}),E=x(null),A=x(""),U=x(""),S=x("order_sample"),H=w({get:()=>d.modelValue,set:_=>J("update:modelValue",_)}),o=w(()=>t.drawerProduct),ee=w(()=>t.detailLoading),ue=w(()=>t.addingToCart),ye=w(()=>{var _;return q.value?q.value:(_=o.value)!=null&&_.gallery.main?o.value.gallery.main:""}),n=w(()=>t.maxQty),O=w(()=>{var e;const _=((e=o.value)==null?void 0:e.quantite_min)||1;if(!o.value||t.selectedQty<_||t.selectedQty>n.value||!F.value)return!1;const v=t.sizes.length>0,V=t.colors.length>0;return v&&V?t.selectedSize&&t.selectedColor&&t.selectedVariantId&&n.value>0:v?t.selectedSize&&t.selectedVariantId&&n.value>0:V?t.selectedColor&&t.selectedVariantId&&n.value>0:n.value>0});w(()=>o.value?o.value.prix_vente*t.selectedQty:0);const Y=w(()=>o.value?o.value.prix_affilie*t.selectedQty:0),h=w(()=>{var _;return E.value||((_=o.value)==null?void 0:_.prix_vente)||0}),k=w(()=>o.value?(o.value.prix_achat||0)+50:0),F=w(()=>S.value==="exchange"?!0:h.value>=k.value),B=w(()=>!o.value||S.value==="exchange"?0:Math.max(0,h.value-(o.value.prix_achat||0)));w(()=>B.value*t.selectedQty);const se=w(()=>t.matrixRows),Ae=_=>{var v;L.value=_,(v=o.value)!=null&&v.gallery.thumbnails[_]&&(q.value=o.value.gallery.thumbnails[_].url)},Ne=_=>{if(A.value=_,t.selectColor(_),o.value){const v=t.colors.find(V=>V.name===_);v!=null&&v.image_url?q.value=v.image_url:q.value=o.value.gallery.main||""}},be=_=>{U.value=_,t.selectSize(_)},Me=async(_,v)=>{try{const V=await fetch(_,{method:"GET",headers:{Accept:"*/*"},credentials:"same-origin"});if(!V.ok)throw new Error(`HTTP error! status: ${V.status}`);const e=await V.blob(),c=window.URL.createObjectURL(e),p=document.createElement("a");p.href=c,p.download=v,p.style.display="none",document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(c),X(`TÃ©lÃ©chargement de "${v}" dÃ©marrÃ© avec succÃ¨s`)}catch(V){console.error("Download error:",V),Z(`Erreur lors du tÃ©lÃ©chargement: ${V instanceof Error?V.message:"Fichier introuvable"}`)}},xe=_=>{_!==void 0&&(L.value=_),K.value=!0},de=w(()=>{if(!o.value)return null;let _=null;if(A.value&&o.value.colors){const v=o.value.colors.find(V=>V.name===A.value);v&&(_=v.stock)}if(U.value&&o.value.sizes){const v=o.value.sizes.find(V=>V.value===U.value);v&&(_=_!==null?Math.min(_,v.stock):v.stock)}return _}),$e=async _=>{try{await navigator.clipboard.writeText(_),X("Texte copiÃ© dans le presse-papiers")}catch{Z("Erreur lors de la copie")}},Le=_=>{window.open(_,"_blank")},Ie=async()=>{if(!(!o.value||!O.value))try{await P.addItem({produit_id:o.value.id,variante_id:t.selectedVariantId||void 0,qty:t.selectedQty,sell_price:E.value||void 0,type_command:S.value}),X(s("catalogue.cart.added_success")),t.selectedQty=1,H.value=!1,setTimeout(()=>{R()},300)}catch(_){console.error("Add to cart error:",_)}};ce(()=>d.productId,async _=>{var v;_&&d.modelValue&&(await t.fetchOneForDrawer(_),L.value=0,q.value=((v=o.value)==null?void 0:v.gallery.main)||"",A.value="",U.value="")},{immediate:!0}),ce(()=>d.modelValue,_=>{_&&d.productId?(t.fetchOneForDrawer(d.productId),ea(()=>{var v;!q.value&&((v=o.value)!=null&&v.gallery.main)&&(q.value=o.value.gallery.main)})):_||(t.selectedColor=null,t.selectedSize=null,t.selectedVariantId=null,t.selectedQty=1,t.maxQty=0,L.value=0,q.value="",A.value="",U.value="")}),ce([A,U],()=>{t.selectedColor=A.value||null,t.selectedSize=U.value||null},{immediate:!0}),Ke(()=>{H.value&&(H.value=!1)});const ke=_=>_?_.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").trim():"";return(_,v)=>(u(),y(ae,null,[i(ta,{modelValue:H.value,"onUpdate:modelValue":v[9]||(v[9]=V=>H.value=V),location:"end",width:"1000",temporary:"",class:"product-drawer"},{default:g(()=>{var V;return[ee.value?(u(),y("div",Oa,[i(Se,{indeterminate:"",color:"primary",size:"64"})])):o.value?(u(),y(ae,{key:1},[a("div",Fa,[a("div",Ba,[a("div",Ua,[a("h2",Ya,l(o.value.titre),1),a("div",Za,l((V=o.value.categorie)==null?void 0:V.nom),1)]),i(G,{icon:"tabler-x",variant:"text",size:"small",onClick:v[0]||(v[0]=e=>H.value=!1)})]),a("div",Ra,[o.value.sku?(u(),$(W,{key:0,color:"secondary",variant:"tonal",size:"small"},{default:g(()=>[i(Q,{icon:"tabler-barcode",start:""}),z(" SKU: "+l(o.value.sku),1)]),_:1})):C("",!0),i(W,{color:"primary",variant:"tonal",size:"small"},{default:g(()=>[i(Q,{icon:"tabler-package",start:""}),z(" "+l(r(s)("catalogue.kpis.stock"))+": "+l(o.value.stock_fake??o.value.stock_total),1)]),_:1}),i(W,{color:"success",variant:"tonal",size:"small"},{default:g(()=>[i(Q,{icon:"tabler-coins",start:""}),z(" "+l(r(s)("catalogue.kpis.profit"))+": +"+l(B.value.toFixed(2))+" MAD ",1)]),_:1}),i(W,{color:"info",variant:"tonal",size:"small"},{default:g(()=>[z(l(r(s)("catalogue.kpis.buy"))+": "+l(o.value.prix_achat)+" MAD ",1)]),_:1}),i(W,{color:"warning",variant:"tonal",size:"small"},{default:g(()=>[z(l(r(s)("catalogue.kpis.sell"))+": "+l(o.value.prix_vente)+" MAD ",1)]),_:1})])]),a("div",Ga,[a("div",Xa,[i(ia,null,{default:g(()=>[i(Oe,{cols:"6"},{default:g(()=>[a("div",Ha,[i(ze,{src:ye.value,alt:o.value.titre,"aspect-ratio":"1",cover:"",class:"rounded-lg main-image cursor-pointer",style:{"max-height":"350px"},onClick:v[1]||(v[1]=e=>xe(L.value))},null,8,["src","alt"]),i(G,{icon:"tabler-zoom-in",size:"small",variant:"elevated",color:"primary",class:"zoom-btn",onClick:v[2]||(v[2]=e=>xe(L.value))})]),o.value.gallery.thumbnails.length>1?(u(),y("div",Wa,[a("div",Ja,[(u(!0),y(ae,null,oe(o.value.gallery.thumbnails,(e,c)=>(u(),y("div",{key:c,class:"thumbnail-container"},[i(ze,{src:e.url,alt:`${o.value.titre} - Image ${c+1}`,width:"60",height:"60",cover:"",class:Ve(["rounded cursor-pointer thumbnail",{"thumbnail--active":L.value===c}]),onClick:p=>Ae(c)},null,8,["src","alt","class","onClick"])]))),128))])])):C("",!0)]),_:1}),i(Oe,{cols:"6"},{default:g(()=>{var e,c,p;return[r(t).colors.length?(u(),y("div",Ka,[a("h4",et,l(r(s)("catalogue.variants.color")),1),a("div",at,[(u(!0),y(ae,null,oe(r(t).colors,m=>(u(),$(Re,{key:m.name,location:"top"},{activator:g(({props:M})=>[i(W,Ye({ref_for:!0},M,{color:r(t).selectedColor===m.name?"primary":"default",variant:r(t).selectedColor===m.name?"flat":"outlined",size:"large",class:"cursor-pointer color-chip",onClick:I=>Ne(m.name)}),{default:g(()=>[m.swatch?(u(),$(Q,{key:0,style:Ze({color:m.swatch}),icon:"tabler-circle-filled",start:""},null,8,["style"])):C("",!0),z(" "+l(m.name),1)]),_:2},1040,["color","variant","onClick"])]),default:g(()=>[a("span",null,l(m.name),1)]),_:2},1024))),128))]),!r(t).selectedColor&&r(t).colors.length?(u(),y("div",tt,l(r(s)("catalogue.select.color")),1)):C("",!0)])):C("",!0),r(t).sizes.length?(u(),y("div",lt,[a("h4",ot,l(r(s)("catalogue.variants.size")),1),a("div",st,[(u(!0),y(ae,null,oe(r(t).sizes,m=>(u(),$(W,{key:m,color:r(t).selectedSize===m?"primary":"default",variant:r(t).selectedSize===m?"flat":"outlined",size:"large",class:"cursor-pointer",onClick:M=>be(m)},{default:g(()=>[z(l(m),1)]),_:2},1032,["color","variant","onClick"]))),128))]),!r(t).selectedSize&&r(t).sizes.length?(u(),y("div",it,l(r(s)("catalogue.select.size")),1)):C("",!0)])):C("",!0),a("div",rt,[a("h4",nt,l(r(s)("order_type")),1),i(ra,{modelValue:S.value,"onUpdate:modelValue":v[3]||(v[3]=m=>S.value=m),inline:"",density:"compact"},{default:g(()=>[i(Fe,{value:"order_sample",label:r(s)("order_sample"),color:"primary"},null,8,["label"]),i(Fe,{value:"exchange",label:r(s)("exchange"),color:"warning"},null,8,["label"])]),_:1},8,["modelValue"]),S.value==="exchange"?(u(),$(we,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-2"},{default:g(()=>[i(Q,{icon:"tabler-info-circle",start:""}),z(" "+l(r(s)("catalogue.exchange_info")),1)]),_:1})):(u(),$(we,{key:1,type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:g(()=>[i(Q,{icon:"tabler-info-circle",start:""}),a("div",null,[z(l(r(s)("catalogue.minimum_price_required",{price:k.value}))+" ",1),n.value>0?(u(),y("div",ct,[a("strong",null,l(r(s)("catalogue.max_stock_available",{quantity:n.value})),1)])):C("",!0)])]),_:1}))]),a("div",ut,[a("h4",dt,l(r(s)("catalogue.price_and_commission")),1),i(he,{variant:"outlined",class:"pa-4"},{default:g(()=>{var m,M,I,f,j;return[a("div",mt,[a("div",null,[a("div",vt,l(r(s)("catalogue.purchase_price")),1),a("div",gt,l(((m=o.value)==null?void 0:m.prix_achat)||0)+" MAD",1)]),a("div",pt,[a("div",_t,l(r(s)("catalogue.recommended_price")),1),a("div",ft,l(((M=o.value)==null?void 0:M.prix_vente)||0)+" MAD",1)]),a("div",ht,[a("div",yt,l(r(s)("catalogue.unit_commission")),1),a("div",bt,"+"+l(B.value.toFixed(2))+" MAD",1)])]),o.value.colors&&o.value.colors.length>0||o.value.sizes&&o.value.sizes.length>0?(u(),y("div",xt,[a("div",kt,[i(Q,{icon:"tabler-package",class:"me-2",color:"primary",size:"20"}),v[11]||(v[11]=a("span",{class:"text-subtitle-1 font-weight-bold text-primary"},"Stock par Variante",-1))]),a("div",wt,[(u(!0),y(ae,null,oe(o.value.colors,T=>(u(),$(W,{key:"color-"+T.name,color:T.stock>0?"success":"error",variant:"flat",size:"default",class:"font-weight-medium"},{default:g(()=>[i(Q,{icon:T.stock>0?"tabler-check":"tabler-x",start:"",size:"16"},null,8,["icon"]),z(" "+l(T.name)+": "+l(T.stock)+" unitÃ©s ",1)]),_:2},1032,["color"]))),128)),(u(!0),y(ae,null,oe(o.value.sizes,T=>(u(),$(W,{key:"size-"+T.value,color:T.stock>0?"success":"error",variant:"flat",size:"default",class:"font-weight-medium"},{default:g(()=>[i(Q,{icon:T.stock>0?"tabler-check":"tabler-x",start:"",size:"16"},null,8,["icon"]),z(" "+l(T.value)+": "+l(T.stock)+" unitÃ©s ",1)]),_:2},1032,["color"]))),128))])])):C("",!0),i(Be,{modelValue:E.value,"onUpdate:modelValue":v[4]||(v[4]=T=>E.value=T),modelModifiers:{number:!0},label:r(s)("catalogue.custom_sell_price_optional"),type:"number",variant:"outlined",density:"compact",suffix:"MAD",min:S.value==="order_sample"?k.value:((I=o.value)==null?void 0:I.prix_achat)||0,placeholder:((j=(f=o.value)==null?void 0:f.prix_vente)==null?void 0:j.toString())||"0",hint:S.value==="exchange"?r(s)("catalogue.price_disabled_for_exchange"):r(s)("catalogue.minimum_price_hint",{price:k.value}),disabled:S.value==="exchange","persistent-hint":"",clearable:""},null,8,["modelValue","label","min","placeholder","hint","disabled"])]}),_:1})]),a("div",Ct,[a("h4",zt,l(r(s)("catalogue.detail.quantity")),1),de.value!==null?(u(),$(we,{key:0,type:de.value>0?"info":"warning",variant:"tonal",density:"compact",class:"mb-3"},{default:g(()=>[i(Q,{icon:de.value>0?"tabler-package":"tabler-alert-triangle",start:""},null,8,["icon"]),de.value>0?(u(),y("span",Mt,[a("strong",null,l(r(s)("catalogue.stock_available"))+":",1),z(" "+l(r(s)("catalogue.units_for_variant",{stock:de.value})),1)])):(u(),y("span",It,[a("strong",null,l(r(s)("catalogue.out_of_stock")),1),z(" "+l(r(s)("catalogue.for_this_variant")),1)]))]),_:1},8,["type"])):C("",!0),a("div",Dt,[i(G,{icon:"tabler-minus",size:"small",variant:"outlined",disabled:r(t).selectedQty<=(((e=o.value)==null?void 0:e.quantite_min)||1)||n.value===0,onClick:v[5]||(v[5]=m=>r(t).selectedQty--)},null,8,["disabled"]),i(Be,{modelValue:r(t).selectedQty,"onUpdate:modelValue":v[6]||(v[6]=m=>r(t).selectedQty=m),modelModifiers:{number:!0},type:"number",variant:"outlined",density:"compact",style:{width:"80px"},min:((c=o.value)==null?void 0:c.quantite_min)||1,max:n.value,disabled:n.value===0,"hide-details":""},null,8,["modelValue","min","max","disabled"]),i(G,{icon:"tabler-plus",size:"small",variant:"outlined",disabled:r(t).selectedQty>=n.value||n.value===0,onClick:v[7]||(v[7]=m=>r(t).selectedQty++)},null,8,["disabled"]),a("span",Tt,l(r(s)("catalogue.max_label",{quantity:n.value})),1)]),(p=o.value)!=null&&p.quantite_min&&o.value.quantite_min>1?(u(),y("div",St,[i(Q,{icon:"tabler-info-circle",size:"14",class:"me-1"}),z(" "+l(r(s)("catalogue.minimum_quantity_required",{quantity:o.value.quantite_min})),1)])):C("",!0),n.value===0?(u(),y("div",Vt,l(r(s)("catalogue.qty.max_zero")),1)):C("",!0)]),i(G,{color:"primary",size:"large",block:"",disabled:!O.value,loading:ue.value,onClick:Ie},{default:g(()=>[i(Q,{icon:"tabler-shopping-cart",start:""}),z(" "+l(r(s)("catalogue.actions.add_to_cart")),1)]),_:1},8,["disabled","loading"])]}),_:1})]),_:1})]),a("div",Et,[o.value.description?(u(),y("div",At,[a("h3",Nt,l(r(s)("catalogue.detail.description")),1),a("div",{class:"text-body-1",innerHTML:ke(o.value.description)},null,8,$t)])):C("",!0),o.value.notes_admin?(u(),y("div",Lt,[a("h3",jt,l(r(s)("catalogue.admin_note")),1),i(we,{type:"info",variant:"tonal",class:"text-body-1"},{default:g(()=>[i(Q,{icon:"tabler-info-circle",start:""}),z(" "+l(o.value.notes_admin),1)]),_:1})])):C("",!0),o.value.copywriting?(u(),y("div",Qt,[a("div",Pt,[a("h3",qt,l(r(s)("catalogue.copywriting")),1),i(G,{variant:"outlined",size:"small","prepend-icon":"tabler-copy",onClick:v[8]||(v[8]=e=>$e(o.value.copywriting))},{default:g(()=>v[12]||(v[12]=[z(" Copier ")])),_:1,__:[12]})]),i(he,{variant:"outlined",class:"pa-4"},{default:g(()=>[a("div",{class:"text-body-1 copywriting-content",innerHTML:ke(o.value.copywriting)},null,8,Ot)]),_:1})])):C("",!0)]),a("div",Ft,[se.value.length?(u(),y("div",Bt,[v[13]||(v[13]=a("h3",{class:"text-h6 mb-3"},"Stock par combinaison",-1)),i(na,{density:"compact"},{default:g(()=>[a("thead",null,[a("tr",null,[a("th",null,l(r(s)("catalogue.table.quantity")),1),a("th",null,l(r(s)("catalogue.table.color")),1),a("th",null,l(r(s)("catalogue.table.size")),1)])]),a("tbody",null,[(u(!0),y(ae,null,oe(se.value,(e,c)=>(u(),y("tr",{key:c},[a("td",null,[i(W,{color:e.qty>0?"success":"error",size:"small",variant:"tonal"},{default:g(()=>[z(l(e.qty),1)]),_:2},1032,["color"])]),a("td",Ut,l(e.color),1),a("td",Yt,l(e.size),1)]))),128))])]),_:1})])):C("",!0),o.value.images.length?(u(),y("div",Zt,[a("h3",Rt,l(r(s)("catalogue.assets.images")),1),a("div",Gt,[(u(!0),y(ae,null,oe(o.value.images,(e,c)=>(u(),$(he,{key:c,variant:"elevated",width:"140",class:"image-asset-card",hover:""},{default:g(()=>[i(Ee,{class:"pa-3"},{default:g(()=>[i(ze,{src:e.url,width:"100",height:"100",cover:"",class:"rounded mb-2"},null,8,["src"]),a("div",Xt,[i(G,{size:"small",variant:"flat",color:"primary","prepend-icon":"tabler-eye",block:"",onClick:p=>xe(c)},{default:g(()=>[z(l(r(s)("catalogue.view")),1)]),_:2},1032,["onClick"]),i(G,{size:"small",variant:"outlined",color:"primary","prepend-icon":"tabler-download",block:"",onClick:Ce(p=>Me(e.url,`${o.value.titre}_image_${c+1}.jpg`),["stop"])},{default:g(()=>[z(l(r(s)("catalogue.download")),1)]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])):C("",!0),o.value.videos.length?(u(),y("div",Ht,[a("div",Wt,[i(Q,{icon:"tabler-video",class:"me-2",color:"primary"}),a("h3",Jt,l(r(s)("catalogue.assets.videos")),1)]),i(we,{type:"info",variant:"tonal",class:"mb-4",density:"compact"},{default:g(()=>[i(Q,{icon:"tabler-info-circle",start:""}),z(" "+l(r(s)("catalogue.video_instructions")),1)]),_:1}),a("div",Kt,[(u(!0),y(ae,null,oe(o.value.videos,(e,c)=>(u(),$(he,{key:c,variant:"elevated",width:"240",class:"video-asset",hover:""},{default:g(()=>[i(Ee,{class:"pa-4"},{default:g(()=>[a("div",el,[i(ca,{color:"primary",variant:"tonal",size:"32",class:"me-3"},{default:g(()=>[i(Q,{icon:"tabler-video",size:"18"})]),_:1}),a("div",al,[a("div",tl,l(e.title||`VidÃ©o ${c+1}`),1),v[14]||(v[14]=a("div",{class:"text-caption text-medium-emphasis"},"Format: MP4",-1))])]),a("div",ll,[i(G,{size:"small",variant:"flat",color:"primary","prepend-icon":"tabler-eye",block:"",onClick:p=>Le(e.url)},{default:g(()=>[z(l(r(s)("actions.view")),1)]),_:2},1032,["onClick"]),i(G,{size:"small",variant:"outlined",color:"primary","prepend-icon":"tabler-download",block:"",onClick:p=>Me(e.url,`${o.value.titre}_video_${c+1}.mp4`)},{default:g(()=>[z(l(r(s)("catalogue.actions.download")),1)]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])):C("",!0)])]),a("div",ol,[a("div",sl,[a("div",il,[r(t).selectedColor?(u(),y("span",rl,l(r(t).selectedColor),1)):C("",!0),r(t).selectedSize?(u(),y("span",nl,l(r(t).selectedSize),1)):C("",!0),a("span",null,"Qty: "+l(r(t).selectedQty),1)]),a("div",cl," +"+l(Y.value.toFixed(2))+" MAD ",1)]),i(G,{color:"primary",size:"large",block:"",disabled:!O.value,loading:ue.value,onClick:Ie},{default:g(()=>[i(Q,{icon:"tabler-shopping-cart",start:""}),z(" "+l(r(s)("catalogue.actions.add_to_cart"))+" - "+l((h.value*r(t).selectedQty).toFixed(2))+" MAD ",1)]),_:1},8,["disabled","loading"])])],64)):(u(),y("div",ul,[i(Se,{indeterminate:"",color:"primary"})]))]}),_:1},8,["modelValue"]),i(qa,{modelValue:K.value,"onUpdate:modelValue":v[10]||(v[10]=V=>K.value=V),images:te.value,"initial-index":L.value},null,8,["modelValue","images","initial-index"])],64))}}),Vl=Qe(dl,[["__scopeId","data-v-15bade7b"]]);export{Sl as C,Vl as P,Xe as u};
