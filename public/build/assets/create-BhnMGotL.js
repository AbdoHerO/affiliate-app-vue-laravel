import{d as L,aL as T,j,r as p,D as I,c as N,o as z,b as e,m as s,f as l,e as F,t as m,ac as c,s as n,aU as M,a$ as R,b0 as $}from"./main-uLG9IIeX.js";import{u as D}from"./boutiques-DkUXecMM.js";import{u as E}from"./useNotifications-DDBS_wPD.js";import{useQuickConfirm as P}from"./useConfirmAction-C-KKQTYr.js";import{u as A}from"./useApi-Bt_X5NBj.js";import{V as O}from"./VBreadcrumbs-D7yKQl5l.js";import{a as i,V as v}from"./VRow-aGfXYx3U.js";import{V as Q,b as h}from"./VCard-CB1gT6RB.js";import{V as G}from"./VCardText-BZtszuIK.js";import{V as H}from"./VForm-C9FiqBHN.js";import{V as _}from"./VTextField-Dxeq5kx5.js";import{V as C}from"./VSelect-sWnAtot-.js";import{a as J,b as K,d as W}from"./VList-uZDByhc2.js";import{V as X}from"./VTextarea-BuIc6d95.js";/* empty css              */import"./createSimpleFunctional-DugzUcbB.js";import"./VAvatar-bHPDEsYY.js";import"./VImg-BS6_svHJ.js";import"./VField-CfH1YcVv.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./dialog-transition-2hF0ajsQ.js";import"./VMenu-DP1p-55V.js";import"./VCheckboxBtn-CogF2AUK.js";import"./VChip-B84WcmDa.js";import"./ssrBoot-BPhRU-mF.js";import"./VDivider-UqGR4x4D.js";const ke=L({__name:"create",setup(Y){const{t:a}=T(),b=j(),x=D(),{showError:V}=E(),{confirmCreate:U}=P(),t=p({nom:"",slug:"",proprietaire_id:"",email_pro:"",adresse:"",statut:"actif",commission_par_defaut:0}),f=p(!1),u=p({}),g=p([]),k=()=>(u.value={},t.value.nom.trim()||(u.value.nom=[a("name_required")]),t.value.proprietaire_id||(u.value.proprietaire_id=[a("owner_required")]),t.value.email_pro&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value.email_pro)&&(u.value.email_pro=[a("invalid_email_format")]),Object.keys(u.value).length===0),B=async()=>{var d;try{const{data:o,error:r}=await A("/admin/users?per_page=100");if(r.value){V(a("error_loading_users"));return}g.value=((d=o.value)==null?void 0:d.users)||[]}catch{V(a("error_loading_users"))}},q=async()=>{var o;if(!(!k()||!await U(a("boutique")))){f.value=!0;try{await x.create(t.value),b.push({name:"admin-boutiques"})}catch(r){r.status===422&&((o=r.data)!=null&&o.errors)&&(u.value=r.data.errors)}finally{f.value=!1}}},w=()=>{b.push({name:"admin-boutiques"})},S=()=>{t.value.nom&&!t.value.slug&&(t.value.slug=t.value.nom.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))};return I(()=>{B()}),(d,o)=>(z(),N("div",null,[e(O,{items:[{title:s(a)("breadcrumb_home"),to:"/"},{title:s(a)("admin_boutiques_title"),to:"/admin/boutiques"},{title:s(a)("breadcrumb_create")}],class:"pa-0 mb-4"},null,8,["items"]),e(v,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(Q,null,{default:l(()=>[e(h,{class:"d-flex align-center justify-space-between"},{default:l(()=>[F("span",null,m(s(a)("admin_boutiques_create_title")),1),e(c,{variant:"outlined",size:"small",onClick:w},{default:l(()=>[n(m(s(a)("action_cancel")),1)]),_:1})]),_:1}),e(G,null,{default:l(()=>[e(H,{onSubmit:M(q,["prevent"])},{default:l(()=>[e(v,null,{default:l(()=>[e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.nom,"onUpdate:modelValue":o[0]||(o[0]=r=>t.value.nom=r),label:s(a)("admin_boutiques_name"),"error-messages":u.value.nom,variant:"outlined",required:"",onBlur:S},null,8,["modelValue","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.slug,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value.slug=r),label:s(a)("admin_boutiques_slug"),"error-messages":u.value.slug,variant:"outlined",hint:s(a)("slug_hint")},null,8,["modelValue","label","error-messages","hint"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(C,{modelValue:t.value.proprietaire_id,"onUpdate:modelValue":o[2]||(o[2]=r=>t.value.proprietaire_id=r),items:g.value,"item-value":"id","item-title":"nom_complet",label:s(a)("admin_boutiques_owner"),"error-messages":u.value.proprietaire_id,variant:"outlined",required:""},{item:l(({props:r,item:y})=>[e(J,R($(r)),{default:l(()=>[e(K,null,{default:l(()=>[n(m(y.raw.nom_complet),1)]),_:2},1024),e(W,null,{default:l(()=>[n(m(y.raw.email),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(C,{modelValue:t.value.statut,"onUpdate:modelValue":o[3]||(o[3]=r=>t.value.statut=r),items:[{value:"actif",title:s(a)("admin_boutiques_filter_status_active")},{value:"suspendu",title:s(a)("admin_boutiques_filter_status_inactive")},{value:"desactive",title:s(a)("admin_boutiques_filter_status_pending")}],label:s(a)("admin_boutiques_status"),"error-messages":u.value.statut,variant:"outlined",required:""},null,8,["modelValue","items","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.email_pro,"onUpdate:modelValue":o[4]||(o[4]=r=>t.value.email_pro=r),label:s(a)("admin_boutiques_contact_email"),"error-messages":u.value.email_pro,variant:"outlined",type:"email"},null,8,["modelValue","label","error-messages"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(_,{modelValue:t.value.commission_par_defaut,"onUpdate:modelValue":o[5]||(o[5]=r=>t.value.commission_par_defaut=r),modelModifiers:{number:!0},label:s(a)("admin_boutiques_commission_rate"),"error-messages":u.value.commission_par_defaut,variant:"outlined",type:"number",min:"0",max:"100",suffix:"%"},null,8,["modelValue","label","error-messages"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(X,{modelValue:t.value.adresse,"onUpdate:modelValue":o[6]||(o[6]=r=>t.value.adresse=r),label:s(a)("admin_boutiques_address"),"error-messages":u.value.adresse,variant:"outlined",rows:"3"},null,8,["modelValue","label","error-messages"])]),_:1})]),_:1}),e(v,{class:"mt-4"},{default:l(()=>[e(i,{cols:"12",class:"d-flex gap-4 justify-end"},{default:l(()=>[e(c,{variant:"outlined",onClick:w},{default:l(()=>[n(m(s(a)("common.cancel")),1)]),_:1}),e(c,{type:"button",color:"primary",loading:f.value,onClick:q},{default:l(()=>[n(m(s(a)("common.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}});export{ke as default};
