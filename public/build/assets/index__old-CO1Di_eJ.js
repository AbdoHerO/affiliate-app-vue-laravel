import{u as se,C as re,P as ie}from"./ProductDrawer-BdxS4Gzs.js";import{u as ce}from"./useApi-Bt_X5NBj.js";import{u as ue}from"./useNotifications-DDBS_wPD.js";import{V as de}from"./VBreadcrumbs-D7yKQl5l.js";import{V as N}from"./VCardText-BZtszuIK.js";import{d as ne,aL as me,r as c,V as u,w as U,D as ve,c as y,o as n,b as t,e as d,g as P,l as S,t as m,m as r,f as i,az as I,ac as O,s as Q,aV as pe,F as _e,i as ge}from"./main-uLG9IIeX.js";import{V as j}from"./VCard-CB1gT6RB.js";import{V as q,a as f}from"./VRow-aGfXYx3U.js";import{V as fe}from"./VTextField-Dxeq5kx5.js";import{V as T}from"./VSelect-sWnAtot-.js";import{V as he}from"./VPagination-DYW6O4lq.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VImg-BS6_svHJ.js";import"./VChip-B84WcmDa.js";import"./VAvatar-bHPDEsYY.js";import"./VTooltip-Ce3bfmSx.js";import"./forwardRefs-Dv_T9a_w.js";import"./lazy-CjF3Yiep.js";import"./VNavigationDrawer-CkHpOB1y.js";import"./ssrBoot-BPhRU-mF.js";import"./VAlert-TgguXW_5.js";import"./createSimpleFunctional-DugzUcbB.js";import"./VTable-0U-NvIH3.js";/* empty css              */import"./VField-CfH1YcVv.js";import"./VList-uZDByhc2.js";import"./VDivider-UqGR4x4D.js";import"./dialog-transition-2hF0ajsQ.js";import"./VMenu-DP1p-55V.js";import"./VCheckboxBtn-CogF2AUK.js";const xe={class:"affiliate-catalogue"},Ve={class:"d-flex align-center justify-space-between mb-6"},be={class:"text-h4 mb-2"},Ce={class:"text-body-1 text-medium-emphasis mb-0"},we={class:"text-body-2"},Pe={class:"text-caption text-medium-emphasis"},ke={key:0,class:"text-center py-8"},De={class:"text-body-1 mt-4"},Se={key:1,class:"text-center py-12"},Te={class:"text-h5 mb-2"},Ae={class:"text-body-1 text-medium-emphasis mb-4"},Be={key:3,class:"d-flex justify-center mt-8"},Fe=ne({__name:"index__old",setup(Le){const{t:e}=me(),l=se(),{showSuccess:G,showError:k}=ue(),p=c(""),_=c(""),g=c(void 0),x=c(""),V=c(""),b=c("created_at"),C=c("desc"),D=c(null),A=c([]),B=c(!1),R=u(()=>[{title:e("nav_dashboard"),to:{name:"affiliate-dashboard"}},{title:e("catalogue.title"),active:!0}]),H=u(()=>l.isLoading),J=u(()=>l.items),v=u(()=>l.pagination),F=u(()=>l.hasItems);u(()=>l.selectedProduct),u(()=>l.isDetailLoading);const w=c(!1),L=c(null),K=u(()=>[{value:"created_at:desc",text:e("catalogue.filters.sort_newest")},{value:"created_at:asc",text:e("catalogue.filters.sort_oldest")},{value:"prix_vente:asc",text:e("catalogue.filters.sort_price_asc")},{value:"prix_vente:desc",text:e("catalogue.filters.sort_price_desc")},{value:"prix_affilie:asc",text:e("catalogue.filters.sort_profit_asc")},{value:"prix_affilie:desc",text:e("catalogue.filters.sort_profit_desc")},{value:"titre:asc",text:e("catalogue.filters.sort_name_asc")},{value:"titre:desc",text:e("catalogue.filters.sort_name_desc")}]),W=u(()=>[{value:void 0,text:"Tous les profits"},{value:10,text:"10 MAD+"},{value:25,text:"25 MAD+"},{value:50,text:"50 MAD+"},{value:100,text:"100 MAD+"}]),z=u(()=>!!(p.value||_.value||g.value||x.value||V.value)),h=async()=>{const[s,a]=(b.value+":"+C.value).split(":");await l.fetchList({q:p.value||void 0,category_id:_.value||void 0,min_profit:g.value,size:x.value||void 0,color:V.value||void 0,page:v.value.current_page,per_page:v.value.per_page,sort:s,dir:a})},X=()=>{D.value&&clearTimeout(D.value),D.value=setTimeout(()=>{l.setPage(1),h()},300)},E=()=>{l.setPage(1),h()},Y=s=>{const[a,o]=s.split(":");b.value=a,C.value=o,E()},M=()=>{p.value="",_.value="",g.value=void 0,x.value="",V.value="",b.value="created_at",C.value="desc",l.resetFilters(),h()},Z=s=>{l.setPage(s),h()},$=async s=>{try{L.value=s,w.value=!0}catch{w.value=!1,k("Erreur lors du chargement du produit")}},ee=async s=>{try{await l.addToCart(s),G(e("catalogue.cart.added_success"))}catch{k(e("catalogue.cart.error"))}},te=s=>{console.log("Variant changed:",s)},ae=s=>{console.log("Quantity changed:",s)},oe=async()=>{var s;B.value=!0;try{const{data:a,error:o}=await ce("/affiliate/categories",{method:"GET"});if(o.value)throw o.value;(s=a.value)!=null&&s.data&&(A.value=a.value.data.filter(le=>le.actif))}catch(a){console.error("Error loading categories:",a),k("Erreur lors du chargement des catÃ©gories")}finally{B.value=!1}};return U(p,X),U([_,g,x,V],E),ve(async()=>{await oe(),await h(),await l.fetchCartSummary()}),(s,a)=>(n(),y("div",xe,[t(de,{items:R.value,class:"pa-0 mb-4"},null,8,["items"]),d("div",Ve,[d("div",null,[d("h1",be,m(r(e)("catalogue.title")),1),d("p",Ce,m(r(e)("catalogue.showing_results",{from:v.value.from,to:v.value.to,total:v.value.total})),1)]),r(l).cartSummary.items_count>0?(n(),P(j,{key:0,variant:"outlined"},{default:i(()=>[t(N,{class:"d-flex align-center gap-3"},{default:i(()=>[t(I,{icon:"tabler-shopping-cart",color:"primary"}),d("div",null,[d("div",we,m(r(e)("catalogue.cart.items_count",{count:r(l).cartSummary.items_count})),1),d("div",Pe,m(r(l).cartSummary.total_amount)+" MAD",1)])]),_:1})]),_:1})):S("",!0)]),t(j,{class:"mb-6",variant:"outlined"},{default:i(()=>[t(N,null,{default:i(()=>[t(q,null,{default:i(()=>[t(f,{cols:"12",md:"3"},{default:i(()=>[t(fe,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=o=>p.value=o),placeholder:r(e)("catalogue.search_placeholder"),"prepend-inner-icon":"tabler-search",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","placeholder"])]),_:1}),t(f,{cols:"12",md:"2"},{default:i(()=>[t(T,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=o=>_.value=o),items:[{value:"",title:r(e)("catalogue.all_categories")},...A.value.map(o=>({value:o.id,title:o.nom}))],label:r(e)("catalogue.category"),variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","items","label"])]),_:1}),t(f,{cols:"12",md:"2"},{default:i(()=>[t(T,{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=o=>g.value=o),items:W.value,label:r(e)("catalogue.min_profit"),variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","items","label"])]),_:1}),t(f,{cols:"12",md:"3"},{default:i(()=>[t(T,{"model-value":b.value+":"+C.value,items:K.value,label:r(e)("catalogue.filters.sort_by"),variant:"outlined",density:"compact","hide-details":"","onUpdate:modelValue":Y},null,8,["model-value","items","label"])]),_:1}),t(f,{cols:"12",md:"2"},{default:i(()=>[t(O,{disabled:!z.value,variant:"outlined",block:"",onClick:M},{default:i(()=>[Q(m(r(e)("catalogue.clear_filters")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),H.value?(n(),y("div",ke,[t(pe,{indeterminate:"",color:"primary",size:"64"}),d("p",De,m(r(e)("catalogue.loading")),1)])):F.value?(n(),P(q,{key:2,class:"catalogue-grid"},{default:i(()=>[(n(!0),y(_e,null,ge(J.value,o=>(n(),P(f,{key:o.id,cols:"12",sm:"6",md:"4",lg:"3",class:"catalogue-grid__item"},{default:i(()=>[t(re,{product:r(l).mapProductToNormalized(o),onOpen:$,onAddToCart:ee,onVariantChange:te,onQtyChange:ae},null,8,["product"])]),_:2},1024))),128))]),_:1})):(n(),y("div",Se,[t(I,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),d("h3",Te,m(r(e)("catalogue.no_products")),1),d("p",Ae,m(r(e)("catalogue.no_products_subtitle")),1),z.value?(n(),P(O,{key:0,color:"primary",variant:"outlined",onClick:M},{default:i(()=>[Q(m(r(e)("catalogue.clear_filters")),1)]),_:1})):S("",!0)])),F.value&&v.value.last_page>1?(n(),y("div",Be,[t(he,{"model-value":v.value.current_page,length:v.value.last_page,"total-visible":7,"onUpdate:modelValue":Z},null,8,["model-value","length"])])):S("",!0),t(ie,{modelValue:w.value,"onUpdate:modelValue":a[3]||(a[3]=o=>w.value=o),"product-id":L.value},null,8,["modelValue","product-id"])]))}}),dt=ye(Fe,[["__scopeId","data-v-d305be5d"]]);export{dt as default};
