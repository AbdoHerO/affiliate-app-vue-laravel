import{u as se,C as re,P as ie}from"./ProductDrawer-LSYe1qwT.js";import{u as ce}from"./useApi-C6mAvy3D.js";import{u as ue}from"./useNotifications-B3v5F4dH.js";import{V as de}from"./VBreadcrumbs-Cjt6xYOm.js";import{V as M}from"./VCardText-Dqaeyxp0.js";import{d as ne,aL as me,r as c,V as u,w as N,o as pe,c as y,b as n,e as t,f as d,h as P,m as T,v as m,n as r,g as i,az as I,ac as O,t as Q,aU as ve,F as _e,j as ge}from"./main-3LuWNv9W.js";import{V as j}from"./VCard-QqgF9aMj.js";import{V as q,a as f}from"./VRow-aVZbYr4A.js";import{V as fe}from"./VTextField-CsO1UfXI.js";import{V as D}from"./VSelect-V4QjM3w5.js";import{V as he}from"./VPagination-C9G78dYZ.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VImg-DjZhnPY1.js";import"./VChip-D2hyzrT3.js";import"./VAvatar-CH3JpKwD.js";import"./VTooltip-DeQJuQst.js";import"./VOverlay-DHKe6cTP.js";import"./forwardRefs-BZg6tG7B.js";import"./lazy-vcHGEOxt.js";import"./VNavigationDrawer-DA7Dgz6f.js";import"./ssrBoot-DPE17Lki.js";import"./VSpacer-Ckvg-9-2.js";/* empty css              */import"./createSimpleFunctional-CbZg_Do-.js";import"./VDialog-DuTMUR2U.js";import"./dialog-transition-TWAYErkS.js";import"./VRadioGroup-DYdfkKR-.js";import"./VCheckboxBtn-BQUGQfLA.js";import"./VField-CzoZXYxi.js";import"./VAlert-cTzgSexk.js";import"./VTable-Dyn4MLHa.js";import"./VList-DWKF8cD-.js";import"./VDivider-D28qXVrs.js";import"./VMenu-cCaIVuKn.js";const xe={class:"affiliate-catalogue"},Ve={class:"d-flex align-center justify-space-between mb-6"},be={class:"text-h4 mb-2"},Ce={class:"text-body-1 text-medium-emphasis mb-0"},we={class:"text-body-2"},Pe={class:"text-caption text-medium-emphasis"},ke={key:0,class:"text-center py-8"},Se={class:"text-body-1 mt-4"},Te={key:1,class:"text-center py-12"},De={class:"text-h5 mb-2"},Ae={class:"text-body-1 text-medium-emphasis mb-4"},Be={key:3,class:"d-flex justify-center mt-8"},Fe=ne({__name:"index__old",setup(Le){const{t:e}=me(),l=se(),{showSuccess:G,showError:k}=ue(),v=c(""),_=c(""),g=c(void 0),x=c(""),V=c(""),b=c("created_at"),C=c("desc"),S=c(null),A=c([]),B=c(!1),R=u(()=>[{title:e("nav_dashboard"),to:{name:"affiliate-dashboard"}},{title:e("catalogue.title"),active:!0}]),H=u(()=>l.isLoading),J=u(()=>l.items),p=u(()=>l.pagination),F=u(()=>l.hasItems);u(()=>l.selectedProduct),u(()=>l.isDetailLoading);const w=c(!1),L=c(null),K=u(()=>[{value:"created_at:desc",text:e("catalogue.filters.sort_newest")},{value:"created_at:asc",text:e("catalogue.filters.sort_oldest")},{value:"prix_vente:asc",text:e("catalogue.filters.sort_price_asc")},{value:"prix_vente:desc",text:e("catalogue.filters.sort_price_desc")},{value:"prix_affilie:asc",text:e("catalogue.filters.sort_profit_asc")},{value:"prix_affilie:desc",text:e("catalogue.filters.sort_profit_desc")},{value:"titre:asc",text:e("catalogue.filters.sort_name_asc")},{value:"titre:desc",text:e("catalogue.filters.sort_name_desc")}]),W=u(()=>[{value:void 0,text:"Tous les profits"},{value:10,text:"10 MAD+"},{value:25,text:"25 MAD+"},{value:50,text:"50 MAD+"},{value:100,text:"100 MAD+"}]),U=u(()=>!!(v.value||_.value||g.value||x.value||V.value)),h=async()=>{const[s,a]=(b.value+":"+C.value).split(":");await l.fetchList({q:v.value||void 0,category_id:_.value||void 0,min_profit:g.value,size:x.value||void 0,color:V.value||void 0,page:p.value.current_page,per_page:p.value.per_page,sort:s,dir:a})},X=()=>{S.value&&clearTimeout(S.value),S.value=setTimeout(()=>{l.setPage(1),h()},300)},z=()=>{l.setPage(1),h()},Y=s=>{const[a,o]=s.split(":");b.value=a,C.value=o,z()},E=()=>{v.value="",_.value="",g.value=void 0,x.value="",V.value="",b.value="created_at",C.value="desc",l.resetFilters(),h()},Z=s=>{l.setPage(s),h()},$=async s=>{try{L.value=s,w.value=!0}catch{w.value=!1,k("Erreur lors du chargement du produit")}},ee=async s=>{try{await l.addToCart(s),G(e("catalogue.cart.added_success"))}catch{k(e("catalogue.cart.error"))}},te=s=>{console.log("Variant changed:",s)},ae=s=>{console.log("Quantity changed:",s)},oe=async()=>{var s;B.value=!0;try{const{data:a,error:o}=await ce("/affiliate/categories",{method:"GET"});if(o.value)throw o.value;(s=a.value)!=null&&s.data&&(A.value=a.value.data.filter(le=>le.actif))}catch(a){console.error("Error loading categories:",a),k("Erreur lors du chargement des catÃ©gories")}finally{B.value=!1}};return N(v,X),N([_,g,x,V],z),pe(async()=>{await oe(),await h(),await l.fetchCartSummary()}),(s,a)=>(n(),y("div",xe,[t(de,{items:R.value,class:"pa-0 mb-4"},null,8,["items"]),d("div",Ve,[d("div",null,[d("h1",be,m(r(e)("catalogue.title")),1),d("p",Ce,m(r(e)("catalogue.showing_results",{from:p.value.from,to:p.value.to,total:p.value.total})),1)]),r(l).cartSummary.items_count>0?(n(),P(j,{key:0,variant:"outlined"},{default:i(()=>[t(M,{class:"d-flex align-center gap-3"},{default:i(()=>[t(I,{icon:"tabler-shopping-cart",color:"primary"}),d("div",null,[d("div",we,m(r(e)("catalogue.cart.items_count",{count:r(l).cartSummary.items_count})),1),d("div",Pe,m(r(l).cartSummary.total_amount)+" MAD",1)])]),_:1})]),_:1})):T("",!0)]),t(j,{class:"mb-6",variant:"outlined"},{default:i(()=>[t(M,null,{default:i(()=>[t(q,null,{default:i(()=>[t(f,{cols:"12",md:"3"},{default:i(()=>[t(fe,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=o=>v.value=o),placeholder:r(e)("catalogue.search_placeholder"),"prepend-inner-icon":"tabler-search",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","placeholder"])]),_:1}),t(f,{cols:"12",md:"2"},{default:i(()=>[t(D,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=o=>_.value=o),items:[{value:"",title:r(e)("catalogue.all_categories")},...A.value.map(o=>({value:o.id,title:o.nom}))],label:r(e)("catalogue.category"),variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","items","label"])]),_:1}),t(f,{cols:"12",md:"2"},{default:i(()=>[t(D,{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=o=>g.value=o),items:W.value,label:r(e)("catalogue.min_profit"),variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","items","label"])]),_:1}),t(f,{cols:"12",md:"3"},{default:i(()=>[t(D,{"model-value":b.value+":"+C.value,items:K.value,label:r(e)("catalogue.filters.sort_by"),variant:"outlined",density:"compact","hide-details":"","onUpdate:modelValue":Y},null,8,["model-value","items","label"])]),_:1}),t(f,{cols:"12",md:"2"},{default:i(()=>[t(O,{disabled:!U.value,variant:"outlined",block:"",onClick:E},{default:i(()=>[Q(m(r(e)("catalogue.clear_filters")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),H.value?(n(),y("div",ke,[t(ve,{indeterminate:"",color:"primary",size:"64"}),d("p",Se,m(r(e)("catalogue.loading")),1)])):F.value?(n(),P(q,{key:2,class:"catalogue-grid"},{default:i(()=>[(n(!0),y(_e,null,ge(J.value,o=>(n(),P(f,{key:o.id,cols:"12",sm:"6",md:"4",lg:"3",class:"catalogue-grid__item"},{default:i(()=>[t(re,{product:r(l).mapProductToNormalized(o),onOpen:$,onAddToCart:ee,onVariantChange:te,onQtyChange:ae},null,8,["product"])]),_:2},1024))),128))]),_:1})):(n(),y("div",Te,[t(I,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),d("h3",De,m(r(e)("catalogue.no_products")),1),d("p",Ae,m(r(e)("catalogue.no_products_subtitle")),1),U.value?(n(),P(O,{key:0,color:"primary",variant:"outlined",onClick:E},{default:i(()=>[Q(m(r(e)("catalogue.clear_filters")),1)]),_:1})):T("",!0)])),F.value&&p.value.last_page>1?(n(),y("div",Be,[t(he,{"model-value":p.value.current_page,length:p.value.last_page,"total-visible":7,"onUpdate:modelValue":Z},null,8,["model-value","length"])])):T("",!0),t(ie,{modelValue:w.value,"onUpdate:modelValue":a[3]||(a[3]=o=>w.value=o),"product-id":L.value},null,8,["modelValue","product-id"])]))}}),vt=ye(Fe,[["__scopeId","data-v-d305be5d"]]);export{vt as default};
