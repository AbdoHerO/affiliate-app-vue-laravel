import{useQuickConfirm as O}from"./useConfirmAction-C1AhwA5O.js";import{u as P}from"./useApi-C5OI9_Dc.js";import{u as Q}from"./useNotifications-C-RqLAHj.js";import{aL as I,r as L,V as T,d as R,c as F,b as f,n as S,F as V,h,m as E,e as A}from"./main-BW7J9dbc.js";import{A as y}from"./ActionIcon-lhNXk9f5.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";function q(e){const{t:a}=I(),{showSuccess:r,showError:c}=Q(),u=L(!1),N=L("active"),b=T(()=>[{title:a("common.active"),value:"active"},{title:a("common.trashed"),value:"trashed"},{title:a("common.all"),value:"all"}]),k=s=>{switch(s){case"active":return a("common.active");case"trashed":return a("common.trashed");case"all":return a("common.all");default:return a("common.active")}},v=async(s,m)=>{var o,t,n;u.value=!0;try{const{data:i,error:l}=await P(`${e.apiEndpoint}/${s}`,{method:"DELETE"});if(l.value){const D=l.value.message||a("messages.delete_failed",{entity:e.entityName});return c(D),(o=e.onError)==null||o.call(e,l.value),!1}const w=m?a("messages.item_deleted_successfully",{entity:e.entityName,name:m}):a("messages.entity_deleted_successfully",{entity:e.entityName});return r(w),(t=e.onSuccess)==null||t.call(e),!0}catch(i){const l=i.message||a("messages.delete_failed",{entity:e.entityName});return c(l),(n=e.onError)==null||n.call(e,i),!1}finally{u.value=!1}},C=async(s,m)=>{var o,t,n;u.value=!0;try{const{data:i,error:l}=await P(`${e.apiEndpoint}/${s}/restore`,{method:"POST"});if(l.value){const D=l.value.message||a("messages.restore_failed",{entity:e.entityName});return c(D),(o=e.onError)==null||o.call(e,l.value),!1}const w=m?a("messages.item_restored_successfully",{entity:e.entityName,name:m}):a("messages.entity_restored_successfully",{entity:e.entityName});return r(w),(t=e.onSuccess)==null||t.call(e),!0}catch(i){const l=i.message||a("messages.restore_failed",{entity:e.entityName});return c(l),(n=e.onError)==null||n.call(e,i),!1}finally{u.value=!1}},$=async(s,m)=>{var o,t,n;u.value=!0;try{const{data:i,error:l}=await P(`${e.apiEndpoint}/${s}/force`,{method:"DELETE"});if(l.value){const D=l.value.message||a("messages.permanent_delete_failed",{entity:e.entityName});return c(D),(o=e.onError)==null||o.call(e,l.value),!1}const w=m?a("messages.item_permanently_deleted",{entity:e.entityName,name:m}):a("messages.entity_permanently_deleted",{entity:e.entityName});return r(w),(t=e.onSuccess)==null||t.call(e),!0}catch(i){const l=i.message||a("messages.permanent_delete_failed",{entity:e.entityName});return c(l),(n=e.onError)==null||n.call(e,i),!1}finally{u.value=!1}},M=(s={})=>({include_deleted:N.value,...s}),g=s=>s.deleted_at!==null&&s.deleted_at!==void 0;return{isLoading:u,filter:N,filterOptions:b,softDelete:v,restore:C,forceDelete:$,getQueryParams:M,isSoftDeleted:g,getStatusColor:s=>g(s)?"error":"success",getStatusText:s=>g(s)?a("common.deleted"):a("common.active"),getFilterLabel:k}}const _=(e,a)=>(r,c)=>q({entityName:e,apiEndpoint:a,onSuccess:r,onError:c}),Y=_("user","/admin/users"),Z=_("product","/admin/produits"),p=_("boutique","/admin/boutiques"),x=_("category","/admin/categories"),j={class:"soft-delete-actions"},z=R({__name:"SoftDeleteActions",props:{item:{},entityName:{},apiEndpoint:{},itemNameField:{default:"name"},showEdit:{type:Boolean,default:!0},showView:{type:Boolean,default:!0},showPermanentDelete:{type:Boolean,default:!0}},emits:["edit","view","deleted","restored","permanentlyDeleted"],setup(e,{emit:a}){const r=e,c=a,{t:u}=I(),{confirmDelete:N,confirmRestore:b,confirmPermanentDelete:k}=O(),{isLoading:v,softDelete:C,restore:$,forceDelete:M,isSoftDeleted:g}=q({entityName:r.entityName,apiEndpoint:r.apiEndpoint,onSuccess:()=>{}}),d=T(()=>r.item[r.itemNameField]||r.item.nom||r.item.titre||r.item.nom_complet||"Item"),B=t=>t[r.itemNameField]||t.nom||t.titre||t.nom_complet||"cet élément",s=async()=>{if(!await N(r.entityName,d.value))return;await C(r.item.id,d.value)&&c("deleted")},m=async()=>{if(!await b(r.entityName,d.value))return;await $(r.item.id,d.value)&&c("restored")},o=async()=>{if(!await k(r.entityName,d.value))return;await M(r.item.id,d.value)&&c("permanentlyDeleted")};return(t,n)=>(f(),F("div",j,[S(g)(t.item)?(f(),F(V,{key:1},[t.showView?(f(),h(y,{key:0,icon:"tabler-eye",label:"actions.view",variant:"default",onClick:n[2]||(n[2]=i=>t.$emit("view",t.item))})):E("",!0),A(y,{icon:"tabler-restore",label:"actions.restore",variant:"success",loading:S(v),onClick:m},null,8,["loading"]),t.showPermanentDelete?(f(),h(y,{key:1,icon:"tabler-trash-x",label:"actions.force_delete",variant:"danger",loading:S(v),confirm:"","confirm-title":"Suppression définitive","confirm-message":`Êtes-vous sûr de vouloir supprimer définitivement ${B(t.item)} ? Cette action est irréversible.`,onClick:o},null,8,["loading","confirm-message"])):E("",!0)],64)):(f(),F(V,{key:0},[t.showEdit?(f(),h(y,{key:0,icon:"tabler-edit",label:"actions.edit",variant:"primary",onClick:n[0]||(n[0]=i=>t.$emit("edit",t.item))})):E("",!0),t.showView?(f(),h(y,{key:1,icon:"tabler-eye",label:"actions.view",variant:"default",onClick:n[1]||(n[1]=i=>t.$emit("view",t.item))})):E("",!0),A(y,{icon:"tabler-trash",label:"actions.delete",variant:"danger",loading:S(v),confirm:"","confirm-title":"Confirmer la suppression","confirm-message":`Êtes-vous sûr de vouloir supprimer ${B(t.item)} ?`,onClick:s},null,8,["loading","confirm-message"])],64))]))}}),ee=U(z,[["__scopeId","data-v-55671ed7"]]);export{ee as S,p as a,x as b,q as c,Z as d,Y as u};
