const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/useConfirmAction-BkzLltMc.js","assets/main-BGmfaZsq.js","assets/main-DBTJy9Ru.css"])))=>i.map(i=>d[i]);
import{d as Oe,u as We,k as He,aL as Qe,r as p,V as U,w as ge,o as Ge,bb as Je,c as d,b as u,h as m,m as k,e as t,f as n,aU as he,v as l,g as s,t as c,ac as V,n as x,i as I,az as g,q as ye,F as B,j as E,x as ke,aW as Ke,b0 as Ye,b1 as Xe,b8 as Ze,aY as et,ai as tt,ba as at}from"./main-BGmfaZsq.js";import{u as st}from"./tickets-BVgTq3Gu.js";import{a as lt,V as it}from"./VAlert-CPLjIjOe.js";import{V as w}from"./VChip-S_h5DeIW.js";import{V as ot,a as be,b as xe,d as nt}from"./VList-DVfzin0E.js";import{V as rt}from"./VMenu-C3I-a7hP.js";import{a as we,V as ut}from"./VRow-Jzvhbj9T.js";import{V as D,b as L,c as Te}from"./VCard-hQ_o7lvO.js";import{V as S}from"./VCardText-BzdllyhI.js";import{V as Z}from"./VAvatar-CXniQsPN.js";import{V as ne}from"./VImg-6pMKiBpi.js";import{V as ct}from"./VForm-9k5StL4q.js";import{V as Ve}from"./VSelect-BYn5Cf2R.js";import{V as dt}from"./VTextarea-Dm9Swusq.js";import{V as mt}from"./VTooltip-BBhMhBxU.js";import{V as vt}from"./VAutocomplete-3NZOM7ei.js";import{V as Ce}from"./VSpacer-B4IQn0G0.js";import{V as ze}from"./VDialog-DIYcXxVx.js";import{_ as _t}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useNotifications-TnKci45M.js";import"./createSimpleFunctional-BjWjRu3X.js";import"./ssrBoot-A30zOnZp.js";import"./VDivider-oo2GmB8o.js";import"./VOverlay-CvSSR2rW.js";import"./forwardRefs-BxxmAO9z.js";import"./lazy-DgLfxsl0.js";import"./dialog-transition-BhMeiVQ2.js";/* empty css              */import"./VField-BqE6uwOn.js";import"./VTextField-STn8GDXm.js";import"./VCheckboxBtn-DO9961XV.js";import"./filter-578zAk0s.js";const ft={key:0,class:"d-flex justify-center align-center",style:{"min-height":"400px"}},pt={class:"text-center"},gt={class:"text-h6 mb-2"},ht={class:"text-body-2 text-medium-emphasis"},yt={key:2},kt={class:"d-flex align-center mb-6"},bt={class:"ms-4 flex-grow-1"},xt={class:"d-flex align-center gap-3 mb-2"},wt={class:"text-h5 font-weight-bold"},Tt={class:"text-h6 mb-1"},Vt={class:"text-body-2 text-medium-emphasis mb-0"},Ct={class:"d-flex gap-2"},zt={key:0,class:"text-center py-8"},Dt={key:1,class:"messages-timeline"},St={class:"d-flex"},At={class:"flex-grow-1"},Lt={class:"d-flex align-center justify-space-between mb-2"},Mt={class:"d-flex align-center gap-2"},Ut={class:"font-weight-medium"},Bt={class:"text-caption text-medium-emphasis"},Et=["innerHTML"],Ft={key:0,class:"mt-3"},Pt={class:"text-caption text-medium-emphasis mb-2"},$t={class:"d-flex flex-wrap gap-2"},It={class:"text-caption ms-1"},Rt={key:2,class:"text-center py-8"},qt={class:"text-h6 mb-2"},Nt={class:"text-body-2 text-medium-emphasis"},jt={class:"d-flex align-center gap-3"},Ot={class:"flex-grow-1"},Wt={class:"text-body-2 font-weight-medium mb-1"},Ht={class:"text-caption text-medium-emphasis"},Qt={key:0,class:"mt-3"},Gt={class:"text-caption text-medium-emphasis mb-2"},Jt={class:"d-flex flex-wrap gap-2"},Kt={class:"text-caption ms-1"},Yt={class:"d-flex justify-end"},Xt={class:"d-flex flex-column gap-4"},Zt={class:"text-caption text-medium-emphasis mb-1"},ea={class:"text-caption text-medium-emphasis mb-1"},ta={key:0},aa={class:"text-caption text-medium-emphasis mb-1"},sa={class:"text-caption text-medium-emphasis mb-1"},la={class:"text-body-2"},ia={key:1},oa={class:"text-caption text-medium-emphasis mb-1"},na={class:"text-body-2"},ra={key:2},ua={class:"text-caption text-medium-emphasis mb-1"},ca={class:"text-body-2"},da={key:3},ma={class:"text-caption text-medium-emphasis mb-1"},va={class:"text-body-2"},_a={key:4},fa={class:"text-caption text-medium-emphasis mb-1"},pa={key:5},ga={class:"text-caption text-medium-emphasis mb-1"},ha={class:"d-flex flex-column gap-4"},ya={class:"text-caption text-medium-emphasis mb-2"},ka={key:0,class:"d-flex align-center"},ba={class:"text-body-2 font-weight-medium"},xa={class:"text-caption text-medium-emphasis"},wa={key:0,class:"text-caption text-medium-emphasis"},Ta={key:1,class:"text-body-2 text-medium-emphasis"},Va={class:"text-caption text-medium-emphasis mb-2"},Ca={key:0,class:"d-flex align-center"},za={class:"text-body-2 font-weight-medium"},Da={class:"text-caption text-medium-emphasis"},Sa={key:0,class:"text-caption text-medium-emphasis"},Aa={key:0},La={class:"text-caption text-medium-emphasis mb-2"},Ma={class:"d-flex flex-wrap gap-1"},Ua={class:"d-flex flex-column gap-2"},Ba={class:"d-flex flex-wrap gap-2"},Ea={class:"d-flex flex-column gap-3"},Fa={class:"text-caption text-medium-emphasis mb-1"},Pa={class:"text-body-2"},$a={key:3,class:"text-center py-8"},Ia={class:"text-h6 mb-2"},Ra={class:"text-body-2 text-medium-emphasis mb-4"},qa=Oe({__name:"index",setup(Na){let R=null,q=null,ee=null,te=null,ae=null;const De=We(),Se=He(),{t:Ae}=Qe(),b=p(!1),T=p(!1),re=p(!0),O=p(!1),W=p(""),_e=p(!1);let f=null,v=null,se=null,H=null;const A=p(null),Q=p([]),G=p(!1),ue=p(!1),M=p(!1),F=p(!1),N=p(null),P=p(""),J=p([]),ce=p(!1),K=p("public"),j=p(""),$=p([]),de=p(null),Le=i=>{try{const e=i.target,_=Array.from(e.files||[]);$.value=[...$.value,..._]}catch(e){console.error("Error handling file selection:",e)}},Me=i=>{try{$.value.splice(i,1)}catch(e){console.error("Error removing file:",e)}},Ue=i=>{try{if(i===0)return"0 Bytes";const e=1024,_=["Bytes","KB","MB","GB"],h=Math.floor(Math.log(i)/Math.log(e));return parseFloat((i/Math.pow(e,h)).toFixed(2))+" "+_[h]}catch(e){return console.error("Error formatting file size:",e),"Unknown size"}},Be=async()=>{try{console.log("ðŸ”§ [Ticket Detail] Loading components...");const i=[{name:"TicketStatusBadge",path:"@/components/admin/tickets/TicketStatusBadge.vue",ref:()=>R},{name:"TicketPriorityBadge",path:"@/components/admin/tickets/TicketPriorityBadge.vue",ref:()=>q},{name:"TicketEntityLink",path:"@/components/admin/tickets/TicketEntityLink.vue",ref:()=>ee},{name:"MessageComposer",path:"@/components/admin/tickets/MessageComposer.vue",ref:()=>te},{name:"ConfirmActionDialog",path:"@/components/common/ConfirmActionDialog.vue",ref:()=>ae}];for(const e of i)try{const _=await import(e.path);e.name==="TicketStatusBadge"?R=_.default:e.name==="TicketPriorityBadge"?q=_.default:e.name==="TicketEntityLink"?ee=_.default:e.name==="MessageComposer"?te=_.default:e.name==="ConfirmActionDialog"&&(ae=_.default)}catch{console.warn(`${e.name} not available, using fallback`)}_e.value=!0,console.log("âœ… [Ticket Detail] Components loaded")}catch(i){console.error("ðŸš« [Ticket Detail] Component loading failed:",i),_e.value=!0}},Ee=async()=>{try{console.log("ðŸŽ« [Ticket Detail] Initializing components..."),await Be(),f=st(),f&&(v=Ze(f),v.currentTicket&&(A.value=v.currentTicket.value||null),v.messages&&(Q.value=v.messages.value||[]),v.loading&&(G.value=v.loading.value||!1),v.messagesLoading&&(ue.value=v.messagesLoading.value||!1));try{const{useQuickConfirm:i}=await et(async()=>{const{useQuickConfirm:_}=await import("./useConfirmAction-BkzLltMc.js");return{useQuickConfirm:_}},__vite__mapDeps([0,1,2])),e=i();se=e.confirm,H=e.presets}catch{console.warn("ðŸš« [Ticket Detail] Confirm composable failed, using fallback"),se=async e=>{try{const _=(e==null?void 0:e.text)||(e==null?void 0:e.message)||"Are you sure?";return window.confirm(_)}catch(_){return console.error("Confirm dialog error:",_),!1}},H={delete:(e,_)=>({text:`Delete ${e}: ${_}?`,message:`Are you sure you want to delete this ${e}? This action cannot be undone.`,title:`Delete ${e}`,type:"delete"})}}T.value=!0,console.log("âœ… [Ticket Detail] Components initialized successfully")}catch(i){console.error("ðŸš« [Ticket Detail] Component initialization failed:",i),O.value=!0,W.value="Failed to initialize components"}},Y=U(()=>{var i;try{const e=(i=De.params)==null?void 0:i.id;return typeof e=="string"?e:String(e||"")}catch(e){return console.error("Error getting ticket ID:",e),""}}),a=U(()=>A.value),le=U(()=>Q.value||[]);U(()=>G.value||!1);const ie=U(()=>ue.value||!1),me=U(()=>{var i;try{return((i=a.value)==null?void 0:i.is_open)||!1}catch{return!1}}),fe=U(()=>{try{return le.value.length>0}catch{return!1}}),o=(i,e)=>{try{return Ae(i)}catch{return e||i}},Fe=U(()=>[{title:o("ticket_status_open","Open"),value:"open"},{title:o("ticket_status_pending","Pending"),value:"pending"},{title:o("ticket_status_waiting_user","Waiting User"),value:"waiting_user"},{title:o("ticket_status_waiting_third_party","Waiting Third Party"),value:"waiting_third_party"},{title:o("ticket_status_resolved","Resolved"),value:"resolved"},{title:o("ticket_status_closed","Closed"),value:"closed"}]),ve=async()=>{if(!(b.value||!T.value||!Y.value||!f))try{G.value=!0,O.value=!1,W.value="",f.fetchTicket&&f.fetchMessages&&(await Promise.allSettled([f.fetchTicket(Y.value),f.fetchMessages(Y.value)]),v&&!b.value&&(v.currentTicket&&(A.value=v.currentTicket.value||null),v.messages&&(Q.value=v.messages.value||[]),v.loading&&(G.value=v.loading.value||!1),v.messagesLoading&&(ue.value=v.messagesLoading.value||!1)))}catch(i){console.error("Error fetching ticket data:",i),O.value=!0,W.value="Failed to load ticket data"}finally{b.value||(G.value=!1)}},oe=()=>{if(!b.value)try{Se.push("/admin/support/tickets")}catch(i){console.error("Error navigating back:",i);try{window.location.href="/admin/support/tickets"}catch(e){console.error("Failed to navigate:",e)}}},Pe=async()=>{if(!(b.value||!T.value||!a.value||!f))try{f.assignTicket&&(await f.assignTicket(a.value.id,N.value),v&&!b.value&&v.currentTicket&&(A.value=v.currentTicket.value||A.value)),M.value=!1,N.value=null}catch(i){console.error("Error assigning ticket:",i),alert("Failed to assign ticket. Please try again.")}},$e=async()=>{console.log("ðŸ” [Ticket Detail] Loading admin users..."),ce.value=!0;try{const i=new URLSearchParams({per_page:"50",role:"admin"}),e=await at(`/admin/users?${i.toString()}`);if(console.log("ðŸ” [Ticket Detail] Admin users response:",e),e&&e.users&&Array.isArray(e.users)){const _=e.users.filter(h=>h.roles&&h.roles.some(r=>r.name==="admin"));J.value=_.map(h=>({...h,nom_complet:h.nom_complet||h.name||"Unknown User",email:h.email||""})),console.log("âœ… [Ticket Detail] Admin users loaded:",J.value.length)}else J.value=[]}catch(i){console.error("âŒ [Ticket Detail] Failed to load admin users:",i),J.value=[]}finally{ce.value=!1}};ge(M,i=>{console.log("ðŸ” [Ticket Detail] Assign dialog state changed:",i),i&&(console.log("ðŸ” [Ticket Detail] Assign dialog opened, loading admin users..."),$e())});const Ie=async()=>{if(!(b.value||!T.value||!a.value||!P.value||!f))try{f.changeStatus&&(await f.changeStatus(a.value.id,P.value),v&&!b.value&&v.currentTicket&&(A.value=v.currentTicket.value||A.value)),F.value=!1,P.value=""}catch(i){console.error("Error changing status:",i),alert("Failed to change status. Please try again.")}},Re=async()=>{if(!(b.value||!T.value||!a.value||!f))try{let i;H&&H.delete?i=H.delete("ticket",a.value.subject||"this ticket"):i={text:`Delete ticket: ${a.value.subject||"this ticket"}?`,message:"Are you sure you want to delete this ticket? This action cannot be undone.",title:"Delete Ticket",type:"delete"};let e=!1;se?e=await se(i):e=window.confirm(i.message||i.text),e&&f.deleteTicket&&await f.deleteTicket(a.value.id)&&!b.value&&oe()}catch(i){console.error("Error deleting ticket:",i),alert("Failed to delete ticket. Please try again.")}},pe=async i=>{if(!(b.value||!T.value||!a.value||!f))try{f.addMessage&&(await f.addMessage(a.value.id,i),v&&!b.value&&(v.messages&&(Q.value=v.messages.value||Q.value),v.currentTicket&&(A.value=v.currentTicket.value||A.value)))}catch(e){console.error("Error submitting message:",e),alert("Failed to send message. Please try again.")}},qe=async()=>{var e;if(!((e=j.value)!=null&&e.trim()))return;const i={type:K.value,body:j.value,is_internal:K.value==="internal",attachments:$.value};await pe(i),j.value="",$.value=[],K.value="public"},X=i=>{try{return i?new Date(i).toLocaleString():"N/A"}catch{return i||"N/A"}},Ne=i=>{try{if(!i)return"Unknown";const e=new Date,_=new Date(i),h=Math.floor((e.getTime()-_.getTime())/(1e3*60*60));if(h<1)return o("just_now","Just now");if(h<24)return o("hours_ago",`${h} hours ago`).replace("{count}",String(h));const r=Math.floor(h/24);return o("days_ago",`${r} days ago`).replace("{count}",String(r))}catch{return i||"Unknown"}},je=()=>{try{de.value&&de.value.click()}catch(i){console.error("Error triggering file input:",i)}};return ge(()=>Y.value,async(i,e)=>{b.value||!T.value||i&&i!==e&&(await tt(),await ve())},{immediate:!1}),Ge(async()=>{try{console.log("ðŸŽ« [Ticket Detail] Component mounting..."),re.value=!0,await Ee(),!b.value&&Y.value&&T.value&&await ve(),console.log("ðŸŽ« [Ticket Detail] Component mounted successfully")}catch(i){console.error("ðŸš« [Ticket Detail] Error during component mount:",i),O.value=!0,W.value="Failed to initialize ticket detail page",setTimeout(()=>{b.value||oe()},3e3)}finally{re.value=!1}}),Je(()=>{console.log("ðŸŽ« [Ticket Detail] Component unmounting..."),b.value=!0,M.value=!1,F.value=!1,N.value=null,P.value=""}),(i,e)=>{var _,h;return u(),d("div",null,[re.value?(u(),d("div",ft,[n("div",pt,[t(he,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),n("div",gt,l(o("loading","Loading...")),1),n("div",ht,l(o("loading_ticket","Loading ticket details...")),1)])])):O.value?(u(),m(it,{key:1,type:"error",variant:"tonal",class:"mb-6"},{append:s(()=>[t(V,{size:"small",variant:"outlined",onClick:ve},{default:s(()=>[c(l(o("retry","Retry")),1)]),_:1})]),default:s(()=>[t(lt,null,{default:s(()=>[c(l(o("error","Error")),1)]),_:1}),c(" "+l(W.value)+" ",1)]),_:1})):T.value&&a.value?(u(),d("div",yt,[n("div",kt,[t(V,{icon:"tabler-arrow-left",variant:"text",onClick:oe}),n("div",bt,[n("div",xt,[n("h1",wt," #"+l(((_=a.value.id)==null?void 0:_.toString().slice(-8))||"N/A"),1),x(R)?(u(),m(I(x(R)),{key:0,status:a.value.status},null,8,["status"])):(u(),m(w,{key:1,color:a.value.status==="open"?"success":a.value.status==="closed"?"error":"warning",size:"small",variant:"tonal"},{default:s(()=>[c(l(o(`ticket_status_${a.value.status}`,a.value.status)),1)]),_:1},8,["color"])),x(q)?(u(),m(I(x(q)),{key:2,priority:a.value.priority,"show-icon":""},null,8,["priority"])):(u(),m(w,{key:3,color:a.value.priority==="urgent"?"error":a.value.priority==="high"?"warning":"default",size:"small",variant:"outlined"},{default:s(()=>[t(g,{icon:a.value.priority==="urgent"?"tabler-alert-triangle":"tabler-flag",size:"14",class:"me-1"},null,8,["icon"]),c(" "+l(o(`ticket_priority_${a.value.priority}`,a.value.priority)),1)]),_:1},8,["color"]))]),n("h2",Tt,l(a.value.subject||"No Subject"),1),n("p",Vt,l(o("created_by","Created by"))+" "+l(((h=a.value.requester)==null?void 0:h.nom_complet)||"Unknown")+" â€¢ "+l(X(a.value.created_at)),1)]),n("div",Ct,[t(V,{variant:"outlined",disabled:!T.value,onClick:e[0]||(e[0]=r=>M.value=!0)},{default:s(()=>[t(g,{icon:"tabler-user-check",class:"me-2"}),c(" "+l(o("assign","Assign")),1)]),_:1},8,["disabled"]),t(V,{variant:"outlined",disabled:!T.value,onClick:e[1]||(e[1]=r=>F.value=!0)},{default:s(()=>[t(g,{icon:"tabler-edit",class:"me-2"}),c(" "+l(o("change_status","Change Status")),1)]),_:1},8,["disabled"]),t(rt,null,{activator:s(({props:r})=>[t(V,ye({icon:"tabler-dots-vertical",variant:"outlined",disabled:!T.value},r),null,16,["disabled"])]),default:s(()=>[t(ot,null,{default:s(()=>[t(be,{onClick:Re,class:"text-error"},{prepend:s(()=>[t(g,{icon:"tabler-trash"})]),default:s(()=>[t(xe,null,{default:s(()=>[c(l(o("delete_ticket","Delete Ticket")),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),t(ut,null,{default:s(()=>[t(we,{cols:"12",lg:"8"},{default:s(()=>[t(D,{class:"mb-6"},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("messages","Messages"))+" ",1),fe.value?(u(),m(w,{key:0,size:"small",class:"ms-2"},{default:s(()=>[c(l(le.value.length),1)]),_:1})):k("",!0)]),_:1}),t(S,null,{default:s(()=>[ie.value?(u(),d("div",zt,[t(he,{indeterminate:"",color:"primary"})])):fe.value?(u(),d("div",Dt,[(u(!0),d(B,null,E(le.value,(r,y)=>{var C;return u(),d("div",{key:r.id||y,class:ke(["message-item",{"mb-6":y<le.value.length-1}])},[n("div",St,[t(Z,{size:"40",class:"me-3"},{default:s(()=>{var z;return[(z=r.sender)!=null&&z.photo_profil?(u(),m(ne,{key:0,src:r.sender.photo_profil,alt:r.sender.nom_complet},null,8,["src","alt"])):(u(),m(g,{key:1,icon:"tabler-user",size:"20"}))]}),_:2},1024),n("div",At,[n("div",Lt,[n("div",Mt,[n("span",Ut,l(((C=r.sender)==null?void 0:C.nom_complet)||"Unknown"),1),t(w,{color:r.is_internal?"warning":"primary",size:"x-small",variant:"tonal"},{default:s(()=>[c(l(r.is_internal?o("internal","Internal"):o("public","Public")),1)]),_:2},1032,["color"])]),n("span",Bt,l(Ne(r.created_at)),1)]),t(D,{variant:"outlined",color:r.is_internal?"warning":"default",class:ke(["message-body",{warning:r.is_internal}])},{default:s(()=>[t(S,null,{default:s(()=>[n("div",{innerHTML:r.body},null,8,Et),r.attachments&&r.attachments.length>0?(u(),d("div",Ft,[n("div",Pt,l(o("attachments","Attachments"))+": ",1),n("div",$t,[(u(!0),d(B,null,E(r.attachments,z=>(u(),m(w,{key:z.id||z.name,size:"small",variant:"outlined",href:z.url,target:"_blank",class:"attachment-chip"},{default:s(()=>[t(g,{icon:z.is_image?"tabler-photo":z.is_pdf?"tabler-file-type-pdf":"tabler-file",size:"14",class:"me-1"},null,8,["icon"]),c(" "+l(z.original_name)+" ",1),n("span",It,"("+l(z.human_size)+")",1)]),_:2},1032,["href"]))),128))])])):k("",!0)]),_:2},1024)]),_:2},1032,["color","class"])])])],2)}),128))])):(u(),d("div",Rt,[t(g,{icon:"tabler-message-off",size:"64",class:"mb-4",color:"disabled"}),n("h3",qt,l(o("no_messages","No Messages")),1),n("p",Nt,l(o("no_messages_description","No messages have been posted yet.")),1)]))]),_:1})]),_:1}),x(te)?(u(),m(I(x(te)),{key:0,loading:ie.value,disabled:!me.value,onSubmit:pe},null,40,["loading","disabled"])):(u(),m(D,{key:1},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("add_message","Add Message")),1)]),_:1}),t(S,null,{default:s(()=>[t(ct,{onSubmit:Ke(qe,["prevent"])},{default:s(()=>{var r;return[t(Ve,{modelValue:K.value,"onUpdate:modelValue":e[2]||(e[2]=y=>K.value=y),items:[{title:o("public","Public"),value:"public"},{title:o("internal","Internal"),value:"internal"}],label:o("message_type","Message Type"),variant:"outlined",class:"mb-4"},null,8,["modelValue","items","label"]),t(dt,{modelValue:j.value,"onUpdate:modelValue":e[3]||(e[3]=y=>j.value=y),label:o("message","Message"),variant:"outlined",rows:"4",disabled:!me.value||ie.value,class:"mb-4"},null,8,["modelValue","label","disabled"]),t(D,{variant:"outlined",class:"mb-4"},{default:s(()=>[t(S,null,{default:s(()=>[n("div",jt,[t(g,{icon:"tabler-paperclip"}),n("div",Ot,[n("div",Wt,l(o("attachments","Attachments")),1),n("div",Ht,l(o("drag_drop_files","Drag and drop files here or click to browse")),1)]),t(V,{variant:"outlined",size:"small",onClick:je},{default:s(()=>[t(g,{icon:"tabler-upload",class:"me-2"}),c(" "+l(o("browse","Browse")),1)]),_:1})]),n("input",{ref_key:"fileInput",ref:de,type:"file",multiple:"",style:{display:"none"},onChange:Le},null,544),$.value.length>0?(u(),d("div",Qt,[n("div",Gt,l(o("selected_files","Selected Files"))+": ",1),n("div",Jt,[(u(!0),d(B,null,E($.value,(y,C)=>(u(),m(w,{key:C,size:"small",variant:"outlined",closable:"","onClick:close":z=>Me(C)},{default:s(()=>[t(g,{icon:y.type&&y.type.startsWith("image/")?"tabler-photo":"tabler-file",size:"14",class:"me-1"},null,8,["icon"]),c(" "+l(y.name)+" ",1),n("span",Kt,"("+l(Ue(y.size))+")",1)]),_:2},1032,["onClick:close"]))),128))])])):k("",!0)]),_:1})]),_:1}),n("div",Yt,[t(V,{type:"submit",color:"primary",loading:ie.value,disabled:!me.value||!((r=j.value)!=null&&r.trim())},{default:s(()=>[t(g,{icon:"tabler-send",class:"me-2"}),c(" "+l(o("send_message","Send Message")),1)]),_:1},8,["loading","disabled"])])]}),_:1})]),_:1})]),_:1}))]),_:1}),t(we,{cols:"12",lg:"4"},{default:s(()=>[t(D,{class:"mb-6"},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("ticket_information","Ticket Information")),1)]),_:1}),t(S,null,{default:s(()=>[n("div",Xt,[n("div",null,[n("div",Zt,l(o("status","Status")),1),x(R)?(u(),m(I(x(R)),{key:0,status:a.value.status},null,8,["status"])):(u(),m(w,{key:1,color:a.value.status==="open"?"success":a.value.status==="closed"?"error":"warning",size:"small",variant:"tonal"},{default:s(()=>[c(l(o(`ticket_status_${a.value.status}`,a.value.status)),1)]),_:1},8,["color"]))]),n("div",null,[n("div",ea,l(o("priority","Priority")),1),x(q)?(u(),m(I(x(q)),{key:0,priority:a.value.priority,"show-icon":""},null,8,["priority"])):(u(),m(w,{key:1,color:a.value.priority==="urgent"?"error":a.value.priority==="high"?"warning":"default",size:"small",variant:"outlined"},{default:s(()=>[t(g,{icon:a.value.priority==="urgent"?"tabler-alert-triangle":"tabler-flag",size:"14",class:"me-1"},null,8,["icon"]),c(" "+l(o(`ticket_priority_${a.value.priority}`,a.value.priority)),1)]),_:1},8,["color"]))]),a.value.category?(u(),d("div",ta,[n("div",aa,l(o("category","Category")),1),t(w,{size:"small",variant:"tonal"},{default:s(()=>[c(l(o(`ticket_category_${a.value.category}`,a.value.category)),1)]),_:1})])):k("",!0),n("div",null,[n("div",sa,l(o("created","Created")),1),n("div",la,l(X(a.value.created_at)),1)]),a.value.last_activity_at?(u(),d("div",ia,[n("div",oa,l(o("last_activity","Last Activity")),1),n("div",na,l(X(a.value.last_activity_at)),1)])):k("",!0),a.value.first_response_at?(u(),d("div",ra,[n("div",ua,l(o("first_response","First Response")),1),n("div",ca,l(X(a.value.first_response_at)),1)])):k("",!0),a.value.resolved_at?(u(),d("div",da,[n("div",ma,l(o("resolved","Resolved")),1),n("div",va,l(X(a.value.resolved_at)),1)])):k("",!0),a.value.sla_response_time?(u(),d("div",_a,[n("div",fa,l(o("response_time_sla","Response Time SLA")),1),t(w,{color:a.value.sla_response_breached?"error":"success",size:"small",variant:"tonal"},{default:s(()=>[t(g,{icon:a.value.sla_response_breached?"tabler-alert-triangle":"tabler-check",size:"14",class:"me-1"},null,8,["icon"]),c(" "+l(a.value.sla_response_time),1)]),_:1},8,["color"])])):k("",!0),a.value.sla_resolution_time?(u(),d("div",pa,[n("div",ga,l(o("resolution_time_sla","Resolution Time SLA")),1),t(w,{color:a.value.sla_resolution_breached?"error":"success",size:"small",variant:"tonal"},{default:s(()=>[t(g,{icon:a.value.sla_resolution_breached?"tabler-alert-triangle":"tabler-check",size:"14",class:"me-1"},null,8,["icon"]),c(" "+l(a.value.sla_resolution_time),1)]),_:1},8,["color"])])):k("",!0)])]),_:1})]),_:1}),t(D,{class:"mb-6"},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("people","People")),1)]),_:1}),t(S,null,{default:s(()=>[n("div",ha,[n("div",null,[n("div",ya,l(o("requester","Requester")),1),a.value.requester?(u(),d("div",ka,[t(Z,{size:"32",class:"me-3"},{default:s(()=>[a.value.requester.photo_profil?(u(),m(ne,{key:0,src:a.value.requester.photo_profil,alt:a.value.requester.nom_complet},null,8,["src","alt"])):(u(),m(g,{key:1,icon:"tabler-user",size:"18"}))]),_:1}),n("div",null,[n("div",ba,l(a.value.requester.nom_complet),1),n("div",xa,l(a.value.requester.email),1),a.value.requester.phone?(u(),d("div",wa,l(a.value.requester.phone),1)):k("",!0)])])):(u(),d("div",Ta,l(o("no_requester","No requester information")),1))]),n("div",null,[n("div",Va,l(o("assignee","Assignee")),1),a.value.assignee?(u(),d("div",Ca,[t(Z,{size:"32",class:"me-3"},{default:s(()=>[a.value.assignee.photo_profil?(u(),m(ne,{key:0,src:a.value.assignee.photo_profil,alt:a.value.assignee.nom_complet},null,8,["src","alt"])):(u(),m(g,{key:1,icon:"tabler-user",size:"18"}))]),_:1}),n("div",null,[n("div",za,l(a.value.assignee.nom_complet),1),n("div",Da,l(a.value.assignee.email),1),a.value.assignee.department?(u(),d("div",Sa,l(a.value.assignee.department),1)):k("",!0)])])):(u(),m(w,{key:1,size:"small",variant:"outlined",color:"warning"},{default:s(()=>[c(l(o("unassigned","Unassigned")),1)]),_:1}))]),a.value.watchers&&a.value.watchers.length>0?(u(),d("div",Aa,[n("div",La,l(o("watchers","Watchers")),1),n("div",Ma,[(u(!0),d(B,null,E(a.value.watchers,r=>(u(),m(mt,{key:r.id||r.nom_complet,text:r.nom_complet},{activator:s(({props:y})=>[t(Z,ye({size:"24",ref_for:!0},y),{default:s(()=>[r.photo_profil?(u(),m(ne,{key:0,src:r.photo_profil,alt:r.nom_complet},null,8,["src","alt"])):(u(),m(g,{key:1,icon:"tabler-user",size:"14"}))]),_:2},1040)]),_:2},1032,["text"]))),128))])])):k("",!0)])]),_:1})]),_:1}),a.value.relations&&a.value.relations.length>0?(u(),m(D,{key:0,class:"mb-6"},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("related_items","Related Items")),1)]),_:1}),t(S,null,{default:s(()=>[n("div",Ua,[x(ee)?(u(!0),d(B,{key:0},E(a.value.relations,r=>(u(),m(I(x(ee)),{key:r.id||r.related_type,relation:r},null,8,["relation"]))),128)):(u(!0),d(B,{key:1},E(a.value.relations,r=>(u(),m(w,{key:r.id||r.related_type,size:"small",variant:"outlined",class:"justify-start"},{default:s(()=>[t(g,{icon:r.related_type==="user"?"tabler-user":"tabler-link",size:"14",class:"me-2"},null,8,["icon"]),c(" "+l(r.related_display_name||r.related_type),1)]),_:2},1024))),128))])]),_:1})]),_:1})):k("",!0),a.value.tags&&a.value.tags.length>0?(u(),m(D,{key:1,class:"mb-6"},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("tags","Tags")),1)]),_:1}),t(S,null,{default:s(()=>[n("div",Ba,[(u(!0),d(B,null,E(a.value.tags,r=>(u(),m(w,{key:r.id||r.name,size:"small",variant:"tonal",color:r.color||"primary"},{default:s(()=>[c(l(r.name),1)]),_:2},1032,["color"]))),128))])]),_:1})]),_:1})):k("",!0),a.value.custom_fields&&Object.keys(a.value.custom_fields).length>0?(u(),m(D,{key:2},{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("custom_fields","Custom Fields")),1)]),_:1}),t(S,null,{default:s(()=>[n("div",Ea,[(u(!0),d(B,null,E(a.value.custom_fields,(r,y)=>(u(),d("div",{key:y},[n("div",Fa,l(y),1),n("div",Pa,l(r),1)]))),128))])]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1})])):T.value?(u(),d("div",$a,[t(g,{icon:"tabler-ticket-off",size:"64",class:"mb-4",color:"disabled"}),n("h3",Ia,l(o("ticket_not_found","Ticket Not Found")),1),n("p",Ra,l(o("ticket_not_found_description","The requested ticket could not be found.")),1),t(V,{color:"primary",onClick:oe},{default:s(()=>[c(l(o("back_to_tickets","Back to Tickets")),1)]),_:1})])):k("",!0),t(ze,{modelValue:M.value,"onUpdate:modelValue":e[6]||(e[6]=r=>M.value=r),"max-width":"400",persistent:!1,"onClick:outside":e[7]||(e[7]=r=>M.value=!1)},{default:s(()=>[t(D,null,{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("assign_ticket","Assign Ticket")),1)]),_:1}),t(S,null,{default:s(()=>[t(vt,{modelValue:N.value,"onUpdate:modelValue":e[4]||(e[4]=r=>N.value=r),items:J.value,loading:ce.value,label:o("select_assignee","Select Assignee"),variant:"outlined",clearable:"","item-title":"nom_complet","item-value":"id",placeholder:"Search admin users..."},{item:s(({props:r,item:y})=>[t(be,Ye(Xe(r)),{prepend:s(()=>[t(Z,{size:"24"},{default:s(()=>[t(g,{icon:"tabler-user",size:"14"})]),_:1})]),default:s(()=>[t(xe,null,{default:s(()=>{var C;return[c(l(((C=y.raw)==null?void 0:C.nom_complet)||"Unknown User"),1)]}),_:2},1024),t(nt,null,{default:s(()=>{var C;return[c(l(((C=y.raw)==null?void 0:C.email)||""),1)]}),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","loading","label"])]),_:1}),t(Te,null,{default:s(()=>[t(Ce),t(V,{onClick:e[5]||(e[5]=r=>M.value=!1)},{default:s(()=>[c(l(o("cancel","Cancel")),1)]),_:1}),t(V,{color:"primary",onClick:Pe,disabled:!N.value},{default:s(()=>[c(l(o("assign","Assign")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ze,{modelValue:F.value,"onUpdate:modelValue":e[10]||(e[10]=r=>F.value=r),"max-width":"400",persistent:!1,"onClick:outside":e[11]||(e[11]=r=>F.value=!1)},{default:s(()=>[t(D,null,{default:s(()=>[t(L,null,{default:s(()=>[c(l(o("change_status","Change Status")),1)]),_:1}),t(S,null,{default:s(()=>[t(Ve,{modelValue:P.value,"onUpdate:modelValue":e[8]||(e[8]=r=>P.value=r),items:Fe.value,label:o("select_status","Select Status"),variant:"outlined","item-title":"title","item-value":"value"},null,8,["modelValue","items","label"])]),_:1}),t(Te,null,{default:s(()=>[t(Ce),t(V,{onClick:e[9]||(e[9]=r=>F.value=!1)},{default:s(()=>[c(l(o("cancel","Cancel")),1)]),_:1}),t(V,{color:"primary",onClick:Ie,disabled:!P.value},{default:s(()=>[c(l(o("change_status","Change Status")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),x(ae)?(u(),m(I(x(ae)),{key:4})):k("",!0)])}}}),bs=_t(qa,[["__scopeId","data-v-a1ebb1ce"]]);export{bs as default};
